{"version":3,"file":"chunks/2255.7d96a601.js","mappings":"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","sources":["webpack:///../../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodGet.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/classPrivateMethodInitSpec.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getBasePath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/historyExtended.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/history.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Runtime.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomProcessors.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerAppI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetI18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/images.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/devtools.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/proxyFactories.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/themeAndMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getGeneralGlobals.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/StoryboardFunctionRegistry.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/StoryboardFunctions.js","webpack:///../../node_modules/@ungap/event-target/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mediaQuery.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getStorageItem.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/isStrictMode.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/CustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/utils.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/WidgetFunctions.js","webpack:///../../node_modules/compare-versions/lib/esm/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/hasInstalledApp.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/utils.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/getProviderBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveData.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/evaluate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getNextStateOfUseBrick.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/markAsComputed.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealValue.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/checkIf.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/getTracks.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/computeRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setRealProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/setProperties.js","webpack:///../../node_modules/@next-core/runtime/node_modules/path-to-regexp/dist.es2015/index.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchPath.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/matchRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Dialog.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/poll.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/i18n.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/handleHttpError.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/Notification.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/bindListeners.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/DataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/data/resolveDataStore.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/setupUseBrickInTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/expandCustomTemplate.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/enums.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/constants.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/expandFormRenderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/FormRenderer/getDefaultProperties.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Renderer.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/compute/listenOnTrackingContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/CustomTemplates/bindTemplateProxy.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/mount.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/RendererContext.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/getPageInfo.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/abortController.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/registerCustomTemplates.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/fulfilStoryboard.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/Router.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/insertPreviewRoutes.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/injected.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/auth.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/fetchByProvider.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/createRoot.js","webpack:///../../node_modules/@next-core/runtime/dist/esm/internal/secret_internals.js"],"sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n      args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n      _next(undefined);\n    });\n  };\n}","export default function _classPrivateMethodGet(receiver, privateSet, fn) {\n  if (!privateSet.has(receiver)) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n  return fn;\n}","import checkPrivateRedeclaration from \"./checkPrivateRedeclaration.js\";\nexport default function _classPrivateMethodInitSpec(obj, privateSet) {\n  checkPrivateRedeclaration(obj, privateSet);\n  privateSet.add(obj);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","/**\n * Get site's base path, generally will be `/next/` or `/`.\n */\nexport function getBasePath() {\n  var base = document.querySelector(\"base\");\n  var basePath = base ? base.getAttribute(\"href\") : \"/\";\n  return basePath;\n}\n//# sourceMappingURL=getBasePath.js.map","import { orderBy } from \"lodash\";\nimport { getRuntime } from \"./Runtime.js\";\nexport function matchStoryboard(storyboards, pathname) {\n  // Put apps with longer homepage before shorter ones.\n  // E.g., `/legacy/tool` will match first before `/legacy`.\n  // This enables two apps with relationship of parent-child of homepage.\n  var sortedStoryboards = orderBy(storyboards, storyboard => {\n    var _storyboard$app$homep, _storyboard$app, _storyboard$app$homep2;\n    return (_storyboard$app$homep = (_storyboard$app = storyboard.app) === null || _storyboard$app === void 0 ? void 0 : (_storyboard$app$homep2 = _storyboard$app.homepage) === null || _storyboard$app$homep2 === void 0 ? void 0 : _storyboard$app$homep2.length) !== null && _storyboard$app$homep !== void 0 ? _storyboard$app$homep : 0;\n  }, \"desc\");\n  for (var storyboard of sortedStoryboards) {\n    var homepage = storyboard.app.homepage;\n    if (typeof homepage === \"string\" && homepage[0] === \"/\") {\n      if (homepage === \"/\" ? pathname === homepage : \"\".concat(pathname.replace(/\\/+$/, \"\"), \"/\").startsWith(\"\".concat(homepage.replace(/\\/+$/, \"\"), \"/\"))) {\n        return storyboard;\n      }\n    }\n  }\n}\n\n/**\n * We say it's an outside app when at least one of the below conditions are true:\n *   - target app is not found.\n *   - target app is not the current app.\n *   - current app is non-standalone mode and target app is standalone mode.\n *\n * Note: when current app is standalone mode, other apps will not be found.\n */\nexport function isOutsideApp(storyboard) {\n  var _getRuntime$getCurren;\n  if (process.env.NODE_ENV === \"test\") {\n    return false;\n  }\n  return !storyboard ||\n  // Sometimes `storyboard.app.standaloneMode` is incorrect.\n  ((_getRuntime$getCurren = getRuntime().getCurrentApp()) === null || _getRuntime$getCurren === void 0 ? void 0 : _getRuntime$getCurren.id) !== storyboard.app.id && !window.STANDALONE_MICRO_APPS && storyboard.app.standaloneMode;\n}\n//# sourceMappingURL=matchStoryboard.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"extraQuery\", \"clear\", \"keepHash\"];\nimport { parsePath } from \"history\";\nimport { getBasePath } from \"../getBasePath.js\";\nimport { _internalApiMatchStoryboard } from \"./Runtime.js\";\nimport { isOutsideApp } from \"./matchStoryboard.js\";\nvar blocked = false;\nexport function getUserConfirmation(message, callback) {\n  blocked = !confirm(message);\n  callback(!blocked);\n}\nexport function historyExtended(browserHistory) {\n  var {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function push(location, state, callback) {\n    blocked = false;\n    originalPush(location, state);\n    callback === null || callback === void 0 ? void 0 : callback(blocked);\n  }\n  function replace(location, state, callback) {\n    blocked = false;\n    originalReplace(location, state);\n    callback === null || callback === void 0 ? void 0 : callback(blocked);\n  }\n  function updateQueryFactory(method) {\n    return function updateQuery(query) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var callback = arguments.length > 2 ? arguments[2] : undefined;\n      var {\n          extraQuery,\n          clear,\n          keepHash\n        } = options,\n        state = _objectWithoutProperties(options, _excluded);\n      var urlSearchParams = new URLSearchParams(clear ? \"\" : browserHistory.location.search);\n      var params = {};\n      Object.assign(params, query, extraQuery);\n      for (var [key, value] of Object.entries(params)) {\n        if (Array.isArray(value)) {\n          urlSearchParams.delete(key);\n          for (var item of value) {\n            urlSearchParams.append(key, item);\n          }\n        } else if (value === undefined || value === null || value === \"\") {\n          urlSearchParams.delete(key);\n        } else {\n          urlSearchParams.set(key, value);\n        }\n      }\n      (method === \"push\" ? push : replace)(\"?\".concat(urlSearchParams.toString()).concat(keepHash ? browserHistory.location.hash : \"\"), state, callback);\n    };\n  }\n  function pushAnchor(hash, state, callback) {\n    push(_objectSpread(_objectSpread({}, browserHistory.location), {}, {\n      key: undefined,\n      hash,\n      state: _objectSpread({\n        // The default notify is false\n        notify: false\n      }, state)\n    }), undefined, callback);\n  }\n  function reload(callback) {\n    replace(_objectSpread(_objectSpread({}, browserHistory.location), {}, {\n      state: _objectSpread(_objectSpread({}, browserHistory.location.state), {}, {\n        // Always notify\n        notify: true\n      })\n    }), undefined, callback);\n  }\n  var blockMessage;\n  function setBlockMessage(message) {\n    blockMessage = message;\n  }\n  function getBlockMessage() {\n    return blockMessage;\n  }\n  function unblock() {\n    blockMessage = undefined;\n  }\n  return _objectSpread({\n    pushQuery: updateQueryFactory(\"push\"),\n    replaceQuery: updateQueryFactory(\"replace\"),\n    pushAnchor: pushAnchor,\n    reload,\n    setBlockMessage,\n    getBlockMessage,\n    unblock\n  }, historyOverridden(_objectSpread(_objectSpread({}, browserHistory), {}, {\n    push,\n    replace\n  })));\n}\n\n/**\n * Override history for standalone micro apps.\n *\n * when `push` or `replace` to other apps, force page refresh.\n */\nfunction historyOverridden(browserHistory) {\n  var {\n    push: originalPush,\n    replace: originalReplace\n  } = browserHistory;\n  function updateFactory(method) {\n    return function update(path, state, callback) {\n      var pathname;\n      var pathIsString = typeof path === \"string\";\n      if (pathIsString) {\n        pathname = parsePath(path).pathname;\n      } else {\n        pathname = path.pathname;\n      }\n\n      // When history.push or history.replace is performing with an absolute pathname,\n      // force load the target page when it is a page of an outside app.\n      if (typeof pathname === \"string\" && pathname.startsWith(\"/\") && isOutsideApp(_internalApiMatchStoryboard(pathname))) {\n        // Going to outside apps.\n        return location[method === \"push\" ? \"assign\" : \"replace\"](pathIsString ? getBasePath() + path.substring(1) : browserHistory.createHref(path));\n      }\n      return (method === \"push\" ? originalPush : originalReplace)(path, state, callback);\n    };\n  }\n  return {\n    push: updateFactory(\"push\"),\n    replace: updateFactory(\"replace\")\n  };\n}\n\n/**\n * 扩展的系统会话对象。\n */\n\n/**\n * 更新指定的 query 参数。\n *\n * @param query - 要更新的 query 参数。\n * @param options - 选项。\n */\n\n/** 更新 query 参数时的选项 */\n\n/**\n * 设置指定的 anchor （URL hash）地址，此方法默认不会触发页面重新渲染。\n * 往浏览器会话历史栈中推入一条新记录。\n *\n * @param hash - Hash 地址。\n * @param state - 会话状态设置。\n */\n//# sourceMappingURL=historyExtended.js.map","import { createBrowserHistory } from \"history\";\nimport { getBasePath } from \"./getBasePath.js\";\nimport { getUserConfirmation, historyExtended } from \"./internal/historyExtended.js\";\nvar history;\nexport function createHistory() {\n  if (!history) {\n    // https://github.com/remix-run/history/issues/810\n    var browserHistory = createBrowserHistory({\n      basename: getBasePath().replace(/\\/$/, \"\"),\n      getUserConfirmation\n    });\n    Object.assign(browserHistory, historyExtended(browserHistory));\n    history = browserHistory;\n  }\n  return history;\n}\nexport function getHistory() {\n  return history;\n}\n//# sourceMappingURL=history.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { i18n, initializeI18n } from \"@next-core/i18n\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport { deepFreeze, isObject } from \"@next-core/utils/general\";\nimport moment from \"moment\";\nimport \"moment/locale/zh-cn.js\";\nimport { createHistory } from \"../history.js\";\nimport { matchStoryboard } from \"./matchStoryboard.js\";\nimport { Router } from \"./Router.js\";\nimport { NS, locales } from \"./i18n.js\";\nimport { loadNotificationService } from \"../Notification.js\";\nimport { loadDialogService } from \"../Dialog.js\";\nimport { injectedBrickPackages } from \"./injected.js\";\nvar runtime;\n\n// Allow inject bootstrap data in a runtime other than Brick Next.\nvar bootstrapData;\nvar router;\nexport var hooks;\nexport function createRuntime(options) {\n  if (runtime) {\n    throw new Error(\"Cannot create multiple runtimes\");\n  }\n  hooks = options === null || options === void 0 ? void 0 : options.hooks;\n  initializeI18n(NS, locales);\n  moment.locale(i18n.language);\n  i18n.on(\"languageChanged\", () => {\n    moment.locale(i18n.language);\n  });\n  createHistory();\n  runtime = new Runtime();\n  return runtime;\n}\nexport function getRuntime() {\n  return runtime;\n}\nvar _initialized = /*#__PURE__*/new WeakMap();\nvar _bootstrapped = /*#__PURE__*/new WeakMap();\nexport class Runtime {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _initialized, {\n      writable: true,\n      value: false\n    });\n    _classPrivateFieldInitSpec(this, _bootstrapped, {\n      writable: true,\n      value: false\n    });\n  }\n  initialize(data) {\n    var _data$settings$preset, _data$settings;\n    if (_classPrivateFieldGet(this, _initialized)) {\n      throw new Error(\"The runtime cannot be initialized more than once\");\n    }\n    _classPrivateFieldSet(this, _initialized, true);\n    normalizeBootstrapData(data);\n    bootstrapData = data;\n    var {\n      notification,\n      dialog\n    } = (_data$settings$preset = (_data$settings = data.settings) === null || _data$settings === void 0 ? void 0 : _data$settings.presetBricks) !== null && _data$settings$preset !== void 0 ? _data$settings$preset : {};\n    if (notification !== false) {\n      loadNotificationService(notification !== null && notification !== void 0 ? notification : \"shoelace.show-notification\", this.loadBricks);\n    }\n    if (dialog !== false) {\n      loadDialogService(dialog !== null && dialog !== void 0 ? dialog : \"shoelace.show-dialog\", this.loadBricks);\n    }\n  }\n  bootstrap(data) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (data) {\n        _this.initialize(data);\n      }\n      if (_classPrivateFieldGet(_this, _bootstrapped)) {\n        throw new Error(\"The runtime cannot be bootstrapped more than once\");\n      }\n      _classPrivateFieldSet(_this, _bootstrapped, true);\n      router = new Router(bootstrapData.storyboards);\n      yield router.bootstrap();\n    })();\n  }\n  getRecentApps() {\n    var _router$getRecentApps, _router;\n    return (_router$getRecentApps = (_router = router) === null || _router === void 0 ? void 0 : _router.getRecentApps()) !== null && _router$getRecentApps !== void 0 ? _router$getRecentApps : {};\n  }\n  getCurrentApp() {\n    var _router2;\n    return (_router2 = router) === null || _router2 === void 0 ? void 0 : _router2.getRecentApps().currentApp;\n  }\n  getFeatureFlags() {\n    var _bootstrapData, _bootstrapData$settin, _router3, _router3$getRecentApp, _router3$getRecentApp2, _router3$getRecentApp3;\n    return _objectSpread(_objectSpread(_objectSpread({}, (_bootstrapData = bootstrapData) === null || _bootstrapData === void 0 ? void 0 : (_bootstrapData$settin = _bootstrapData.settings) === null || _bootstrapData$settin === void 0 ? void 0 : _bootstrapData$settin.featureFlags), (_router3 = router) === null || _router3 === void 0 ? void 0 : (_router3$getRecentApp = _router3.getRecentApps().currentApp) === null || _router3$getRecentApp === void 0 ? void 0 : (_router3$getRecentApp2 = _router3$getRecentApp.config) === null || _router3$getRecentApp2 === void 0 ? void 0 : (_router3$getRecentApp3 = _router3$getRecentApp2.settings) === null || _router3$getRecentApp3 === void 0 ? void 0 : _router3$getRecentApp3.featureFlags), {}, {\n      \"migrate-to-brick-next-v3\": true\n    });\n  }\n  getMiscSettings() {\n    var _bootstrapData2, _bootstrapData2$setti, _router4, _router4$getRecentApp, _router4$getRecentApp2, _router4$getRecentApp3;\n    return _objectSpread(_objectSpread({}, (_bootstrapData2 = bootstrapData) === null || _bootstrapData2 === void 0 ? void 0 : (_bootstrapData2$setti = _bootstrapData2.settings) === null || _bootstrapData2$setti === void 0 ? void 0 : _bootstrapData2$setti.misc), (_router4 = router) === null || _router4 === void 0 ? void 0 : (_router4$getRecentApp = _router4.getRecentApps().currentApp) === null || _router4$getRecentApp === void 0 ? void 0 : (_router4$getRecentApp2 = _router4$getRecentApp.config) === null || _router4$getRecentApp2 === void 0 ? void 0 : (_router4$getRecentApp3 = _router4$getRecentApp2.settings) === null || _router4$getRecentApp3 === void 0 ? void 0 : _router4$getRecentApp3.misc);\n  }\n  getBrandSettings() {\n    var _bootstrapData3, _bootstrapData3$setti;\n    return _objectSpread({\n      base_title: \"DevOps 管理专家\"\n    }, (_bootstrapData3 = bootstrapData) === null || _bootstrapData3 === void 0 ? void 0 : (_bootstrapData3$setti = _bootstrapData3.settings) === null || _bootstrapData3$setti === void 0 ? void 0 : _bootstrapData3$setti.brand);\n  }\n  getLaunchpadSettings() {\n    var _bootstrapData4, _bootstrapData4$setti;\n    return _objectSpread({\n      columns: 7,\n      rows: 4\n    }, (_bootstrapData4 = bootstrapData) === null || _bootstrapData4 === void 0 ? void 0 : (_bootstrapData4$setti = _bootstrapData4.settings) === null || _bootstrapData4$setti === void 0 ? void 0 : _bootstrapData4$setti.launchpad);\n  }\n  getDesktops() {\n    var _bootstrapData$deskto, _bootstrapData5;\n    return (_bootstrapData$deskto = (_bootstrapData5 = bootstrapData) === null || _bootstrapData5 === void 0 ? void 0 : _bootstrapData5.desktops) !== null && _bootstrapData$deskto !== void 0 ? _bootstrapData$deskto : [];\n  }\n  getLaunchpadSiteMap() {\n    var _bootstrapData$siteSo, _bootstrapData6;\n    return (_bootstrapData$siteSo = (_bootstrapData6 = bootstrapData) === null || _bootstrapData6 === void 0 ? void 0 : _bootstrapData6.siteSort) !== null && _bootstrapData$siteSo !== void 0 ? _bootstrapData$siteSo : [];\n  }\n  toggleLaunchpadEffect(open) {\n    document.body.classList.toggle(\"launchpad-open\", open);\n  }\n  applyPageTitle(pageTitle) {\n    var baseTitle = this.getBrandSettings().base_title;\n    document.title = pageTitle ? \"\".concat(pageTitle, \" - \").concat(baseTitle) : baseTitle;\n  }\n  getNavConfig() {\n    var _router5;\n    return (_router5 = router) === null || _router5 === void 0 ? void 0 : _router5.getNavConfig();\n  }\n  loadBricks(bricks) {\n    return loadBricksImperatively(bricks, getBrickPackages());\n  }\n}\nfunction normalizeBootstrapData(data) {\n  if (Array.isArray(data.storyboards)) {\n    var _loop = function () {\n      if (app.locales) {\n        // Prefix to avoid conflict between brick package's i18n namespace.\n        var ns = \"tmp/\".concat(app.id);\n        // Support any languages in `app.locales`.\n        Object.entries(app.locales).forEach(_ref => {\n          var [lang, resources] = _ref;\n          i18n.addResourceBundle(lang, ns, resources);\n        });\n        // Use `app.name` as the fallback `app.localeName`.\n        app.localeName = i18n.getFixedT(null, ns)(\"name\", app.name);\n        // Remove the temporary i18n resource bundles.\n        Object.keys(app.locales).forEach(lang => {\n          i18n.removeResourceBundle(lang, ns);\n        });\n      } else {\n        app.localeName = app.name;\n      }\n    };\n    for (var {\n      app\n    } of data.storyboards) {\n      _loop();\n    }\n  }\n  if (isObject(data.settings)) {\n    deepFreeze(data.settings);\n  }\n  if (data.brickPackages) {\n    deepFreeze(data.brickPackages);\n  }\n}\nexport function getBrickPackages() {\n  var _bootstrapData$brickP, _bootstrapData7;\n  return (_bootstrapData$brickP = (_bootstrapData7 = bootstrapData) === null || _bootstrapData7 === void 0 ? void 0 : _bootstrapData7.brickPackages) !== null && _bootstrapData$brickP !== void 0 ? _bootstrapData$brickP : injectedBrickPackages;\n}\nexport function _internalApiLoadBricks(bricks) {\n  return loadBricksImperatively(bricks, getBrickPackages());\n}\nexport function _internalApiGetRenderId() {\n  var _router6;\n  return (_router6 = router) === null || _router6 === void 0 ? void 0 : _router6.getRenderId();\n}\nexport function _internalApiMatchStoryboard(pathname) {\n  var _bootstrapData$storyb, _bootstrapData8;\n  return matchStoryboard((_bootstrapData$storyb = (_bootstrapData8 = bootstrapData) === null || _bootstrapData8 === void 0 ? void 0 : _bootstrapData8.storyboards) !== null && _bootstrapData$storyb !== void 0 ? _bootstrapData$storyb : [], pathname);\n}\nexport function _internalApiGetRuntimeContext() {\n  var _router7;\n  return (_router7 = router) === null || _router7 === void 0 ? void 0 : _router7.getRuntimeContext();\n}\nexport function _internalApiGetStoryboardInBootstrapData(appId) {\n  var _bootstrapData9, _bootstrapData9$story;\n  return (_bootstrapData9 = bootstrapData) === null || _bootstrapData9 === void 0 ? void 0 : (_bootstrapData9$story = _bootstrapData9.storyboards) === null || _bootstrapData9$story === void 0 ? void 0 : _bootstrapData9$story.find(storyboard => storyboard.app.id === appId);\n}\nexport function _internalApiGetAppInBootstrapData(appId) {\n  var _internalApiGetStoryb;\n  return (_internalApiGetStoryb = _internalApiGetStoryboardInBootstrapData(appId)) === null || _internalApiGetStoryb === void 0 ? void 0 : _internalApiGetStoryb.app;\n}\nexport var _test_only_setBootstrapData;\n\n// istanbul ignore next\nif (process.env.NODE_ENV === \"test\") {\n  _test_only_setBootstrapData = data => {\n    bootstrapData = data;\n  };\n}\n//# sourceMappingURL=Runtime.js.map","import _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomProcessorRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  define(processorFullName, processorFunc) {\n    // `namespace` should be the camelCase of the package name.\n    var [namespace, processorName] = processorFullName.split(\".\");\n    var pkg = _classPrivateFieldGet(this, _registry).get(namespace);\n    if (!pkg) {\n      pkg = new Map();\n      _classPrivateFieldGet(this, _registry).set(namespace, pkg);\n    }\n    if (pkg.has(processorName)) {\n      // eslint-disable-next-line no-console\n      throw new Error(\"Custom processor of \\\"\".concat(processorFullName, \"\\\" already registered\"));\n    }\n    pkg.set(processorName, processorFunc);\n  }\n  get(namespace) {\n    return _classPrivateFieldGet(this, _registry).get(namespace);\n  }\n}\nexport var customProcessors = new CustomProcessorRegistry();\n//# sourceMappingURL=CustomProcessors.js.map","import { i18n } from \"@next-core/i18n\";\nexport function registerAppI18n(_ref) {\n  var {\n    app,\n    meta\n  } = _ref;\n  if (meta !== null && meta !== void 0 && meta.i18n) {\n    // Prefix to avoid conflict between brick package's i18n namespace.\n    var i18nNamespace = getI18nNamespace(\"app\", app.id);\n    // Support any language in `meta.i18n`.\n    var languages = [];\n    Object.entries(meta.i18n).forEach(_ref2 => {\n      var [lang, resources] = _ref2;\n      i18n.addResourceBundle(lang, i18nNamespace, resources);\n      languages.push(lang);\n    });\n    return () => {\n      for (var lang of languages) {\n        i18n.removeResourceBundle(lang, i18nNamespace);\n      }\n    };\n  }\n}\nexport function getI18nNamespace(type, id) {\n  return \"\".concat(type, \"/\").concat(id);\n}\n//# sourceMappingURL=registerAppI18n.js.map","// import i18next, { getFixedT, TFunction } from \"i18next\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nexport function registerWidgetI18n(widgetId, i18nData) {\n  var ns = getI18nNamespace(\"widget\", widgetId);\n  Object.entries(i18nData).forEach(_ref => {\n    var [lang, resources] = _ref;\n    i18n.addResourceBundle(lang, ns, resources);\n  });\n}\nexport function widgetI18nFactory(widgetId) {\n  return i18n.getFixedT(null, getI18nNamespace(\"widget\", widgetId));\n}\n//# sourceMappingURL=WidgetI18n.js.map","import { escapeRegExp } from \"lodash\";\nimport { getBasePath } from \"../../getBasePath.js\";\nexport function imagesFactory(appId, isBuildPush, version) {\n  return {\n    get(name) {\n      if (isBuildPush) {\n        return \"\".concat(getBasePath(), \"api/gateway/object_store.object_store.GetObject/api/v1/objectStore/bucket/next-builder/object/\").concat(name);\n      }\n      var suffix = window.APP_ROOT ? \"\".concat(window.APP_ROOT, \"-/\") : \"\";\n\n      // In injecting menus, the current app ID maybe not the same as the\n      // target app of the icon, try to replace the app ID as well as its\n      // version in the suffix.\n      if (window.APP_ID && window.APP_ID !== appId) {\n        suffix = suffix.replace(new RegExp(\"(^|/)\".concat(escapeRegExp(window.APP_ID), \"/\")), \"$1\".concat(appId, \"/\")).replace(/\\/\\d+\\.\\d+\\.\\d+\\//, \"/\".concat(version, \"/\"));\n      }\n      if (!suffix.startsWith(\"/\")) {\n        suffix = getBasePath() + suffix;\n      }\n      return \"\".concat(suffix, \"micro-apps/\").concat(appId, \"/images/\").concat(name);\n    }\n  };\n}\nexport function widgetImagesFactory(widgetId, widgetVersion) {\n  return {\n    get(name) {\n      var _window$PUBLIC_ROOT;\n      return \"\".concat((_window$PUBLIC_ROOT = window.PUBLIC_ROOT) !== null && _window$PUBLIC_ROOT !== void 0 ? _window$PUBLIC_ROOT : \"\", \"bricks/\").concat(widgetId, \"/\").concat(window.PUBLIC_ROOT_WITH_VERSION && widgetVersion ? \"\".concat(widgetVersion, \"/\") : \"\", \"dist/assets/\").concat(name);\n    }\n  };\n}\n//# sourceMappingURL=images.js.map","export function getDevHook() {\n  return window.__BRICK_NEXT_DEVTOOLS_HOOK__;\n}\n//# sourceMappingURL=devtools.js.map","import { getDevHook } from \"./devtools.js\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar THROW = () => {\n  throw new Error(\"Can't modify read-only proxy object\");\n};\nvar readOnlyHandler = {\n  set: THROW,\n  defineProperty: THROW,\n  deleteProperty: THROW,\n  setPrototypeOf: THROW\n};\nexport function getReadOnlyProxy(object) {\n  return new Proxy(object, readOnlyHandler);\n}\n\n// First, we want to make accessing property of globals lazy,\n// So we use *Proxy* to make a dynamic accessor for each of these globals.\n// But we also want to keep them working in devtools.\nexport function getDynamicReadOnlyProxy(_ref) {\n  var {\n    get,\n    ownKeys\n  } = _ref;\n  if (getDevHook()) {\n    // In devtools, we extract them at beginning.\n    var target = Object.fromEntries(ownKeys(null).map(key => [key, get(null, key, null)]));\n    return getReadOnlyProxy(target);\n  }\n  return new Proxy(Object.freeze({}), {\n    get\n  });\n}\n//# sourceMappingURL=proxyFactories.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { JsonStorage } from \"@next-core/utils/general\";\n// Themes.\nvar theme = \"light\";\nvar storage = new JsonStorage(localStorage);\nvar LOCAL_STORAGE_APPS_THEME_KEY = \"apps-theme\";\nexport function setTheme(value) {\n  if (value !== \"dark\" && value !== \"light\" && value !== \"dark-v2\") {\n    throw new Error(\"Unsupported theme: \".concat(value));\n  }\n  theme = value;\n}\nexport function getTheme() {\n  return theme;\n}\nexport function getCurrentTheme() {\n  return document.documentElement.dataset.theme;\n}\nexport function applyTheme(value) {\n  if (value) {\n    setTheme(value);\n  } else {\n    value = getTheme();\n  }\n  if (value !== getCurrentTheme()) {\n    document.documentElement.dataset.theme = value;\n    window.dispatchEvent(new CustomEvent(\"theme.change\", {\n      detail: value\n    }));\n  }\n}\nexport function batchSetAppsLocalTheme(appsTheme) {\n  storage.setItem(LOCAL_STORAGE_APPS_THEME_KEY, _objectSpread(_objectSpread({}, getLocalAppsTheme()), appsTheme));\n}\nexport function getLocalAppsTheme() {\n  var _result;\n  var result;\n  try {\n    result = storage.getItem(LOCAL_STORAGE_APPS_THEME_KEY);\n  } catch (_unused) {\n    // eslint-disable-next-line no-console\n    console.error(\"JSON parse error inside `getLocalAppsTheme()`\");\n  }\n  return (_result = result) !== null && _result !== void 0 ? _result : {};\n}\n\n// Modes.\nvar mode = \"default\";\nexport function setMode(value) {\n  if (value !== \"dashboard\" && value !== \"default\") {\n    throw new Error(\"Unsupported mode: \".concat(value));\n  }\n  mode = value;\n}\nexport function getMode() {\n  return mode;\n}\nexport function getCurrentMode() {\n  return document.documentElement.dataset.mode;\n}\nexport function applyMode(value) {\n  if (value) {\n    setMode(value);\n  } else {\n    value = getMode();\n  }\n  if (value !== getCurrentMode()) {\n    document.documentElement.dataset.mode = value;\n    window.dispatchEvent(new CustomEvent(\"mode.change\", {\n      detail: value\n    }));\n  }\n}\nexport function getCssPropertyValue(name) {\n  var _window$getComputedSt;\n  var el = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document.documentElement;\n  if (!el) return \"\";\n  return ((_window$getComputedSt = window.getComputedStyle(el)) === null || _window$getComputedSt === void 0 ? void 0 : _window$getComputedSt.getPropertyValue(name)) || \"\";\n}\n//# sourceMappingURL=themeAndMode.js.map","import { identity } from \"lodash\";\nimport { i18n, i18nText } from \"@next-core/i18n\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { imagesFactory, widgetImagesFactory } from \"./images.js\";\nimport { getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { getTheme } from \"../../themeAndMode.js\";\nimport { getBasePath } from \"../../getBasePath.js\";\nimport { getI18nNamespace } from \"../registerAppI18n.js\";\nimport { hooks } from \"../Runtime.js\";\n// `GeneralGlobals` are globals which are page-state-agnostic,\n// thus they can be used both in storyboard expressions and functions.\nexport function getGeneralGlobals(attemptToVisitGlobals, options) {\n  var globalVariables = {};\n  for (var variableName of attemptToVisitGlobals) {\n    var variable = getIndividualGlobal(variableName, options);\n    if (variable !== undefined) {\n      globalVariables[variableName] = variable;\n    }\n  }\n  return globalVariables;\n}\nfunction getIndividualGlobal(variableName, _ref) {\n  var _hooks$checkPermissio;\n  var {\n    collectCoverage,\n    widgetId,\n    widgetVersion,\n    app,\n    appendI18nNamespace,\n    storyboardFunctions,\n    isStoryboardFunction\n  } = _ref;\n  switch (variableName) {\n    case \"BASE_URL\":\n      return collectCoverage ? \"/next\" : getBasePath().replace(/\\/$/, \"\");\n    case \"FN\":\n      return storyboardFunctions;\n    case \"IMG\":\n      return collectCoverage ? fakeImageFactory() : widgetId ? widgetImagesFactory(widgetId, widgetVersion) : imagesFactory(app.id, app.isBuildPush, app.currentVersion);\n    case \"I18N\":\n      return collectCoverage ? identity : widgetId ? widgetI18nFactory(widgetId) : i18n.getFixedT(null, [appendI18nNamespace, getI18nNamespace(\"app\", app.id)].filter(Boolean));\n    case \"I18N_TEXT\":\n      return collectCoverage ? fakeI18nText : i18nText;\n    case \"PERMISSIONS\":\n      return getReadOnlyProxy({\n        check: collectCoverage ? fakeCheckPermissions : hooks === null || hooks === void 0 ? void 0 : (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.checkPermissions\n      });\n    case \"THEME\":\n      return getReadOnlyProxy({\n        getTheme: collectCoverage ? () => \"light\" : getTheme\n        // getCssPropertyValue: collectCoverage ? () => \"\" : getCssPropertyValue,\n      });\n\n    case \"console\":\n      return isStoryboardFunction ? getReadOnlyProxy(console) : undefined;\n    case \"location\":\n      return collectCoverage ? {\n        href: \"http://localhost:3000/functions/test\",\n        origin: \"http://localhost:3000\",\n        host: \"localhost:3000\",\n        hostname: \"localhost\"\n      } : {\n        href: location.href,\n        origin: location.origin,\n        host: location.host,\n        hostname: location.hostname\n      };\n  }\n}\nfunction fakeI18nText(data) {\n  return data === null || data === void 0 ? void 0 : data.en;\n}\nfunction fakeImageFactory() {\n  return {\n    get(name) {\n      return \"mock/images/\".concat(name);\n    }\n  };\n}\nfunction fakeCheckPermissions() {\n  return true;\n}\n//# sourceMappingURL=getGeneralGlobals.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { cook, precookFunction } from \"@next-core/cook\";\nimport { supply } from \"@next-core/supply\";\nimport { strictCollectMemberUsageInFunction } from \"@next-core/utils/storyboard\";\nimport { getGeneralGlobals } from \"./internal/compute/getGeneralGlobals.js\";\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\n\n/** @internal */\nexport function StoryboardFunctionRegistryFactory() {\n  var {\n    widgetId,\n    widgetVersion,\n    collectCoverage\n  } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var registeredFunctions = new Map();\n\n  // Use `Proxy` with a frozen target, to make a readonly function registry.\n  var storyboardFunctions = new Proxy(Object.freeze({}), {\n    get(target, key) {\n      return getStoryboardFunction(key);\n    }\n  });\n  var currentApp;\n  function registerStoryboardFunctions(functions, app) {\n    if (app) {\n      currentApp = app;\n    }\n    registeredFunctions.clear();\n    if (Array.isArray(functions)) {\n      for (var fn of functions) {\n        var deps = strictCollectMemberUsageInFunction(fn, \"FN\");\n        var hasPermissionsCheck = strictCollectMemberUsageInFunction(fn, \"PERMISSIONS\").has(\"check\");\n        registeredFunctions.set(fn.name, {\n          source: fn.source,\n          typescript: fn.typescript,\n          deps,\n          hasPermissionsCheck\n        });\n      }\n    }\n  }\n  function getStoryboardFunction(name) {\n    var fn = registeredFunctions.get(name);\n    if (!fn) {\n      return undefined;\n    }\n    if (fn.processed) {\n      return fn.cooked;\n    }\n    var collector;\n    if (collectCoverage) {\n      collector = collectCoverage.createCollector(name);\n    }\n    var precooked = precookFunction(fn.source, {\n      typescript: fn.typescript,\n      hooks: collector && {\n        beforeVisit: collector.beforeVisit\n      }\n    });\n    fn.cooked = cook(precooked.function, fn.source, {\n      rules: {\n        noVar: true\n      },\n      globalVariables: supply(precooked.attemptToVisitGlobals, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        collectCoverage,\n        widgetId,\n        widgetVersion,\n        app: currentApp,\n        storyboardFunctions,\n        isStoryboardFunction: true\n      }), !!collectCoverage),\n      hooks: collector && {\n        beforeEvaluate: collector.beforeEvaluate,\n        beforeCall: collector.beforeCall,\n        beforeBranch: collector.beforeBranch\n      }\n    });\n    fn.processed = true;\n    return fn.cooked;\n  }\n  return {\n    storyboardFunctions,\n    registerStoryboardFunctions,\n    updateStoryboardFunction(name, data) {\n      var newFn = _objectSpread(_objectSpread({}, data), {}, {\n        name\n      });\n      var deps = strictCollectMemberUsageInFunction(newFn, \"FN\");\n      var hasPermissionsCheck = strictCollectMemberUsageInFunction(newFn, \"PERMISSIONS\").has(\"check\");\n      registeredFunctions.set(name, {\n        source: data.source,\n        typescript: data.typescript,\n        deps,\n        hasPermissionsCheck\n      });\n    },\n    /**\n     * Check whether listed functions attempt to call `PERMISSIONS.check()`,\n     * includes in nested `FN.*()` calls.\n     */\n    checkPermissionsUsage(functionNames) {\n      var checkedFunctions = new Set();\n      var hasPermissionsCheck = name => {\n        if (!checkedFunctions.has(name)) {\n          checkedFunctions.add(name);\n          var fn = registeredFunctions.get(name);\n          return !!fn && (fn.hasPermissionsCheck || [...fn.deps].some(hasPermissionsCheck));\n        }\n        return false;\n      };\n      return functionNames.some(hasPermissionsCheck);\n    }\n  };\n}\n//# sourceMappingURL=StoryboardFunctionRegistry.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nexport var {\n  storyboardFunctions,\n  registerStoryboardFunctions,\n  checkPermissionsUsage\n} = StoryboardFunctionRegistryFactory();\n//# sourceMappingURL=StoryboardFunctions.js.map","/*! (c) Andrea Giammarchi - ISC */\nvar self = {};\ntry {\n  self.EventTarget = (new EventTarget).constructor;\n} catch(EventTarget) {\n  (function (Object, wm) {\n    var create = Object.create;\n    var defineProperty = Object.defineProperty;\n    var proto = EventTarget.prototype;\n    define(proto, 'addEventListener', function (type, listener, options) {\n      for (var\n        secret = wm.get(this),\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener)\n          return;\n      }\n      listeners.push({target: this, listener: listener, options: options});\n    });\n    define(proto, 'dispatchEvent', function (event) {\n      var secret = wm.get(this);\n      var listeners = secret[event.type];\n      if (listeners) {\n        define(event, 'target', this);\n        define(event, 'currentTarget', this);\n        listeners.slice(0).some(dispatch, event);\n        delete event.currentTarget;\n        delete event.target;\n      }\n      return true;\n    });\n    define(proto, 'removeEventListener', function (type, listener) {\n      for (var\n        secret = wm.get(this),\n        /* istanbul ignore next */\n        listeners = secret[type] || (secret[type] = []),\n        i = 0, length = listeners.length; i < length; i++\n      ) {\n        if (listeners[i].listener === listener) {\n          listeners.splice(i, 1);\n          return;\n        }\n      }\n    });\n    self.EventTarget = EventTarget;\n    function EventTarget() {'use strict';\n      wm.set(this, create(null));\n    }\n    function define(target, name, value) {\n      defineProperty(\n        target,\n        name,\n        {\n          configurable: true,\n          writable: true,\n          value: value\n        }\n      );\n    }\n    function dispatch(info) {\n      var options = info.options;\n      if (options && options.once)\n        info.target.removeEventListener(this.type, info.listener);\n      if (typeof info.listener === 'function')\n        info.listener.call(info.target, this);\n      else\n        info.listener.handleEvent(this);\n      return this._stopImmediatePropagationFlag;\n    }\n  }(Object, new WeakMap));\n}\nexport default self.EventTarget;\n","import EventTarget from \"@ungap/event-target\";\nexport var MediaBreakpoint = /*#__PURE__*/function (MediaBreakpoint) {\n  MediaBreakpoint[\"xLarge\"] = \"xLarge\";\n  MediaBreakpoint[\"large\"] = \"large\";\n  MediaBreakpoint[\"medium\"] = \"medium\";\n  MediaBreakpoint[\"small\"] = \"small\";\n  MediaBreakpoint[\"xSmall\"] = \"xSmall\";\n  return MediaBreakpoint;\n}({});\nexport var mediaBreakpointMinWidthMap = new Map([[MediaBreakpoint.xLarge, \"1920px\"], [MediaBreakpoint.large, \"1600px\"], [MediaBreakpoint.medium, \"1280px\"], [MediaBreakpoint.small, \"1024px\"], [MediaBreakpoint.xSmall, 0]]);\nexport var mediaEventTarget = new EventTarget();\nvar breakpointMatchesMap = {};\nvar MEDIA = {};\nfunction handleMatchesChange(data, breakpoint) {\n  var changed = false;\n  breakpointMatchesMap[breakpoint] = data.matches;\n  for (var [_breakpoint] of mediaBreakpointMinWidthMap) {\n    if (breakpointMatchesMap[_breakpoint] && MEDIA.breakpoint !== _breakpoint) {\n      MEDIA.breakpoint = _breakpoint;\n      changed = true;\n      break;\n    }\n  }\n  if (changed) {\n    mediaEventTarget.dispatchEvent(new CustomEvent(\"change\", {\n      detail: MEDIA\n    }));\n  }\n}\nmediaBreakpointMinWidthMap.forEach((minWidth, breakpoint) => {\n  var mediaQueryList = window.matchMedia(\"(min-width: \".concat(minWidth, \")\"));\n  handleMatchesChange(mediaQueryList, breakpoint);\n  if (mediaQueryList.addEventListener) {\n    mediaQueryList.addEventListener(\"change\", event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  } else {\n    mediaQueryList.addListener(event => {\n      handleMatchesChange(event, breakpoint);\n    });\n  }\n});\nexport var getMedia = () => MEDIA;\n//# sourceMappingURL=mediaQuery.js.map","export function getStorageItem(storageType) {\n  return function (name) {\n    var _storage$getItem;\n    var storage = storageType === \"local\" ? localStorage : sessionStorage;\n    return JSON.parse((_storage$getItem = storage.getItem(name)) !== null && _storage$getItem !== void 0 ? _storage$getItem : \"null\");\n  };\n}\n//# sourceMappingURL=getStorageItem.js.map","import { getRuntime } from \"./index.js\";\nexport function isStrictMode(runtimeContext) {\n  var _ref, _getRuntime;\n  return !!((_ref = runtimeContext ? runtimeContext.flags : (_getRuntime = getRuntime()) === null || _getRuntime === void 0 ? void 0 : _getRuntime.getFeatureFlags()) !== null && _ref !== void 0 && _ref[\"brick-next-v3-strict-mode\"]);\n}\nexport function warnAboutStrictMode(strict, message) {\n  for (var _len = arguments.length, extraLogs = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    extraLogs[_key - 2] = arguments[_key];\n  }\n  var punctuation = extraLogs.length === 0 ? \"\" : \",\";\n  if (strict) {\n    // eslint-disable-next-line no-console\n    console.error(\"\".concat(message, \" is dropped in v3 strict mode\").concat(punctuation), ...extraLogs);\n  } else {\n    // eslint-disable-next-line no-console\n    console.warn(\"\".concat(message, \" is deprecated in v3 and will be dropped in strict mode\").concat(punctuation), ...extraLogs);\n  }\n}\n//# sourceMappingURL=isStrictMode.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { uniq } from \"lodash\";\nimport { isStrictMode, warnAboutStrictMode } from \"./isStrictMode.js\";\n\n// Note: `prefix` is a native prop on Element, but it's only used in XML documents.\nvar allowedNativeProps = new Set([\"prefix\"]);\nvar _registry = /*#__PURE__*/new WeakMap();\nclass CustomTemplateRegistry {\n  constructor() {\n    _classPrivateFieldInitSpec(this, _registry, {\n      writable: true,\n      value: new Map()\n    });\n  }\n  define(tagName, constructor) {\n    var _constructor$proxy$pr, _constructor$proxy, _compatibleConstructo, _compatibleConstructo2;\n    var registered = _classPrivateFieldGet(this, _registry).has(tagName);\n    if (registered) {\n      // When open launchpad, the storyboard will be updated.\n      // However, we can't *undefine* a custom element.\n      // Just ignore re-registering custom templates.\n      // eslint-disable-next-line no-console\n      console.warn(\"Custom template of \\\"\".concat(tagName, \"\\\" already registered.\"));\n    } else {\n      registered = !!customElements.get(tagName);\n      if (registered) {\n        // eslint-disable-next-line no-console\n        console.warn(\"Custom template of \\\"\".concat(tagName, \"\\\" already defined by customElements.\"));\n      }\n    }\n\n    // Transform legacy `proxy.properties[].asVariable` as states.\n    var strict = isStrictMode();\n    var proxyProperties = (_constructor$proxy$pr = (_constructor$proxy = constructor.proxy) === null || _constructor$proxy === void 0 ? void 0 : _constructor$proxy.properties) !== null && _constructor$proxy$pr !== void 0 ? _constructor$proxy$pr : {};\n    var validProxyProps = [];\n    var legacyTplVariables = [];\n    for (var [key, value] of Object.entries(proxyProperties)) {\n      if (value.asVariable) {\n        warnAboutStrictMode(strict, \"Template `asVariable`\", tagName, key);\n        // istanbul ignore next\n        if (!strict) {\n          // For existed TPL usage, treat it as a STATE.\n          legacyTplVariables.push(key);\n        }\n      } else if (value.mergeProperty || value.refTransform) {\n        // eslint-disable-next-line no-console\n        console.error(\"Template `mergeProperty` and `refTransform` are dropped in v3:\", tagName, key);\n      } else if (value.ref) {\n        validProxyProps.push([key, value]);\n      }\n      // Else: documentation only, for exposed states.\n    }\n\n    var compatibleConstructor = _objectSpread(_objectSpread({}, constructor), {}, {\n      proxy: _objectSpread(_objectSpread({}, constructor.proxy), {}, {\n        properties: Object.fromEntries(validProxyProps)\n      }),\n      state: (constructor.state ? strict ? constructor.state : constructor.state.map(item => _objectSpread({\n        // Make `expose` defaults to true in non-strict mode.\n        expose: true\n      }, item)) : []).concat(legacyTplVariables.map(tpl => ({\n        name: tpl,\n        expose: true\n      })))\n    });\n\n    // Now we allow re-register custom template\n    _classPrivateFieldGet(this, _registry).set(tagName, _objectSpread(_objectSpread({}, compatibleConstructor), {}, {\n      name: tagName\n    }));\n    var exposedStates = getExposedStates(compatibleConstructor.state);\n    var proxyMethods = Object.entries((_compatibleConstructo = (_compatibleConstructo2 = compatibleConstructor.proxy) === null || _compatibleConstructo2 === void 0 ? void 0 : _compatibleConstructo2.methods) !== null && _compatibleConstructo !== void 0 ? _compatibleConstructo : {});\n    var props = exposedStates.concat(validProxyProps.map(entry => entry[0]));\n    var methods = proxyMethods.map(entry => entry[0]);\n    var nativeProps = props.concat(methods).filter(prop => prop in HTMLElement.prototype && !allowedNativeProps.has(prop));\n    if (nativeProps.length > 0) {\n      warnAboutStrictMode(strict, \"Using native HTMLElement properties as template properties or methods\", tagName, ...nativeProps);\n      // istanbul ignore next\n      if (strict) {\n        throw new Error(\"In custom template \\\"\".concat(tagName, \"\\\", \").concat(nativeProps.map(p => \"\\\"\".concat(p, \"\\\"\")).join(\", \"), \" are native HTMLElement properties, and should be avoid to be used as brick properties or methods.\"));\n      }\n    }\n    if (registered) {\n      return;\n    }\n    class TplElement extends HTMLElement {\n      get $$typeof() {\n        return \"custom-template\";\n      }\n      static get _dev_only_definedProperties() {\n        return props;\n      }\n      static get _dev_only_definedMethods() {\n        return methods;\n      }\n      $$getElementByRef(ref) {\n        var _this$$$tplStateStore, _this$$$tplStateStore2, _this$$$tplStateStore3, _this$$$tplStateStore4;\n        return (_this$$$tplStateStore = this.$$tplStateStore) === null || _this$$$tplStateStore === void 0 ? void 0 : (_this$$$tplStateStore2 = _this$$$tplStateStore.hostBrick) === null || _this$$$tplStateStore2 === void 0 ? void 0 : (_this$$$tplStateStore3 = _this$$$tplStateStore2.tplHostMetadata) === null || _this$$$tplStateStore3 === void 0 ? void 0 : (_this$$$tplStateStore4 = _this$$$tplStateStore3.internalBricksByRef.get(ref)) === null || _this$$$tplStateStore4 === void 0 ? void 0 : _this$$$tplStateStore4.element;\n      }\n      connectedCallback() {\n        var shadowRoot = this.shadowRoot;\n        if (!shadowRoot) {\n          shadowRoot = this.attachShadow({\n            mode: \"open\"\n          });\n        }\n        var fragment = document.createDocumentFragment();\n        var style = document.createElement(\"style\");\n        style.textContent = \":host{display:block}:host([hidden]){display:none}\";\n        var slot = document.createElement(\"slot\");\n        fragment.appendChild(style);\n        fragment.appendChild(slot);\n        shadowRoot.appendChild(fragment);\n      }\n      disconnectedCallback() {\n        if (this.shadowRoot) {\n          this.shadowRoot.textContent = \"\";\n        }\n      }\n    }\n    var _loop = function (propName) {\n      if (validProxyProps.some(entry => entry[0] === propName)) {\n        // eslint-disable-next-line no-console\n        console.error(\"Cannot define an exposed state that is also a proxy property: \\\"\".concat(propName, \"\\\" in \").concat(tagName));\n        return \"continue\";\n      }\n      Object.defineProperty(TplElement.prototype, propName, {\n        get() {\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          return this.$$tplStateStore.getValue(propName);\n        },\n        set(value) {\n          var _this$$$tplStateStore5;\n          // 在 mount 过程中，先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n          // 避免初始化的一次 state update 操作及其 onChange 事件。\n          (_this$$$tplStateStore5 = this.$$tplStateStore) === null || _this$$$tplStateStore5 === void 0 ? void 0 : _this$$$tplStateStore5.updateValue(propName, value, \"replace\");\n        },\n        enumerable: true\n      });\n    };\n    for (var propName of exposedStates) {\n      var _ret = _loop(propName);\n      if (_ret === \"continue\") continue;\n    }\n    var _loop2 = function (from, to) {\n      Object.defineProperty(TplElement.prototype, from, {\n        get() {\n          var _to$refProperty;\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          var element = this.$$getElementByRef(to.ref);\n          return element[(_to$refProperty = to.refProperty) !== null && _to$refProperty !== void 0 ? _to$refProperty : from];\n        },\n        set(value) {\n          var _this$$$getElementByR;\n          // 同上 exposedState.set\n          var element = (_this$$$getElementByR = this.$$getElementByRef) === null || _this$$$getElementByR === void 0 ? void 0 : _this$$$getElementByR.call(this, to.ref);\n          if (element) {\n            var _to$refProperty2;\n            element[(_to$refProperty2 = to.refProperty) !== null && _to$refProperty2 !== void 0 ? _to$refProperty2 : from] = value;\n          }\n        },\n        enumerable: true\n      });\n    };\n    for (var [from, to] of validProxyProps) {\n      _loop2(from, to);\n    }\n    var _loop3 = function (_from, _to) {\n      Object.defineProperty(TplElement.prototype, _from, {\n        value() {\n          var _to$refMethod;\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          var element = this.$$getElementByRef(_to.ref);\n          element[(_to$refMethod = _to.refMethod) !== null && _to$refMethod !== void 0 ? _to$refMethod : _from](...arguments);\n        },\n        enumerable: true\n      });\n    };\n    for (var [_from, _to] of proxyMethods) {\n      _loop3(_from, _to);\n    }\n    customElements.define(tagName, TplElement);\n  }\n  get(tagName) {\n    return _classPrivateFieldGet(this, _registry).get(tagName);\n  }\n}\nexport var customTemplates = new CustomTemplateRegistry();\nfunction getExposedStates(state) {\n  var _state$filter$map;\n  // Allow duplicated state names which maybe mutually exclusive.\n  return uniq((_state$filter$map = state === null || state === void 0 ? void 0 : state.filter(item => item.expose).map(item => item.name)) !== null && _state$filter$map !== void 0 ? _state$filter$map : []);\n}\n//# sourceMappingURL=CustomTemplates.js.map","import { customTemplates } from \"../../CustomTemplates.js\";\nexport function getTplStateStore(_ref, using, extraInfo) {\n  var {\n    tplStateStoreId,\n    tplStateStoreMap\n  } = _ref;\n  if (!tplStateStoreId) {\n    throw new Error(\"Using \\\"\".concat(using, \"\\\" outside of a custom template\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\"));\n  }\n  var store = tplStateStoreMap.get(tplStateStoreId);\n  if (!store) {\n    throw new Error(\"Template state store is not found when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return store;\n}\nexport function getTplHostElement(runtimeContext, using, extraInfo) {\n  var store = getTplStateStore(runtimeContext, using, extraInfo);\n  var hostElement = store.hostBrick.element;\n  if (!hostElement) {\n    throw new Error(\"Template host element is gone when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return hostElement;\n}\nexport function getTagNameOfCustomTemplate(brick, appId) {\n  // When a template is registered by an app, it's namespace maybe missed.\n  if (!brick.includes(\".\") && brick.startsWith(\"tpl-\") && appId) {\n    var tagName = \"\".concat(appId, \".\").concat(brick);\n    if (customTemplates.get(tagName)) {\n      return tagName;\n    }\n  }\n  if (customTemplates.get(brick)) {\n    return brick;\n  }\n  return false;\n}\n//# sourceMappingURL=utils.js.map","import { StoryboardFunctionRegistryFactory } from \"../../StoryboardFunctionRegistry.js\";\nvar widgetFunctionRegistry = new Map();\nexport var widgetFunctions = new Proxy(Object.freeze({}), {\n  get(target, key) {\n    return widgetFunctionRegistry.get(key);\n  }\n});\nexport function registerWidgetFunctions(widgetId, functions, widgetVersion) {\n  if (widgetFunctionRegistry.has(widgetId)) {\n    // eslint-disable-next-line no-console\n    throw new Error(\"Widget functions of \\\"\".concat(widgetId, \"\\\" already registered\"));\n  }\n  var {\n    storyboardFunctions,\n    registerStoryboardFunctions\n  } = StoryboardFunctionRegistryFactory({\n    widgetId,\n    widgetVersion\n  });\n  widgetFunctionRegistry.set(widgetId, storyboardFunctions);\n  registerStoryboardFunctions(functions);\n}\n//# sourceMappingURL=WidgetFunctions.js.map","/**\n * Compare [semver](https://semver.org/) version strings to find greater, equal or lesser.\n * This library supports the full semver specification, including comparing versions with different number of digits like `1.0.0`, `1.0`, `1`, and pre-release versions like `1.0.0-alpha`.\n * @param v1 - First version to compare\n * @param v2 - Second version to compare\n * @returns Numeric value compatible with the [Array.sort(fn) interface](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Parameters).\n */\nexport const compareVersions = (v1, v2) => {\n    // validate input and split into segments\n    const n1 = validateAndParse(v1);\n    const n2 = validateAndParse(v2);\n    // pop off the patch\n    const p1 = n1.pop();\n    const p2 = n2.pop();\n    // validate numbers\n    const r = compareSegments(n1, n2);\n    if (r !== 0)\n        return r;\n    // validate pre-release\n    if (p1 && p2) {\n        return compareSegments(p1.split('.'), p2.split('.'));\n    }\n    else if (p1 || p2) {\n        return p1 ? -1 : 1;\n    }\n    return 0;\n};\n/**\n * Validate [semver](https://semver.org/) version strings.\n *\n * @param version Version number to validate\n * @returns `true` if the version number is a valid semver version number, `false` otherwise.\n *\n * @example\n * ```\n * validate('1.0.0-rc.1'); // return true\n * validate('1.0-rc.1'); // return false\n * validate('foo'); // return false\n * ```\n */\nexport const validate = (version) => typeof version === 'string' && /^[v\\d]/.test(version) && semver.test(version);\n/**\n * Compare [semver](https://semver.org/) version strings using the specified operator.\n *\n * @param v1 First version to compare\n * @param v2 Second version to compare\n * @param operator Allowed arithmetic operator to use\n * @returns `true` if the comparison between the firstVersion and the secondVersion satisfies the operator, `false` otherwise.\n *\n * @example\n * ```\n * compare('10.1.8', '10.0.4', '>'); // return true\n * compare('10.0.1', '10.0.1', '='); // return true\n * compare('10.1.1', '10.2.2', '<'); // return true\n * compare('10.1.1', '10.2.2', '<='); // return true\n * compare('10.1.1', '10.2.2', '>='); // return false\n * ```\n */\nexport const compare = (v1, v2, operator) => {\n    // validate input operator\n    assertValidOperator(operator);\n    // since result of compareVersions can only be -1 or 0 or 1\n    // a simple map can be used to replace switch\n    const res = compareVersions(v1, v2);\n    return operatorResMap[operator].includes(res);\n};\n/**\n * Match [npm semver](https://docs.npmjs.com/cli/v6/using-npm/semver) version range.\n *\n * @param version Version number to match\n * @param range Range pattern for version\n * @returns `true` if the version number is within the range, `false` otherwise.\n *\n * @example\n * ```\n * satisfies('1.1.0', '^1.0.0'); // return true\n * satisfies('1.1.0', '~1.0.0'); // return false\n * ```\n */\nexport const satisfies = (version, range) => {\n    // if no range operator then \"=\"\n    const m = range.match(/^([<>=~^]+)/);\n    const op = m ? m[1] : '=';\n    // if gt/lt/eq then operator compare\n    if (op !== '^' && op !== '~')\n        return compare(version, range, op);\n    // else range of either \"~\" or \"^\" is assumed\n    const [v1, v2, v3, , vp] = validateAndParse(version);\n    const [r1, r2, r3, , rp] = validateAndParse(range);\n    const v = [v1, v2, v3];\n    const r = [r1, r2 !== null && r2 !== void 0 ? r2 : 'x', r3 !== null && r3 !== void 0 ? r3 : 'x'];\n    // validate pre-release\n    if (rp) {\n        if (!vp)\n            return false;\n        if (compareSegments(v, r) !== 0)\n            return false;\n        if (compareSegments(vp.split('.'), rp.split('.')) === -1)\n            return false;\n    }\n    // first non-zero number\n    const nonZero = r.findIndex((v) => v !== '0') + 1;\n    // pointer to where segments can be >=\n    const i = op === '~' ? 2 : nonZero > 1 ? nonZero : 1;\n    // before pointer must be equal\n    if (compareSegments(v.slice(0, i), r.slice(0, i)) !== 0)\n        return false;\n    // after pointer must be >=\n    if (compareSegments(v.slice(i), r.slice(i)) === -1)\n        return false;\n    return true;\n};\nconst semver = /^[v^~<>=]*?(\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+)(?:\\.([x*]|\\d+))?(?:-([\\da-z\\-]+(?:\\.[\\da-z\\-]+)*))?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\nconst validateAndParse = (version) => {\n    if (typeof version !== 'string') {\n        throw new TypeError('Invalid argument expected string');\n    }\n    const match = version.match(semver);\n    if (!match) {\n        throw new Error(`Invalid argument not valid semver ('${version}' received)`);\n    }\n    match.shift();\n    return match;\n};\nconst isWildcard = (s) => s === '*' || s === 'x' || s === 'X';\nconst tryParse = (v) => {\n    const n = parseInt(v, 10);\n    return isNaN(n) ? v : n;\n};\nconst forceType = (a, b) => typeof a !== typeof b ? [String(a), String(b)] : [a, b];\nconst compareStrings = (a, b) => {\n    if (isWildcard(a) || isWildcard(b))\n        return 0;\n    const [ap, bp] = forceType(tryParse(a), tryParse(b));\n    if (ap > bp)\n        return 1;\n    if (ap < bp)\n        return -1;\n    return 0;\n};\nconst compareSegments = (a, b) => {\n    for (let i = 0; i < Math.max(a.length, b.length); i++) {\n        const r = compareStrings(a[i] || '0', b[i] || '0');\n        if (r !== 0)\n            return r;\n    }\n    return 0;\n};\nconst operatorResMap = {\n    '>': [1],\n    '>=': [0, 1],\n    '=': [0],\n    '<=': [-1, 0],\n    '<': [-1],\n};\nconst allowedOperators = Object.keys(operatorResMap);\nconst assertValidOperator = (op) => {\n    if (typeof op !== 'string') {\n        throw new TypeError(`Invalid operator type, expected string but got ${typeof op}`);\n    }\n    if (allowedOperators.indexOf(op) === -1) {\n        throw new Error(`Invalid operator, expected one of ${allowedOperators.join('|')}`);\n    }\n};\n//# sourceMappingURL=index.js.map","import { compare } from \"compare-versions\";\nimport { _internalApiGetAppInBootstrapData, hooks } from \"./Runtime.js\";\nexport function hasInstalledApp(appId, matchVersion) {\n  // First, check whether the app is in bootstrap already.\n  var app = _internalApiGetAppInBootstrapData(appId);\n  if (!app && hooks !== null && hooks !== void 0 && hooks.checkInstalledApps) {\n    app = hooks.checkInstalledApps.getCheckedApp(appId);\n  }\n  if (!app || app.installStatus === \"running\") {\n    return false;\n  }\n  // Todo: `currentVersion` maybe `\"\"`\n  if (!matchVersion || !app.currentVersion) {\n    return true;\n  }\n  // Valid `matchVersion`:\n  //   >=1.2.3\n  //   >1.2.3\n  //   =1.2.3\n  //   <=1.2.3\n  //   <1.2.3\n  var matches = matchVersion.match(/^([><]=?|=)(.*)$/);\n  try {\n    if (!matches) {\n      throw new TypeError(\"Invalid match version: \".concat(matchVersion));\n    }\n    return compare(app.currentVersion, matches[2], matches[1]);\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error(error);\n  }\n  return false;\n}\n//# sourceMappingURL=hasInstalledApp.js.map","export function getFormStateStore(_ref, using, extraInfo) {\n  var {\n    formStateStoreId,\n    formStateStoreMap\n  } = _ref;\n  if (!formStateStoreId) {\n    throw new Error(\"Using \\\"\".concat(using, \"\\\" outside of form renderer\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\"));\n  }\n  var store = formStateStoreMap.get(formStateStoreId);\n  if (!store) {\n    throw new Error(\"Form state store is not found when using \\\"\".concat(using, \"\\\"\").concat(extraInfo !== null && extraInfo !== void 0 ? extraInfo : \"\", \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  return store;\n}\n//# sourceMappingURL=utils.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { loadBricksImperatively } from \"@next-core/loader\";\nimport { getBrickPackages, hooks } from \"../Runtime.js\";\nvar pool = new Map();\nexport function getProviderBrick(_x) {\n  return _getProviderBrick.apply(this, arguments);\n}\nfunction _getProviderBrick() {\n  _getProviderBrick = _asyncToGenerator(function* (provider) {\n    var _hooks$flowApi;\n    var isFlowApi = hooks === null || hooks === void 0 ? void 0 : (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 ? void 0 : _hooks$flowApi.isFlowApiProvider(provider);\n    if (isFlowApi) {\n      provider = hooks.flowApi.FLOW_API_PROVIDER;\n    }\n    var brick = pool.get(provider);\n    if (brick) {\n      return brick;\n    }\n    if (provider.includes(\"-\") && !customElements.get(provider)) {\n      if (isFlowApi) {\n        hooks.flowApi.registerFlowApiProvider();\n      } else {\n        yield loadBricksImperatively([provider], getBrickPackages());\n        if (!customElements.get(provider)) {\n          throw new Error(\"Provider not defined: \\\"\".concat(provider, \"\\\".\"));\n        }\n      }\n    }\n    brick = document.createElement(provider);\n    pool.set(provider, brick);\n    return brick;\n  });\n  return _getProviderBrick.apply(this, arguments);\n}\n//# sourceMappingURL=getProviderBrick.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { asyncComputeRealValue } from \"../compute/computeRealValue.js\";\nimport { getProviderBrick } from \"./getProviderBrick.js\";\nimport { hooks } from \"../Runtime.js\";\nvar cache = new Map();\nexport function resolveData(_x, _x2, _x3) {\n  return _resolveData.apply(this, arguments);\n}\nfunction _resolveData() {\n  _resolveData = _asyncToGenerator(function* (resolveConf, runtimeContext, options) {\n    var {\n      useProvider,\n      method = \"resolve\",\n      args = [],\n      onReject\n    } = resolveConf;\n    var legacyProvider = resolveConf.provider;\n    if (legacyProvider && !useProvider) {\n      throw new Error(\"You're using \\\"provider: \".concat(legacyProvider, \"\\\" which is dropped in v3, please use \\\"useProvider\\\" instead\"));\n    }\n    var [providerBrick, actualArgs] = yield Promise.all([getProviderBrick(useProvider), asyncComputeRealValue(args, runtimeContext)]);\n    var promise = resolveByProvider(providerBrick, useProvider, method, actualArgs, options, args);\n    var {\n      transform\n    } = resolveConf;\n    var data;\n    try {\n      data = yield promise;\n      // The fetched data and its inner objects should never be *injected* again.\n      // recursiveMarkAsInjected(data);\n    } catch (error) {\n      if (isHandleRejectByTransform(onReject)) {\n        transform = onReject.transform;\n        data = error;\n      } else {\n        throw error;\n      }\n    }\n    if (!transform) {\n      return data;\n    }\n\n    // Keep backward compatibility of string transform.\n    if (typeof transform === \"string\") {\n      return {\n        [transform]: data\n      };\n    }\n    return asyncComputeRealValue(transform, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      data\n    }));\n  });\n  return _resolveData.apply(this, arguments);\n}\nexport function clearResolveCache() {\n  cache.clear();\n}\nexport function resolveByProvider(_x4, _x5, _x6, _x7, _x8, _x9) {\n  return _resolveByProvider.apply(this, arguments);\n}\nfunction _resolveByProvider() {\n  _resolveByProvider = _asyncToGenerator(function* (brick, useProvider, method, args, options, originalArgs) {\n    var cacheKey;\n    try {\n      // `args` may contain circular references, which makes\n      // JSON stringify failed, thus we fallback to original args.\n      cacheKey = JSON.stringify({\n        useProvider,\n        method,\n        args\n      });\n    } catch (e) {\n      if (!originalArgs) {\n        throw e;\n      }\n      cacheKey = JSON.stringify({\n        useProvider,\n        method,\n        originalArgs\n      });\n    }\n    var promise;\n    if ((options === null || options === void 0 ? void 0 : options.cache) !== \"reload\") {\n      promise = cache.get(cacheKey);\n    }\n    if (!promise) {\n      promise = _asyncToGenerator(function* () {\n        var _hooks$flowApi;\n        var finalArgs = hooks !== null && hooks !== void 0 && (_hooks$flowApi = hooks.flowApi) !== null && _hooks$flowApi !== void 0 && _hooks$flowApi.isFlowApiProvider(useProvider) ? yield hooks.flowApi.getArgsOfFlowApi(useProvider, args, method) : args;\n        return brick.resolve(...finalArgs);\n      })();\n      cache.set(cacheKey, promise);\n    }\n    return promise;\n  });\n  return _resolveByProvider.apply(this, arguments);\n}\nfunction isHandleRejectByTransform(onReject) {\n  return !!(onReject !== null && onReject !== void 0 && onReject.transform);\n}\n//# sourceMappingURL=resolveData.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { cook, preevaluate, shouldAllowRecursiveEvaluations } from \"@next-core/cook\";\nimport { loadProcessorsImperatively } from \"@next-core/loader\";\nimport { supply } from \"@next-core/supply\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage, collectAppGetMenuUsage, collectInstalledAppsHasUsage } from \"@next-core/utils/storyboard\";\nimport { cloneDeep, omit } from \"lodash\";\nimport { customProcessors } from \"../../CustomProcessors.js\";\nimport { checkPermissionsUsage, storyboardFunctions } from \"./StoryboardFunctions.js\";\nimport { getGeneralGlobals } from \"./getGeneralGlobals.js\";\nimport { getDynamicReadOnlyProxy, getReadOnlyProxy } from \"../proxyFactories.js\";\nimport { getDevHook } from \"../devtools.js\";\nimport { getMedia } from \"../mediaQuery.js\";\nimport { getStorageItem } from \"./getStorageItem.js\";\nimport { _internalApiGetStoryboardInBootstrapData, getBrickPackages, getRuntime, hooks } from \"../Runtime.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { widgetFunctions } from \"./WidgetFunctions.js\";\nimport { widgetI18nFactory } from \"./WidgetI18n.js\";\nimport { widgetImagesFactory } from \"./images.js\";\nimport { hasInstalledApp } from \"../hasInstalledApp.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../../isStrictMode.js\";\nimport { getFormStateStore } from \"../FormRenderer/utils.js\";\nimport { resolveData } from \"../data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./computeRealValue.js\";\nvar symbolForRaw = Symbol.for(\"pre.evaluated.raw\");\nvar symbolForContext = Symbol.for(\"pre.evaluated.context\");\nexport function isPreEvaluated(raw) {\n  return !!(raw !== null && raw !== void 0 && raw[symbolForRaw]);\n}\nexport function getPreEvaluatedRaw(pre) {\n  return pre[symbolForRaw];\n}\nexport function shouldDismissMarkingComputed(raw) {\n  if (typeof raw === \"string\") {\n    return shouldAllowRecursiveEvaluations(raw);\n  }\n  return shouldAllowRecursiveEvaluations(raw[symbolForRaw]);\n}\nvar possibleErrorConstructs = new WeakSet([SyntaxError, TypeError, ReferenceError]);\nexport function getCookErrorConstructor(error) {\n  return possibleErrorConstructs.has(error.constructor) ? error.constructor : TypeError;\n}\nexport function asyncEvaluate(_x, _x2, _x3) {\n  return _asyncEvaluate.apply(this, arguments);\n}\nfunction _asyncEvaluate() {\n  _asyncEvaluate = _asyncToGenerator(function* (raw,\n  // string or pre-evaluated object.\n  runtimeContext, options) {\n    var {\n      blockingList,\n      run\n    } = lowLevelEvaluate(raw, runtimeContext, options, true);\n    yield Promise.all(blockingList);\n    return run();\n  });\n  return _asyncEvaluate.apply(this, arguments);\n}\nexport function evaluate(raw,\n// string or pre-evaluated object.\nruntimeContext, options) {\n  var {\n    run\n  } = lowLevelEvaluate(raw, runtimeContext, options, false);\n  return run();\n}\nfunction lowLevelEvaluate(raw,\n// string or pre-evaluated object.\nruntimeContext) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var isAsync = arguments.length > 3 ? arguments[3] : undefined;\n  var blockingList = [];\n  if (typeof raw !== \"string\") {\n    // If the `raw` is not a string, it must be a pre-evaluated object.\n    // Then fulfil the context, and restore the original `raw`.\n\n    var passByRuntimeContext = omit(runtimeContext, [\"pendingPermissionsPreCheck\", \"tplStateStoreMap\", \"tplStateStoreScope\", \"formStateStoreMap\", \"formStateStoreScope\"]);\n    runtimeContext = _objectSpread(_objectSpread({}, raw[symbolForContext]), passByRuntimeContext);\n    raw = raw[symbolForRaw];\n  }\n\n  // Collect `APP.getMenu(...)` usage before evaluating.\n  var menuUsage = {\n    usedArgs: new Set()\n  };\n  var hasAppUsage = {\n    usedArgs: new Set()\n  };\n\n  // A `SyntaxError` maybe thrown.\n  var precooked;\n  try {\n    precooked = preevaluate(raw, {\n      withParent: true,\n      hooks: {\n        beforeVisitGlobal(node, parent) {\n          collectAppGetMenuUsage(menuUsage, node, parent);\n          collectInstalledAppsHasUsage(hasAppUsage, node, parent);\n        }\n      }\n    });\n  } catch (error) {\n    var message = \"\".concat(error.message, \", in \\\"\").concat(raw, \"\\\"\");\n    // if (options.isReEvaluation) {\n    //   devtoolsHookEmit(\"re-evaluation\", {\n    //     id: options.evaluationId,\n    //     detail: { raw, context: {} },\n    //     error: message,\n    //   });\n    //   return;\n    // } else {\n    var errorConstructor = getCookErrorConstructor(error);\n    throw new errorConstructor(message);\n    // }\n  }\n\n  if (menuUsage.hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \\\"APP.getMenu\\\" is prohibited in v3, check your expression: \\\"\".concat(raw, \"\\\"\"));\n  }\n  if (hasAppUsage.hasNonStaticUsage) {\n    throw new Error(\"Non-static usage of \\\"INSTALLED_APPS.has\\\" is prohibited in v3, check your expression: \\\"\".concat(raw, \"\\\"\"));\n  }\n  var globalVariables = {};\n  var {\n    attemptToVisitGlobals\n  } = precooked;\n\n  // Ignore evaluating if required `event/DATA` is missing in\n  // context. Since they are are provided in different context, whenever\n  // missing one of them, memorize the current context for later consuming.\n  if (options.lazy || attemptToVisitGlobals.has(\"EVENT\") && !hasOwnProperty(runtimeContext, \"event\") || attemptToVisitGlobals.has(\"DATA\") && !hasOwnProperty(runtimeContext, \"data\")) {\n    return {\n      blockingList,\n      run() {\n        return Object.keys(runtimeContext).length > 0 ? {\n          [symbolForRaw]: raw,\n          [symbolForContext]: runtimeContext\n        } : raw;\n      }\n    };\n  }\n  var usedCtx;\n  var usedProcessors;\n  var usedStates;\n  var tplStateStore;\n  var strict = isStrictMode(runtimeContext);\n\n  // For existed TPL usage, treat it as a STATE.\n  if (attemptToVisitGlobals.has(\"STATE\") || !strict && attemptToVisitGlobals.has(\"TPL\")) {\n    tplStateStore = getTplStateStore(runtimeContext, \"STATE\", \": \\\"\".concat(raw, \"\\\"\"));\n  }\n  var usedFormStates;\n  var formStateStore;\n  if (attemptToVisitGlobals.has(\"FORM_STATE\")) {\n    formStateStore = getFormStateStore(runtimeContext, \"FORM_STATE\", \": \\\"\".concat(raw, \"\\\"\"));\n  }\n  var devHook = getDevHook();\n  if (isAsync || devHook) {\n    if (attemptToVisitGlobals.has(\"CTX\")) {\n      usedCtx = strictCollectMemberUsage(raw, \"CTX\");\n      isAsync && blockingList.push(runtimeContext.ctxStore.waitFor(usedCtx));\n    }\n    if (tplStateStore) {\n      usedStates = strictCollectMemberUsage(raw, \"STATE\");\n      // istanbul ignore if\n      if (!strict) {\n        var usedTpls = strictCollectMemberUsage(raw, \"TPL\");\n        for (var tpl of usedTpls) {\n          usedStates.add(tpl);\n        }\n      }\n      isAsync && blockingList.push(tplStateStore.waitFor(usedStates));\n    }\n    if (formStateStore) {\n      usedFormStates = strictCollectMemberUsage(raw, \"FORM_STATE\");\n      isAsync && blockingList.push(formStateStore.waitFor(usedFormStates));\n    }\n    if (attemptToVisitGlobals.has(\"PROCESSORS\")) {\n      usedProcessors = strictCollectMemberUsage(raw, \"PROCESSORS\", 2);\n      isAsync && blockingList.push(loadProcessorsImperatively(usedProcessors, getBrickPackages()));\n    }\n  }\n  if (isAsync) {\n    var attemptToCheckPermissions = attemptToVisitGlobals.has(\"PERMISSIONS\");\n    // There maybe `PERMISSIONS.check()` usage in functions\n    if (!attemptToCheckPermissions && attemptToVisitGlobals.has(\"FN\")) {\n      var usedFunctions = [...strictCollectMemberUsage(raw, \"FN\")];\n      attemptToCheckPermissions = checkPermissionsUsage(usedFunctions);\n    }\n    if (attemptToCheckPermissions) {\n      blockingList.push(...runtimeContext.pendingPermissionsPreCheck);\n    }\n    if (menuUsage.usedArgs.size > 0 && hooks !== null && hooks !== void 0 && hooks.menu) {\n      // Block evaluating if has `APP.getMenu(...)` usage.\n      var usedMenuIds = [...menuUsage.usedArgs];\n      blockingList.push(Promise.all(usedMenuIds.map(menuId => hooks.menu.fetchMenuById(menuId, runtimeContext, {\n        getStoryboardByAppId: _internalApiGetStoryboardInBootstrapData,\n        resolveData,\n        asyncComputeRealValue\n      }))));\n    }\n    if (hasAppUsage.usedArgs.size > 0) {\n      var _hooks$checkInstalled;\n      // Only wait for specific apps\n      blockingList.push(hooks === null || hooks === void 0 ? void 0 : (_hooks$checkInstalled = hooks.checkInstalledApps) === null || _hooks$checkInstalled === void 0 ? void 0 : _hooks$checkInstalled.waitForCheckingApps([...hasAppUsage.usedArgs]));\n    }\n  }\n  return {\n    blockingList,\n    run() {\n      var _runtimeContext$overr, _hooks$menu, _match$params;\n      var {\n        app: currentApp,\n        location,\n        query,\n        match,\n        flags,\n        sys,\n        ctxStore,\n        data,\n        event\n      } = runtimeContext;\n      var app = (_runtimeContext$overr = runtimeContext.overrideApp) !== null && _runtimeContext$overr !== void 0 ? _runtimeContext$overr : currentApp;\n      for (var variableName of attemptToVisitGlobals) {\n        switch (variableName) {\n          // case \"ALIAS\":\n          case \"ANCHOR\":\n            globalVariables[variableName] = location.hash ? location.hash.substring(1) : null;\n            break;\n          case \"APP\":\n            globalVariables[variableName] = _objectSpread(_objectSpread({}, cloneDeep(app)), {}, {\n              getMenu: hooks === null || hooks === void 0 ? void 0 : (_hooks$menu = hooks.menu) === null || _hooks$menu === void 0 ? void 0 : _hooks$menu.getMenuById\n            });\n            break;\n          case \"CTX\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return ctxStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedCtx);\n              }\n            });\n            break;\n          case \"DATA\":\n            globalVariables[variableName] = data;\n            break;\n          case \"EVENT\":\n            globalVariables[variableName] = event;\n            break;\n          case \"FLAGS\":\n            globalVariables[variableName] = getReadOnlyProxy(flags);\n            break;\n          case \"FORM_STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return formStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedFormStates);\n              }\n            });\n            break;\n          case \"HASH\":\n            globalVariables[variableName] = location.hash;\n            break;\n          case \"INSTALLED_APPS\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              has: hasInstalledApp\n            });\n            break;\n          case \"ITEM\":\n            if (!hasOwnProperty(runtimeContext, \"forEachItem\")) {\n              // eslint-disable-next-line no-console\n              console.error(\"Using `ITEM` but no `:forEach` is found, check your expression: \\\"\".concat(raw, \"\\\"\"));\n            } else {\n              globalVariables[variableName] = runtimeContext.forEachItem;\n            }\n            break;\n          case \"LOCAL_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"local\")\n            });\n            break;\n          case \"MEDIA\":\n            globalVariables[variableName] = getReadOnlyProxy(getMedia());\n            break;\n          case \"MISC\":\n            globalVariables[variableName] = getRuntime().getMiscSettings();\n            break;\n          case \"PARAMS\":\n            globalVariables[variableName] = new URLSearchParams(query);\n            break;\n          case \"PATH\":\n            globalVariables[variableName] = getReadOnlyProxy((_match$params = match === null || match === void 0 ? void 0 : match.params) !== null && _match$params !== void 0 ? _match$params : {});\n            break;\n          case \"PATH_NAME\":\n            globalVariables[variableName] = location.pathname;\n            break;\n          case \"PROCESSORS\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                var pkg = customProcessors.get(key);\n                if (!pkg) {\n                  throw new Error(\"'PROCESSORS.\".concat(key, \"' is not registered! Have you installed the relevant brick package?\"));\n                }\n                return getDynamicReadOnlyProxy({\n                  get(t, k) {\n                    return pkg.get(k);\n                  },\n                  ownKeys() {\n                    return Array.from(pkg.keys());\n                  }\n                });\n              },\n              ownKeys() {\n                return Array.from(usedProcessors);\n              }\n            });\n            break;\n          case \"QUERY\":\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.get(key)]));\n            break;\n          case \"QUERY_ARRAY\":\n            globalVariables[variableName] = Object.fromEntries(Array.from(query.keys()).map(key => [key, query.getAll(key)]));\n            // case \"SEGUE\":\n            break;\n          case \"SESSION_STORAGE\":\n            globalVariables[variableName] = getReadOnlyProxy({\n              getItem: getStorageItem(\"session\")\n            });\n            break;\n          // istanbul ignore next\n          case \"TPL\":\n            warnAboutStrictMode(strict, 'Using \"TPL\" in expression', \"check your expression: \\\"\".concat(raw, \"\\\"\"));\n            if (strict) {\n              break;\n            }\n          // eslint-disable-next-line no-fallthrough\n          case \"STATE\":\n            globalVariables[variableName] = getDynamicReadOnlyProxy({\n              get(target, key) {\n                return tplStateStore.getValue(key);\n              },\n              ownKeys() {\n                return Array.from(usedStates);\n              }\n            });\n            break;\n          case \"SYS\":\n            globalVariables[variableName] = getReadOnlyProxy(sys !== null && sys !== void 0 ? sys : {});\n            break;\n          case \"__WIDGET_FN__\":\n            globalVariables[variableName] = widgetFunctions;\n            break;\n          case \"__WIDGET_IMG__\":\n            globalVariables[variableName] = widgetImagesFactory;\n            break;\n          case \"__WIDGET_I18N__\":\n            globalVariables[variableName] = widgetI18nFactory;\n            break;\n        }\n      }\n      Object.assign(globalVariables, getGeneralGlobals(precooked.attemptToVisitGlobals, {\n        storyboardFunctions,\n        app: runtimeContext.app,\n        appendI18nNamespace: runtimeContext.appendI18nNamespace\n      }));\n      try {\n        var result = cook(precooked.expression, precooked.source, {\n          globalVariables: supply(precooked.attemptToVisitGlobals, globalVariables)\n        });\n        // const detail = { raw, context: globalVariables, result };\n        // if (options.isReEvaluation) {\n        //   devtoolsHookEmit(\"re-evaluation\", {\n        //     id: options.evaluationId,\n        //     detail,\n        //   });\n        // } else {\n        //   devtoolsHookEmit(\"evaluation\", detail);\n        // }\n        return result;\n      } catch (error) {\n        var _message = \"\".concat(error.message, \", in \\\"\").concat(raw, \"\\\"\");\n        // if (options.isReEvaluation) {\n        //   devtoolsHookEmit(\"re-evaluation\", {\n        //     id: options.evaluationId,\n        //     detail: { raw, context: globalVariables },\n        //     error: message,\n        //   });\n        // } else {\n        var _errorConstructor = getCookErrorConstructor(error);\n        throw new _errorConstructor(_message);\n        // }\n      }\n    }\n  };\n}\n//# sourceMappingURL=evaluate.js.map","export var StateOfUseBrick = /*#__PURE__*/function (StateOfUseBrick) {\n  StateOfUseBrick[StateOfUseBrick[\"INITIAL\"] = 0] = \"INITIAL\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK\"] = 1] = \"USE_BRICK\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_ITEM\"] = 2] = \"USE_BRICK_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_PROPERTIES\"] = 3] = \"USE_BRICK_PROPERTIES\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_TRANSFORM\"] = 4] = \"USE_BRICK_TRANSFORM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_EVENTS\"] = 5] = \"USE_BRICK_EVENTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_IF\"] = 6] = \"USE_BRICK_IF\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS\"] = 7] = \"USE_BRICK_SLOTS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM\"] = 8] = \"USE_BRICK_SLOTS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS\"] = 9] = \"USE_BRICK_SLOTS_ITEM_BRICKS\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\"] = 10] = \"USE_BRICK_SLOTS_ITEM_BRICKS_ITEM\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_LIFECYCLE\"] = 11] = \"USE_BRICK_LIFECYCLE\";\n  StateOfUseBrick[StateOfUseBrick[\"USE_BRICK_DATA_SOURCE\"] = 12] = \"USE_BRICK_DATA_SOURCE\";\n  return StateOfUseBrick;\n}({});\nexport function isLazyContentInUseBrick(state) {\n  switch (state) {\n    case StateOfUseBrick.USE_BRICK_PROPERTIES:\n    case StateOfUseBrick.USE_BRICK_TRANSFORM:\n    case StateOfUseBrick.USE_BRICK_EVENTS:\n    case StateOfUseBrick.USE_BRICK_IF:\n    case StateOfUseBrick.USE_BRICK_LIFECYCLE:\n    case StateOfUseBrick.USE_BRICK_DATA_SOURCE:\n      return true;\n  }\n  return false;\n}\nexport function getNextStateOfUseBrick(state, isArray, key) {\n  if (isLazyContentInUseBrick(state)) {\n    return state;\n  }\n  if (isArray) {\n    switch (state) {\n      case StateOfUseBrick.USE_BRICK:\n        return StateOfUseBrick.USE_BRICK_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM;\n    }\n  } else {\n    switch (state) {\n      case StateOfUseBrick.INITIAL:\n        if (key === \"useBrick\") {\n          return StateOfUseBrick.USE_BRICK;\n        }\n        break;\n      case StateOfUseBrick.USE_BRICK:\n      case StateOfUseBrick.USE_BRICK_ITEM:\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS_ITEM:\n        {\n          switch (key) {\n            case \"properties\":\n              return StateOfUseBrick.USE_BRICK_PROPERTIES;\n            case \"transform\":\n              return StateOfUseBrick.USE_BRICK_TRANSFORM;\n            case \"dataSource\":\n              return StateOfUseBrick.USE_BRICK_DATA_SOURCE;\n            case \"events\":\n              return StateOfUseBrick.USE_BRICK_EVENTS;\n            case \"slots\":\n              return StateOfUseBrick.USE_BRICK_SLOTS;\n            case \"children\":\n              return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n            case \"if\":\n              return StateOfUseBrick.USE_BRICK_IF;\n            case \"lifeCycle\":\n              return StateOfUseBrick.USE_BRICK_LIFECYCLE;\n          }\n          break;\n        }\n      case StateOfUseBrick.USE_BRICK_SLOTS:\n        return StateOfUseBrick.USE_BRICK_SLOTS_ITEM;\n      case StateOfUseBrick.USE_BRICK_SLOTS_ITEM:\n        if (key === \"bricks\") {\n          return StateOfUseBrick.USE_BRICK_SLOTS_ITEM_BRICKS;\n        }\n        break;\n    }\n  }\n  return StateOfUseBrick.INITIAL;\n}\n//# sourceMappingURL=getNextStateOfUseBrick.js.map","import { isObject } from \"@next-core/utils/general\";\nvar computed = new WeakSet();\n\n// The computed (or transformed) result should never be *computed* again.\n// So does the fetched data from a remote api.\nexport function markAsComputed(value) {\n  if (isObject(value)) {\n    if (!hasBeenComputed(value)) {\n      computed.add(value);\n      if (Array.isArray(value)) {\n        value.forEach(markAsComputed);\n      } else {\n        // Only mark pure objects.\n        var proto = Object.getPrototypeOf(value);\n        if (!proto || proto.constructor === Object) {\n          Object.values(value).forEach(markAsComputed);\n        }\n      }\n    }\n  }\n}\nexport function hasBeenComputed(object) {\n  return computed.has(object);\n}\nexport function resetAllComputedMarks() {\n  computed = new WeakSet();\n}\n//# sourceMappingURL=markAsComputed.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isEvaluable } from \"@next-core/cook\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { transformAndInject, transform, inject } from \"@next-core/inject\";\nimport { asyncEvaluate, isPreEvaluated, evaluate, shouldDismissMarkingComputed } from \"./evaluate.js\";\nimport { getNextStateOfUseBrick, isLazyContentInUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { hasBeenComputed, markAsComputed } from \"./markAsComputed.js\";\nexport function asyncComputeRealValue(_x, _x2) {\n  return _asyncComputeRealValue.apply(this, arguments);\n}\nfunction _asyncComputeRealValue() {\n  _asyncComputeRealValue = _asyncToGenerator(function* (value, runtimeContext) {\n    var internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    var preEvaluated = isPreEvaluated(value);\n    if (preEvaluated || typeof value === \"string\") {\n      // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n      // are kept and to be evaluated later.\n      var lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n      var result;\n      var dismissMarkingComputed = lazy;\n      if (preEvaluated || isEvaluable(value)) {\n        result = yield asyncEvaluate(value, runtimeContext, {\n          lazy\n        });\n        dismissMarkingComputed = shouldDismissMarkingComputed(value);\n      } else {\n        result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n      }\n      if (!dismissMarkingComputed) {\n        markAsComputed(result);\n      }\n      return result;\n    }\n    if (!isObject(value) || hasBeenComputed(value)) {\n      return value;\n    }\n    if (Array.isArray(value)) {\n      var nextOptions = getNextComputeOptions(internalOptions, true);\n      return Promise.all(value.map(v => asyncComputeRealValue(v, runtimeContext, nextOptions)));\n    }\n    return Object.fromEntries((yield Promise.all(Object.entries(value).map(_ref2 => {\n      var [k, v] = _ref2;\n      return Promise.all([asyncComputeRealValue(k, runtimeContext), asyncComputeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))]);\n    }))).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n  });\n  return _asyncComputeRealValue.apply(this, arguments);\n}\nexport function computeRealValue(value, runtimeContext) {\n  var internalOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var preEvaluated = isPreEvaluated(value);\n  if (preEvaluated || typeof value === \"string\") {\n    // For `useBrick`, some fields such as `properties`/`transform`/`events`/`if`,\n    // are kept and to be evaluated later.\n    var lazy = internalOptions.$$lazyForUseBrick && isLazyContentInUseBrick(internalOptions.$$stateOfUseBrick);\n    var result;\n    var dismissMarkingComputed = lazy;\n    if (preEvaluated || isEvaluable(value)) {\n      result = evaluate(value, runtimeContext);\n      dismissMarkingComputed = shouldDismissMarkingComputed(value);\n    } else {\n      result = lazy ? value : (hasOwnProperty(runtimeContext, \"data\") ? internalOptions.noInject ? transform : transformAndInject : internalOptions.noInject ? identity : inject)(value, runtimeContext);\n    }\n    if (!dismissMarkingComputed) {\n      markAsComputed(result);\n    }\n    return result;\n  }\n  if (!isObject(value) || hasBeenComputed(value)) {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    var nextOptions = getNextComputeOptions(internalOptions, true);\n    return value.map(v => computeRealValue(v, runtimeContext, nextOptions));\n  }\n  return Object.fromEntries(Object.entries(value).map(_ref => {\n    var [k, v] = _ref;\n    return [computeRealValue(k, runtimeContext), computeRealValue(v, runtimeContext, getNextComputeOptions(internalOptions, false, k))];\n  }).concat(internalOptions.ignoreSymbols ? [] : Object.getOwnPropertySymbols(value).map(k => [k, value[k]])));\n}\nfunction getNextComputeOptions(internalOptions, isArray, key) {\n  return internalOptions.$$lazyForUseBrick ? _objectSpread(_objectSpread({}, internalOptions), {}, {\n    $$stateOfUseBrick: getNextStateOfUseBrick(internalOptions.$$stateOfUseBrick, isArray, key)\n  }) : internalOptions;\n}\nfunction identity(value) {\n  return value;\n}\n//# sourceMappingURL=computeRealValue.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { isPreEvaluated } from \"./evaluate.js\";\nimport { resolveData } from \"../data/resolveData.js\";\n\n/**\n * 包含 `if` 条件判断的对象。\n */\n\nexport function asyncCheckIf(_x, _x2) {\n  return _asyncCheckIf.apply(this, arguments);\n}\nfunction _asyncCheckIf() {\n  _asyncCheckIf = _asyncToGenerator(function* (ifContainer, runtimeContext) {\n    return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? yield asyncComputeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n  });\n  return _asyncCheckIf.apply(this, arguments);\n}\nexport function checkIf(ifContainer, runtimeContext) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!(typeof ifContainer.if === \"string\" || isPreEvaluated(ifContainer.if) ? computeRealValue(ifContainer.if, runtimeContext) : ifContainer.if);\n}\nexport function checkIfOfComputed(ifContainer) {\n  return !hasOwnProperty(ifContainer, \"if\") || !!ifContainer.if;\n}\nexport function asyncCheckBrickIf(_x3, _x4) {\n  return _asyncCheckBrickIf.apply(this, arguments);\n}\nfunction _asyncCheckBrickIf() {\n  _asyncCheckBrickIf = _asyncToGenerator(function* (brickConf, runtimeContext) {\n    if (isObject(brickConf.if) && !isPreEvaluated(brickConf.if)) {\n      var resolved = yield resolveData(brickConf.if, runtimeContext);\n      return checkIfOfComputed(resolved);\n    }\n    return asyncCheckIf(brickConf, runtimeContext);\n  });\n  return _asyncCheckBrickIf.apply(this, arguments);\n}\nexport function checkIfByTransform(ifContainer, data) {\n  return checkIf(ifContainer, {\n    data\n  });\n}\n//# sourceMappingURL=checkIf.js.map","import { isEvaluable, isTrackAll } from \"@next-core/cook\";\nimport { track, trackAll } from \"@next-core/utils/storyboard\";\nimport { getPreEvaluatedRaw, isPreEvaluated } from \"./evaluate.js\";\nexport function getTracks(value) {\n  var contextNames = false;\n  var stateNames = false;\n  var formStateNames = false;\n  if (typeof value === \"string\" ? isEvaluable(value) : isPreEvaluated(value)) {\n    var raw = typeof value === \"string\" ? value : getPreEvaluatedRaw(value);\n    if (isTrackAll(raw)) {\n      var result = trackAll(raw);\n      if (result) {\n        contextNames = result.context;\n        stateNames = result.state;\n        formStateNames = result.formState;\n      }\n    } else {\n      contextNames = track(raw, \"track context\", \"CTX\");\n      stateNames = track(raw, \"track state\", \"STATE\");\n      formStateNames = track(raw, \"track formstate\", \"FORM_STATE\");\n    }\n  }\n  return {\n    contextNames,\n    stateNames,\n    formStateNames\n  };\n}\n//# sourceMappingURL=getTracks.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { asyncComputeRealValue, computeRealValue } from \"./computeRealValue.js\";\nimport { StateOfUseBrick } from \"./getNextStateOfUseBrick.js\";\nimport { getTracks } from \"./getTracks.js\";\nexport function asyncComputeRealProperties(_x, _x2, _x3) {\n  return _asyncComputeRealProperties.apply(this, arguments);\n}\nfunction _asyncComputeRealProperties() {\n  _asyncComputeRealProperties = _asyncToGenerator(function* (properties, runtimeContext, trackingContextList) {\n    if (isObject(properties)) {\n      return Object.fromEntries((yield Promise.all(Object.entries(properties).map( /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator(function* (_ref2) {\n          var [propName, propValue] = _ref2;\n          if (Array.isArray(trackingContextList)) {\n            var {\n              contextNames,\n              stateNames,\n              formStateNames\n            } = getTracks(propValue);\n            if (contextNames || stateNames || formStateNames) {\n              trackingContextList.push({\n                contextNames,\n                stateNames,\n                formStateNames,\n                propName,\n                propValue\n              });\n            }\n          }\n          // Related: https://github.com/facebook/react/issues/11347\n          var realValue = yield asyncComputeRealValue(propValue, runtimeContext, {\n            $$lazyForUseBrick: true,\n            $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n          });\n          // For `style` and `dataset`, only object is acceptable.\n          if (propName !== \"style\" && propName !== \"dataset\" || isObject(realValue)) {\n            return [propName, realValue];\n          }\n        });\n        return function (_x4) {\n          return _ref3.apply(this, arguments);\n        };\n      }()))).filter(Boolean));\n    }\n    return {};\n  });\n  return _asyncComputeRealProperties.apply(this, arguments);\n}\nexport function computeRealProperties(properties, runtimeContext, trackingContextList) {\n  if (isObject(properties)) {\n    return Object.fromEntries(Object.entries(properties).map(_ref => {\n      var [propName, propValue] = _ref;\n      if (Array.isArray(trackingContextList)) {\n        var {\n          contextNames,\n          stateNames,\n          formStateNames\n        } = getTracks(propValue);\n        if (contextNames || stateNames || formStateNames) {\n          trackingContextList.push({\n            contextNames,\n            stateNames,\n            formStateNames,\n            propName,\n            propValue\n          });\n        }\n      }\n      // Related: https://github.com/facebook/react/issues/11347\n      var realValue = computeRealValue(propValue, runtimeContext, {\n        $$lazyForUseBrick: true,\n        $$stateOfUseBrick: propName === \"useBrick\" ? StateOfUseBrick.USE_BRICK : StateOfUseBrick.INITIAL\n      });\n      // For `style` and `dataset`, only object is acceptable.\n      if (propName !== \"style\" && propName !== \"dataset\" || isObject(realValue)) {\n        return [propName, realValue];\n      }\n    }).filter(Boolean));\n  }\n  return {};\n}\n//# sourceMappingURL=computeRealProperties.js.map","export function setRealProperties(brick, realProps) {\n  if (!realProps) {\n    return;\n  }\n  for (var [propName, propValue] of Object.entries(realProps)) {\n    switch (propName) {\n      case \"style\":\n      case \"dataset\":\n        for (var [k, v] of Object.entries(propValue)) {\n          brick[propName][k] = v;\n        }\n        break;\n      case \"constructor\":\n      case \"__proto__\":\n      case \"innerHTML\":\n        // `innerHTML` is dangerous, use `textContent` instead.\n        throw new Error(\"set `\".concat(propName, \"` is prohibited\"));\n      default:\n        brick[propName] = propValue;\n    }\n  }\n}\n//# sourceMappingURL=setRealProperties.js.map","import { computeRealProperties } from \"./computeRealProperties.js\";\nimport { setRealProperties } from \"./setRealProperties.js\";\nexport function setProperties(bricks, properties, runtimeContext) {\n  var realProps = computeRealProperties(properties, runtimeContext);\n  if (!Array.isArray(bricks)) {\n    bricks = [bricks];\n  }\n  bricks.forEach(brick => {\n    setRealProperties(brick, realProps);\n  });\n}\n//# sourceMappingURL=setProperties.js.map","/**\n * Tokenize input string.\n */\nfunction lexer(str) {\n    var tokens = [];\n    var i = 0;\n    while (i < str.length) {\n        var char = str[i];\n        if (char === \"*\" || char === \"+\" || char === \"?\") {\n            tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"\\\\\") {\n            tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n            continue;\n        }\n        if (char === \"{\") {\n            tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"}\") {\n            tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \":\") {\n            var name = \"\";\n            var j = i + 1;\n            while (j < str.length) {\n                var code = str.charCodeAt(j);\n                if (\n                // `0-9`\n                (code >= 48 && code <= 57) ||\n                    // `A-Z`\n                    (code >= 65 && code <= 90) ||\n                    // `a-z`\n                    (code >= 97 && code <= 122) ||\n                    // `_`\n                    code === 95) {\n                    name += str[j++];\n                    continue;\n                }\n                break;\n            }\n            if (!name)\n                throw new TypeError(\"Missing parameter name at \".concat(i));\n            tokens.push({ type: \"NAME\", index: i, value: name });\n            i = j;\n            continue;\n        }\n        if (char === \"(\") {\n            var count = 1;\n            var pattern = \"\";\n            var j = i + 1;\n            if (str[j] === \"?\") {\n                throw new TypeError(\"Pattern cannot start with \\\"?\\\" at \".concat(j));\n            }\n            while (j < str.length) {\n                if (str[j] === \"\\\\\") {\n                    pattern += str[j++] + str[j++];\n                    continue;\n                }\n                if (str[j] === \")\") {\n                    count--;\n                    if (count === 0) {\n                        j++;\n                        break;\n                    }\n                }\n                else if (str[j] === \"(\") {\n                    count++;\n                    if (str[j + 1] !== \"?\") {\n                        throw new TypeError(\"Capturing groups are not allowed at \".concat(j));\n                    }\n                }\n                pattern += str[j++];\n            }\n            if (count)\n                throw new TypeError(\"Unbalanced pattern at \".concat(i));\n            if (!pattern)\n                throw new TypeError(\"Missing pattern at \".concat(i));\n            tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n            i = j;\n            continue;\n        }\n        tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n    }\n    tokens.push({ type: \"END\", index: i, value: \"\" });\n    return tokens;\n}\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str, options) {\n    if (options === void 0) { options = {}; }\n    var tokens = lexer(str);\n    var _a = options.prefixes, prefixes = _a === void 0 ? \"./\" : _a;\n    var defaultPattern = \"[^\".concat(escapeString(options.delimiter || \"/#?\"), \"]+?\");\n    var result = [];\n    var key = 0;\n    var i = 0;\n    var path = \"\";\n    var tryConsume = function (type) {\n        if (i < tokens.length && tokens[i].type === type)\n            return tokens[i++].value;\n    };\n    var mustConsume = function (type) {\n        var value = tryConsume(type);\n        if (value !== undefined)\n            return value;\n        var _a = tokens[i], nextType = _a.type, index = _a.index;\n        throw new TypeError(\"Unexpected \".concat(nextType, \" at \").concat(index, \", expected \").concat(type));\n    };\n    var consumeText = function () {\n        var result = \"\";\n        var value;\n        while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n            result += value;\n        }\n        return result;\n    };\n    while (i < tokens.length) {\n        var char = tryConsume(\"CHAR\");\n        var name = tryConsume(\"NAME\");\n        var pattern = tryConsume(\"PATTERN\");\n        if (name || pattern) {\n            var prefix = char || \"\";\n            if (prefixes.indexOf(prefix) === -1) {\n                path += prefix;\n                prefix = \"\";\n            }\n            if (path) {\n                result.push(path);\n                path = \"\";\n            }\n            result.push({\n                name: name || key++,\n                prefix: prefix,\n                suffix: \"\",\n                pattern: pattern || defaultPattern,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        var value = char || tryConsume(\"ESCAPED_CHAR\");\n        if (value) {\n            path += value;\n            continue;\n        }\n        if (path) {\n            result.push(path);\n            path = \"\";\n        }\n        var open = tryConsume(\"OPEN\");\n        if (open) {\n            var prefix = consumeText();\n            var name_1 = tryConsume(\"NAME\") || \"\";\n            var pattern_1 = tryConsume(\"PATTERN\") || \"\";\n            var suffix = consumeText();\n            mustConsume(\"CLOSE\");\n            result.push({\n                name: name_1 || (pattern_1 ? key++ : \"\"),\n                pattern: name_1 && !pattern_1 ? defaultPattern : pattern_1,\n                prefix: prefix,\n                suffix: suffix,\n                modifier: tryConsume(\"MODIFIER\") || \"\",\n            });\n            continue;\n        }\n        mustConsume(\"END\");\n    }\n    return result;\n}\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile(str, options) {\n    return tokensToFunction(parse(str, options), options);\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction(tokens, options) {\n    if (options === void 0) { options = {}; }\n    var reFlags = flags(options);\n    var _a = options.encode, encode = _a === void 0 ? function (x) { return x; } : _a, _b = options.validate, validate = _b === void 0 ? true : _b;\n    // Compile all the tokens into regexps.\n    var matches = tokens.map(function (token) {\n        if (typeof token === \"object\") {\n            return new RegExp(\"^(?:\".concat(token.pattern, \")$\"), reFlags);\n        }\n    });\n    return function (data) {\n        var path = \"\";\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (typeof token === \"string\") {\n                path += token;\n                continue;\n            }\n            var value = data ? data[token.name] : undefined;\n            var optional = token.modifier === \"?\" || token.modifier === \"*\";\n            var repeat = token.modifier === \"*\" || token.modifier === \"+\";\n            if (Array.isArray(value)) {\n                if (!repeat) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not repeat, but got an array\"));\n                }\n                if (value.length === 0) {\n                    if (optional)\n                        continue;\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to not be empty\"));\n                }\n                for (var j = 0; j < value.length; j++) {\n                    var segment = encode(value[j], token);\n                    if (validate && !matches[i].test(segment)) {\n                        throw new TypeError(\"Expected all \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                    }\n                    path += token.prefix + segment + token.suffix;\n                }\n                continue;\n            }\n            if (typeof value === \"string\" || typeof value === \"number\") {\n                var segment = encode(String(value), token);\n                if (validate && !matches[i].test(segment)) {\n                    throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to match \\\"\").concat(token.pattern, \"\\\", but got \\\"\").concat(segment, \"\\\"\"));\n                }\n                path += token.prefix + segment + token.suffix;\n                continue;\n            }\n            if (optional)\n                continue;\n            var typeOfMessage = repeat ? \"an array\" : \"a string\";\n            throw new TypeError(\"Expected \\\"\".concat(token.name, \"\\\" to be \").concat(typeOfMessage));\n        }\n        return path;\n    };\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match(str, options) {\n    var keys = [];\n    var re = pathToRegexp(str, keys, options);\n    return regexpToFunction(re, keys, options);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction(re, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.decode, decode = _a === void 0 ? function (x) { return x; } : _a;\n    return function (pathname) {\n        var m = re.exec(pathname);\n        if (!m)\n            return false;\n        var path = m[0], index = m.index;\n        var params = Object.create(null);\n        var _loop_1 = function (i) {\n            if (m[i] === undefined)\n                return \"continue\";\n            var key = keys[i - 1];\n            if (key.modifier === \"*\" || key.modifier === \"+\") {\n                params[key.name] = m[i].split(key.prefix + key.suffix).map(function (value) {\n                    return decode(value, key);\n                });\n            }\n            else {\n                params[key.name] = decode(m[i], key);\n            }\n        };\n        for (var i = 1; i < m.length; i++) {\n            _loop_1(i);\n        }\n        return { path: path, index: index, params: params };\n    };\n}\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str) {\n    return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options) {\n    return options && options.sensitive ? \"\" : \"i\";\n}\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path, keys) {\n    if (!keys)\n        return path;\n    var groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n    var index = 0;\n    var execResult = groupsRegex.exec(path.source);\n    while (execResult) {\n        keys.push({\n            // Use parenthesized substring match if available, index otherwise\n            name: execResult[1] || index++,\n            prefix: \"\",\n            suffix: \"\",\n            modifier: \"\",\n            pattern: \"\",\n        });\n        execResult = groupsRegex.exec(path.source);\n    }\n    return path;\n}\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(paths, keys, options) {\n    var parts = paths.map(function (path) { return pathToRegexp(path, keys, options).source; });\n    return new RegExp(\"(?:\".concat(parts.join(\"|\"), \")\"), flags(options));\n}\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(path, keys, options) {\n    return tokensToRegexp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(tokens, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.strict, strict = _a === void 0 ? false : _a, _b = options.start, start = _b === void 0 ? true : _b, _c = options.end, end = _c === void 0 ? true : _c, _d = options.encode, encode = _d === void 0 ? function (x) { return x; } : _d, _e = options.delimiter, delimiter = _e === void 0 ? \"/#?\" : _e, _f = options.endsWith, endsWith = _f === void 0 ? \"\" : _f;\n    var endsWithRe = \"[\".concat(escapeString(endsWith), \"]|$\");\n    var delimiterRe = \"[\".concat(escapeString(delimiter), \"]\");\n    var route = start ? \"^\" : \"\";\n    // Iterate over the tokens and create our regexp string.\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        if (typeof token === \"string\") {\n            route += escapeString(encode(token));\n        }\n        else {\n            var prefix = escapeString(encode(token.prefix));\n            var suffix = escapeString(encode(token.suffix));\n            if (token.pattern) {\n                if (keys)\n                    keys.push(token);\n                if (prefix || suffix) {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        var mod = token.modifier === \"*\" ? \"?\" : \"\";\n                        route += \"(?:\".concat(prefix, \"((?:\").concat(token.pattern, \")(?:\").concat(suffix).concat(prefix, \"(?:\").concat(token.pattern, \"))*)\").concat(suffix, \")\").concat(mod);\n                    }\n                    else {\n                        route += \"(?:\".concat(prefix, \"(\").concat(token.pattern, \")\").concat(suffix, \")\").concat(token.modifier);\n                    }\n                }\n                else {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        route += \"((?:\".concat(token.pattern, \")\").concat(token.modifier, \")\");\n                    }\n                    else {\n                        route += \"(\".concat(token.pattern, \")\").concat(token.modifier);\n                    }\n                }\n            }\n            else {\n                route += \"(?:\".concat(prefix).concat(suffix, \")\").concat(token.modifier);\n            }\n        }\n    }\n    if (end) {\n        if (!strict)\n            route += \"\".concat(delimiterRe, \"?\");\n        route += !options.endsWith ? \"$\" : \"(?=\".concat(endsWithRe, \")\");\n    }\n    else {\n        var endToken = tokens[tokens.length - 1];\n        var isEndDelimited = typeof endToken === \"string\"\n            ? delimiterRe.indexOf(endToken[endToken.length - 1]) > -1\n            : endToken === undefined;\n        if (!strict) {\n            route += \"(?:\".concat(delimiterRe, \"(?=\").concat(endsWithRe, \"))?\");\n        }\n        if (!isEndDelimited) {\n            route += \"(?=\".concat(delimiterRe, \"|\").concat(endsWithRe, \")\");\n        }\n    }\n    return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(path, keys, options) {\n    if (path instanceof RegExp)\n        return regexpToRegexp(path, keys);\n    if (Array.isArray(path))\n        return arrayToRegexp(path, keys, options);\n    return stringToRegexp(path, keys, options);\n}\n//# sourceMappingURL=index.js.map","// Ref https://github.com/ReactTraining/react-router/blob/master/packages/react-router/modules/matchPath.js\n\nimport { pathToRegexp, compile } from \"path-to-regexp\";\nvar cache = new Map();\nvar cacheLimit = 10000;\nvar cacheCount = 0;\nfunction compilePath(path, options) {\n  var cacheKey = \"\".concat(options.end).concat(options.strict).concat(options.sensitive);\n  var pathCache = cache.get(cacheKey);\n  if (!pathCache) {\n    cache.set(cacheKey, pathCache = new Map());\n  }\n  var cacheResult = pathCache.get(path);\n  if (cacheResult) {\n    return cacheResult;\n  }\n  var keys = [];\n  var regexp = pathToRegexp(path, keys, options);\n  var result = {\n    regexp,\n    keys\n  };\n  if (cacheCount < cacheLimit) {\n    pathCache.set(path, result);\n    cacheCount++;\n  }\n  return result;\n}\n\n/**\n * Public API for matching a URL pathname to a path.\n */\nexport function matchPath(pathname, options) {\n  var {\n    path: p,\n    exact = false,\n    strict = false,\n    sensitive = true\n  } = options;\n  var paths = Array.isArray(p) ? p : [p];\n  return paths.reduce((matched, path) => {\n    if (matched) {\n      return matched;\n    }\n    var {\n      regexp,\n      keys\n    } = compilePath(path, {\n      end: exact,\n      strict,\n      sensitive\n    });\n    var match = regexp.exec(pathname);\n    if (!match) {\n      return null;\n    }\n    var [url, ...values] = match;\n    var isExact = pathname === url;\n    if (exact && !isExact) {\n      return null;\n    }\n    var initialParams = {};\n    var result = {\n      path,\n      // the path used to match\n      url: path === \"/\" && url === \"\" ? \"/\" : url,\n      // the matched portion of the URL\n      isExact,\n      // whether or not we matched exactly\n      params: keys.reduce((memo, key, index) => {\n        memo[key.name] = values[index];\n        return memo;\n      }, initialParams)\n    };\n    return result;\n  }, null);\n}\nexport function toPath(path, pathParams) {\n  return compile(path)(pathParams);\n}\n//# sourceMappingURL=matchPath.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { matchPath } from \"./matchPath.js\";\nimport { asyncCheckIf } from \"./compute/checkIf.js\";\nimport { hooks } from \"./Runtime.js\";\nexport function matchRoutes(_x, _x2) {\n  return _matchRoutes.apply(this, arguments);\n}\nfunction _matchRoutes() {\n  _matchRoutes = _asyncToGenerator(function* (routes, runtimeContext) {\n    for (var route of routes) {\n      if (typeof route.path !== \"string\") {\n        // eslint-disable-next-line no-console\n        console.error(\"Invalid route with invalid path:\", route);\n        throw new Error(\"Invalid route with invalid type of path: \".concat(typeof route.path));\n      }\n      var routePath = route.path.replace(/^\\$\\{APP.homepage\\}/, runtimeContext.app.homepage);\n      var match = matchPath(runtimeContext.location.pathname, {\n        path: routePath,\n        exact: route.exact\n      });\n      if (match && (yield asyncCheckIf(route, runtimeContext))) {\n        if (runtimeContext.app.noAuthGuard || route.public || !(hooks !== null && hooks !== void 0 && hooks.auth) || hooks.auth.isLoggedIn()) {\n          return {\n            match,\n            route\n          };\n        }\n        return \"unauthenticated\";\n      }\n    }\n    return \"missed\";\n  });\n  return _matchRoutes.apply(this, arguments);\n}\n//# sourceMappingURL=matchRoutes.js.map","export var symbolForAsyncComputedPropsFromHost = Symbol.for(\"tpl.asyncComputedPropsFromHost\");\nexport var symbolForTplStateStoreId = Symbol.for(\"tpl.stateStoreId\");\nexport var symbolForTPlExternalForEachItem = Symbol.for(\"tpl.externalForEachItem\");\n//# sourceMappingURL=constants.js.map","var brick;\nfunction show(options) {\n  if (brick) {\n    return brick.resolve(options);\n  } else {\n    if (options.type === \"confirm\") {\n      if (confirm(options.content)) {\n        return new Promise(resolve => setTimeout(() => {\n          resolve();\n        }, 1));\n      } else {\n        return new Promise((resolve, reject) => setTimeout(() => {\n          reject();\n        }, 1));\n      }\n    } else {\n      alert(options.content);\n      return new Promise(resolve => setTimeout(() => {\n        resolve();\n      }, 1000));\n    }\n  }\n}\nexport function loadDialogService(tagName, loader) {\n  loader([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load dialog service failed:\", error);\n  });\n}\nexport var Dialog = Object.freeze({\n  show\n});\n//# sourceMappingURL=Dialog.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { _internalApiGetRenderId } from \"./Runtime.js\";\nvar timeoutIdList = new Set();\nexport function startPoll(task, _ref, _ref2) {\n  var {\n    progress,\n    success,\n    error,\n    finally: finallyCallback\n  } = _ref;\n  var {\n    interval,\n    leadingRequestDelay,\n    continueOnError,\n    delegateLoadingBar,\n    expectPollEnd,\n    expectPollStopImmediately\n  } = _ref2;\n  var currentRenderId = _internalApiGetRenderId();\n  var currentTimeoutId;\n  function poll() {\n    return _poll.apply(this, arguments);\n  }\n  function _poll() {\n    _poll = _asyncToGenerator(function* () {\n      timeoutIdList.delete(currentTimeoutId);\n      var shouldStop;\n      try {\n        shouldStop = expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately();\n        // Stop polling immediately when the expectation is match before task.\n        if (!shouldStop) {\n          var _result = yield task();\n          // Stop polling immediately when the expectation is match or a different router\n          // is rendering after the task processed.\n          shouldStop = (expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately()) || currentRenderId !== _internalApiGetRenderId();\n          if (!shouldStop) {\n            progress === null || progress === void 0 ? void 0 : progress(_result);\n            if (expectPollEnd !== null && expectPollEnd !== void 0 && expectPollEnd(_result)) {\n              if (delegateLoadingBar) {\n                window.dispatchEvent(new Event(\"request.end\"));\n              }\n              success === null || success === void 0 ? void 0 : success(_result);\n              finallyCallback === null || finallyCallback === void 0 ? void 0 : finallyCallback();\n            } else {\n              delayedPoll(interval !== null && interval !== void 0 ? interval : 3000);\n            }\n          }\n        }\n      } catch (e) {\n        // Stop polling immediately when the expectation is match or a different router\n        // is rendering after the task processed.\n        shouldStop = (expectPollStopImmediately === null || expectPollStopImmediately === void 0 ? void 0 : expectPollStopImmediately()) || currentRenderId !== _internalApiGetRenderId();\n        if (!shouldStop) {\n          error === null || error === void 0 ? void 0 : error(e);\n          if (continueOnError) {\n            delayedPoll(interval !== null && interval !== void 0 ? interval : 3000);\n          } else {\n            finallyCallback === null || finallyCallback === void 0 ? void 0 : finallyCallback();\n          }\n        }\n      } finally {\n        // Manually dispatch an event of `request.end` when the polling is stopped immediately.\n        if (delegateLoadingBar && shouldStop) {\n          window.dispatchEvent(new Event(\"request.end\"));\n        }\n      }\n    });\n    return _poll.apply(this, arguments);\n  }\n  function delayedPoll(delay) {\n    currentTimeoutId = setTimeout(poll, delay);\n    timeoutIdList.add(currentTimeoutId);\n  }\n  delayedPoll(leadingRequestDelay !== null && leadingRequestDelay !== void 0 ? leadingRequestDelay : 0);\n  if (delegateLoadingBar) {\n    window.dispatchEvent(new Event(\"request.start\"));\n  }\n}\nexport function clearPollTimeout() {\n  for (var timeoutId of timeoutIdList) {\n    clearTimeout(timeoutId);\n  }\n  timeoutIdList.clear();\n}\n//# sourceMappingURL=poll.js.map","export var K = /*#__PURE__*/function (K) {\n  K[\"REQUEST_FAILED\"] = \"REQUEST_FAILED\";\n  K[\"SOMETHING_WENT_WRONG\"] = \"SOMETHING_WENT_WRONG\";\n  K[\"LOGIN_TIMEOUT_MESSAGE\"] = \"LOGIN_TIMEOUT_MESSAGE\";\n  K[\"NETWORK_ERROR\"] = \"NETWORK_ERROR\";\n  return K;\n}({});\nvar en = {\n  [K.REQUEST_FAILED]: \"Request Failed\",\n  [K.SOMETHING_WENT_WRONG]: \"Something went wrong!\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"You haven't logged in or your login session has expired. Login right now?\",\n  [K.NETWORK_ERROR]: \"Network error, please check your network.\"\n};\nvar zh = {\n  [K.REQUEST_FAILED]: \"请求失败\",\n  [K.SOMETHING_WENT_WRONG]: \"出现了一些问题！\",\n  [K.LOGIN_TIMEOUT_MESSAGE]: \"您还未登录或登录信息已过期，现在重新登录？\",\n  [K.NETWORK_ERROR]: \"网络错误，请检查您的网络连接。\"\n};\nexport var NS = \"core/runtime\";\nexport var locales = {\n  en,\n  zh\n};\n//# sourceMappingURL=i18n.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { HttpAbortError, HttpFetchError, HttpResponseError } from \"@next-core/http\";\nimport { i18n } from \"@next-core/i18n\";\nimport { getRuntime } from \"./internal/Runtime.js\";\nimport { getHistory } from \"./history.js\";\nimport { K, NS } from \"./internal/i18n.js\";\nimport { Dialog } from \"./Dialog.js\";\n\n/**\n * 将 http 请求错误转换为可读的字符串。\n *\n * @remarks\n *\n * 将依次尝试读取返回的 JSON 格式数据的字符串类型的 `error` 和 `msg` 字段，如果没有找到则返回 `error.toString()` 的结果。\n *\n * @param error - 错误对象。\n *\n * @returns 转换为字符串的错误信息。\n */\nexport function httpErrorToString(error) {\n  if (error instanceof Event && error.target instanceof HTMLScriptElement) {\n    return error.target.src;\n  }\n  if (error instanceof HttpFetchError) {\n    return i18n.t(\"\".concat(NS, \":\").concat(K.NETWORK_ERROR));\n  }\n  if (error instanceof HttpResponseError) {\n    if (error.responseJson) {\n      if (typeof error.responseJson.error === \"string\") {\n        return error.responseJson.error;\n      } else if (typeof error.responseJson.msg === \"string\") {\n        return error.responseJson.msg;\n      }\n    }\n  }\n  if (error == null) {\n    return \"Unknown error\";\n  }\n  return error.toString();\n}\nexport function isUnauthenticatedError(error) {\n  return error instanceof HttpResponseError && error.response.status === 401 && !!error.responseJson && error.responseJson.code === 100003;\n}\nvar unauthenticatedConfirming = false;\nvar lastErrorMessage;\n\n/**\n * 处理 http 请求错误（使用 AntDesign 模态框弹出错误信息）。\n *\n * @param error - 错误对象。\n */\nexport function handleHttpError(error) {\n  // Do nothing if aborted http requests\n  if (error instanceof HttpAbortError) {\n    return;\n  }\n\n  // Redirect to login page if not logged in.\n  if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n    if (unauthenticatedConfirming) {\n      return;\n    }\n    unauthenticatedConfirming = true;\n    Dialog.show({\n      type: \"confirm\",\n      content: i18n.t(\"\".concat(NS, \":\").concat(K.LOGIN_TIMEOUT_MESSAGE))\n    }).then(() => {\n      redirectToLogin();\n      unauthenticatedConfirming = false;\n    }, () => {\n      unauthenticatedConfirming = false;\n    });\n    return;\n  }\n\n  // eslint-disable-next-line no-console\n  console.error(error);\n  var message = httpErrorToString(error);\n  if (message !== lastErrorMessage) {\n    lastErrorMessage = message;\n    Dialog.show({\n      type: \"error\",\n      title: i18n.t(\"\".concat(NS, \":\").concat(K.REQUEST_FAILED)),\n      content: message,\n      contentStyle: {\n        whiteSpace: \"pre-wrap\"\n      }\n    }).then(() => {\n      lastErrorMessage = undefined;\n    });\n  }\n  return;\n}\nfunction redirectToLogin() {\n  var ssoEnabled = getRuntime().getFeatureFlags()[\"sso-enabled\"];\n  var history = getHistory();\n  history.push(ssoEnabled ? \"/sso-auth/login\" : \"/auth/login\", {\n    from: _objectSpread(_objectSpread({}, history.location), {}, {\n      state: undefined\n    })\n  });\n}\n//# sourceMappingURL=handleHttpError.js.map","var brick;\nfunction show(options) {\n  if (brick) {\n    brick.resolve(options);\n  } else {\n    alert(options.message);\n  }\n}\nexport function loadNotificationService(tagName, loader) {\n  loader([tagName]).then(() => {\n    brick = document.createElement(tagName);\n  }, error => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load notification service failed:\", error);\n  });\n}\nexport var Notification = Object.freeze({\n  show\n});\n//# sourceMappingURL=Notification.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { isEvaluable } from \"@next-core/cook\";\nimport { isObject } from \"@next-core/utils/general\";\nimport { checkIf } from \"./compute/checkIf.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { getHistory } from \"../history.js\";\nimport { getProviderBrick } from \"./data/getProviderBrick.js\";\nimport { startPoll } from \"./poll.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { setProperties } from \"./compute/setProperties.js\";\nimport { applyMode, applyTheme } from \"../themeAndMode.js\";\nimport { getTplHostElement, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { handleHttpError, httpErrorToString } from \"../handleHttpError.js\";\nimport { Notification } from \"../Notification.js\";\nimport { getFormStateStore } from \"./FormRenderer/utils.js\";\nimport { hooks } from \"./Runtime.js\";\nexport function bindListeners(brick, eventsMap, runtimeContext) {\n  if (!eventsMap) {\n    return;\n  }\n  Object.entries(eventsMap).forEach(_ref => {\n    var [eventType, handlers] = _ref;\n    var listener = listenerFactory(handlers, runtimeContext, {\n      element: brick\n    });\n    brick.addEventListener(eventType, listener);\n\n    // Remember added listeners for unbinding.\n    if (!brick.$$listeners) {\n      brick.$$listeners = [];\n    }\n    brick.$$listeners.push([eventType, listener]);\n\n    // Remember added listeners for devtools.\n    if (!brick.$$eventListeners) {\n      brick.$$eventListeners = [];\n    }\n    for (var handler of [].concat(handlers)) {\n      brick.$$eventListeners.push([eventType, null, handler]);\n    }\n  });\n}\nexport function unbindListeners(brick) {\n  if (brick.$$listeners) {\n    for (var [eventType, listener] of brick.$$listeners) {\n      brick.removeEventListener(eventType, listener);\n    }\n    brick.$$listeners.length = 0;\n  }\n}\nexport function isBuiltinHandler(handler) {\n  return typeof handler.action === \"string\";\n}\nexport function isUseProviderHandler(handler) {\n  return typeof handler.useProvider === \"string\";\n}\nexport function isCustomHandler(handler) {\n  return !!((handler.target || handler.targetRef) && (handler.method || handler.properties));\n}\nexport function isExecuteCustomHandler(handler) {\n  return !!handler.method;\n}\nexport function isSetPropsCustomHandler(handler) {\n  return !!handler.properties;\n}\nexport function isConditionalEventHandler(handler) {\n  return !!handler.then;\n}\nexport function listenerFactory(handlers, runtimeContext, runtimeBrick) {\n  return function (event) {\n    var _handler$batch, _handler$batch2;\n    for (var handler of [].concat(handlers)) {\n      if (!checkIf(handler, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }))) {\n        if (handler.else) {\n          listenerFactory(handler.else, runtimeContext, runtimeBrick)(event);\n        }\n        continue;\n      }\n      if (isConditionalEventHandler(handler)) {\n        listenerFactory(handler.then, runtimeContext, runtimeBrick)(event);\n      } else if (isBuiltinHandler(handler)) {\n        var [object, method] = handler.action.split(\".\");\n        switch (handler.action) {\n          case \"history.push\":\n          case \"history.replace\":\n          case \"history.pushQuery\":\n          case \"history.replaceQuery\":\n          case \"history.pushAnchor\":\n          case \"history.block\":\n          case \"history.goBack\":\n          case \"history.goForward\":\n          case \"history.reload\":\n          case \"history.unblock\":\n            handleHistoryAction(event, method, handler.args, handler.callback, runtimeContext);\n            break;\n\n          // case \"segue.push\":\n          // case \"segue.replace\":\n          // case \"alias.push\":\n          // case \"alias.replace\":\n\n          case \"window.open\":\n            handleWindowAction(event, handler.args, runtimeContext);\n            break;\n          case \"location.reload\":\n          case \"location.assign\":\n            handleLocationAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"localStorage.setItem\":\n          case \"localStorage.removeItem\":\n          case \"sessionStorage.setItem\":\n          case \"sessionStorage.removeItem\":\n            handleStorageAction(event, object, method, handler.args, runtimeContext);\n            break;\n          case \"event.preventDefault\":\n            event.preventDefault();\n            break;\n          case \"console.log\":\n          case \"console.error\":\n          case \"console.warn\":\n          case \"console.info\":\n            handleConsoleAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"message.success\":\n          case \"message.error\":\n          case \"message.info\":\n          case \"message.warn\":\n            handleMessageAction(event, method, handler.args, runtimeContext);\n            break;\n          case \"handleHttpError\":\n            handleHttpError(event.detail);\n            break;\n          case \"context.assign\":\n          case \"context.replace\":\n          case \"context.refresh\":\n          case \"context.load\":\n            handleContextAction(event, method, handler.args, (_handler$batch = handler.batch) !== null && _handler$batch !== void 0 ? _handler$batch : true, handler.callback, runtimeContext);\n            break;\n          case \"state.update\":\n          case \"state.refresh\":\n          case \"state.load\":\n            handleTplStateAction(event, method, handler.args, (_handler$batch2 = handler.batch) !== null && _handler$batch2 !== void 0 ? _handler$batch2 : true, handler.callback, runtimeContext);\n            break;\n          case \"tpl.dispatchEvent\":\n            {\n              var [type, init] = argsFactory(handler.args, runtimeContext, event);\n              var tplHostElement = getTplHostElement(runtimeContext, handler.action, \": \".concat(type));\n              tplHostElement.dispatchEvent(new CustomEvent(type, init));\n              break;\n            }\n          case \"formstate.update\":\n            handleFormStateAction(event, handler.args, handler.callback, runtimeContext);\n            break;\n\n          // case \"message.subscribe\":\n          // case \"message.unsubscribe\":\n\n          case \"theme.setDarkTheme\":\n          case \"theme.setLightTheme\":\n            applyTheme(handler.action === \"theme.setDarkTheme\" ? \"dark\" : \"light\");\n            break;\n          case \"theme.setTheme\":\n            {\n              var [theme] = argsFactory(handler.args, runtimeContext, event);\n              applyTheme(theme);\n              break;\n            }\n          case \"mode.setDashboardMode\":\n          case \"mode.setDefaultMode\":\n            applyMode(handler.action === \"mode.setDashboardMode\" ? \"dashboard\" : \"default\");\n            break;\n\n          // case \"menu.clearMenuTitleCache\":\n          // case \"menu.clearMenuCache\":\n\n          // case \"analytics.event\":\n\n          // case \"preview.debug\":\n\n          default:\n            // eslint-disable-next-line no-console\n            console.error(\"unknown event listener action:\", handler.action);\n        }\n      } else if (isUseProviderHandler(handler)) {\n        handleUseProviderAction(event, handler, runtimeContext, runtimeBrick);\n      } else if (isCustomHandler(handler)) {\n        handleCustomAction(event, handler, runtimeContext, runtimeBrick);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"unknown event handler:\", handler);\n      }\n    }\n  };\n}\nfunction handleUseProviderAction(_x, _x2, _x3, _x4) {\n  return _handleUseProviderAction.apply(this, arguments);\n}\nfunction _handleUseProviderAction() {\n  _handleUseProviderAction = _asyncToGenerator(function* (event, handler, runtimeContext, runtimeBrick) {\n    try {\n      var providerBrick = yield getProviderBrick(handler.useProvider);\n      var method = handler.method !== \"saveAs\" ? \"resolve\" : \"saveAs\";\n      brickCallback(event, providerBrick, handler, method, runtimeContext, runtimeBrick);\n    } catch (error) {\n      // eslint-disable-next-line no-console\n      console.error(httpErrorToString(error));\n    }\n  });\n  return _handleUseProviderAction.apply(this, arguments);\n}\nfunction handleCustomAction(event, handler, runtimeContext, runtimeBrick) {\n  var targets = [];\n  var rawTarget = handler.target;\n  var rawTargetRef = handler.targetRef;\n  var computedTarget = rawTarget;\n  // Allow `target` to be set as evaluable string.\n  if (typeof rawTarget === \"string\" ? isEvaluable(rawTarget) : isPreEvaluated(rawTarget)) {\n    computedTarget = computeRealValue(rawTarget, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      event\n    }));\n  }\n  if (typeof computedTarget === \"string\") {\n    if (computedTarget === \"_self\") {\n      targets.push(runtimeBrick.element);\n    } else if (handler.multiple) {\n      targets = Array.from(document.querySelectorAll(computedTarget));\n    } else {\n      var found = document.querySelector(computedTarget);\n      if (found !== null) {\n        targets.push(found);\n      }\n    }\n  } else if (computedTarget) {\n    if (computedTarget instanceof HTMLElement) {\n      targets.push(computedTarget);\n    } else {\n      // eslint-disable-next-line no-console\n      console.error(\"unexpected target:\", computedTarget);\n    }\n  } else if (rawTargetRef) {\n    var computedTargetRef = rawTargetRef;\n    // Allow `targetRef` to be set as evaluable string.\n    if (typeof rawTargetRef === \"string\" ? isEvaluable(rawTargetRef) : isPreEvaluated(rawTargetRef)) {\n      computedTargetRef = computeRealValue(rawTargetRef, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }));\n    }\n    var targetRefs = [].concat(computedTargetRef);\n    var tplHostElement = getTplHostElement(runtimeContext, \"targetRef\", \": \".concat(targetRefs.join(\", \")));\n    targets.push(...targetRefs.map(ref => {\n      var _tplHostElement$$$get;\n      return (_tplHostElement$$$get = tplHostElement.$$getElementByRef) === null || _tplHostElement$$$get === void 0 ? void 0 : _tplHostElement$$$get.call(tplHostElement, ref);\n    }).filter(Boolean));\n  }\n  if (targets.length === 0) {\n    // eslint-disable-next-line no-console\n    console.error(\"target not found:\", rawTarget || rawTargetRef);\n    return;\n  }\n  if (isExecuteCustomHandler(handler)) {\n    targets.forEach(target => {\n      brickCallback(event, target, handler, handler.method, runtimeContext, runtimeBrick, {\n        useEventAsDefault: true\n      });\n    });\n  } else if (isSetPropsCustomHandler(handler)) {\n    setProperties(targets, handler.properties, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      event\n    }));\n  }\n}\nfunction brickCallback(_x5, _x6, _x7, _x8, _x9, _x10, _x11) {\n  return _brickCallback.apply(this, arguments);\n}\nfunction _brickCallback() {\n  _brickCallback = _asyncToGenerator(function* (event, target, handler, method, runtimeContext, runtimeBrick, options) {\n    var _poll;\n    if (typeof target[method] !== \"function\") {\n      // eslint-disable-next-line no-console\n      console.error(\"target has no method:\", {\n        target,\n        method: method\n      });\n      return;\n    }\n    var task = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var _hooks$flowApi;\n        var computedArgs = argsFactory(handler.args, runtimeContext, event, options);\n        if (isUseProviderHandler(handler) && hooks !== null && hooks !== void 0 && (_hooks$flowApi = hooks.flowApi) !== null && _hooks$flowApi !== void 0 && _hooks$flowApi.isFlowApiProvider(handler.useProvider)) {\n          computedArgs = yield hooks.flowApi.getArgsOfFlowApi(handler.useProvider, computedArgs, method);\n        }\n        return target[method](...computedArgs);\n      });\n      return function task() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    if (!handler.callback) {\n      task();\n      return;\n    }\n    var callbackFactory = eventCallbackFactory(handler.callback, runtimeContext, runtimeBrick);\n    var pollableCallback = {\n      progress: callbackFactory(\"progress\"),\n      success: callbackFactory(\"success\"),\n      error: callbackFactory(\"error\"),\n      finally: callbackFactory(\"finally\")\n    };\n    var poll;\n    if (isUseProviderHandler(handler)) {\n      poll = computeRealValue(handler.poll, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n        event\n      }));\n    }\n    if ((_poll = poll) !== null && _poll !== void 0 && _poll.enabled) {\n      startPoll(task, pollableCallback, poll);\n    } else {\n      try {\n        // Try to catch synchronized tasks too.\n        var result = yield task();\n        pollableCallback.success(result);\n      } catch (err) {\n        pollableCallback.error(err);\n      } finally {\n        pollableCallback[\"finally\"]();\n      }\n    }\n  });\n  return _brickCallback.apply(this, arguments);\n}\nfunction handleHistoryAction(event, method, args, callback, runtimeContext) {\n  var baseArgsLength = 0;\n  var hasCallback = false;\n  var overrideMethod = method;\n  switch (method) {\n    case \"push\":\n    case \"replace\":\n    case \"pushQuery\":\n    case \"replaceQuery\":\n    case \"pushAnchor\":\n      baseArgsLength = 2;\n      hasCallback = true;\n      break;\n    case \"reload\":\n      hasCallback = true;\n      break;\n    case \"block\":\n      baseArgsLength = 1;\n      overrideMethod = \"setBlockMessage\";\n      break;\n  }\n  var computedArgs = [];\n  if (baseArgsLength > 0) {\n    computedArgs = argsFactory(args, runtimeContext, event, {\n      useEventDetailAsDefault: true\n    });\n    computedArgs.length = baseArgsLength;\n  }\n  if (hasCallback && callback) {\n    var callbackFactory = eventCallbackFactory(callback, runtimeContext, undefined);\n    computedArgs.push(blocked => {\n      callbackFactory(blocked ? \"error\" : \"success\")({\n        blocked\n      });\n      callbackFactory(\"finally\")({\n        blocked\n      });\n    });\n  }\n  getHistory()[overrideMethod](...computedArgs);\n}\nfunction handleWindowAction(event, args, runtimeContext) {\n  var [url, target, features] = argsFactory(args, runtimeContext, event);\n  window.open(url, target || \"_self\", features);\n}\nfunction batchUpdate(args, batch, method, store, runtimeContext, event) {\n  if (batch) {\n    store.updateValues(args, method, arg => {\n      return argsFactory(arg, runtimeContext, event)[0];\n    });\n  } else {\n    args.forEach(arg => {\n      var {\n        name,\n        value\n      } = argsFactory([arg], runtimeContext, event)[0];\n      store.updateValue(name, value, method);\n    });\n  }\n}\nfunction handleContextAction(event, method, args, batch, callback, runtimeContext) {\n  var isBatch = Array.isArray(args) && args.every(isObject);\n  if (isBatch && (method === \"assign\" || method === \"replace\")) {\n    batchUpdate(args, batch, method, runtimeContext.ctxStore, runtimeContext, event);\n  } else {\n    var [name, value] = argsFactory(args, runtimeContext, event);\n    runtimeContext.ctxStore.updateValue(name, value, method, callback, runtimeContext);\n  }\n}\nfunction handleTplStateAction(event, method, args, batch, callback, runtimeContext) {\n  var isBatch = Array.isArray(args) && args.every(isObject);\n  if (isBatch && method === \"update\") {\n    batchUpdate(args, batch, \"replace\", runtimeContext.ctxStore, runtimeContext, event);\n  } else {\n    var [name, value] = argsFactory(args, runtimeContext, event);\n    var tplStateStore = getTplStateStore(runtimeContext, \"state.\".concat(method), \": \".concat(name));\n    tplStateStore.updateValue(name, value, method === \"update\" ? \"replace\" : method, callback, runtimeContext);\n  }\n}\nfunction handleFormStateAction(event, args, callback, runtimeContext) {\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  var formStateStore = getFormStateStore(runtimeContext, \"formstate.update\", \": \".concat(name));\n  formStateStore.updateValue(name, value, \"replace\", callback, runtimeContext);\n}\nfunction handleLocationAction(event, method, args, runtimeContext) {\n  if (method === \"assign\") {\n    var [url] = argsFactory(args, runtimeContext, event);\n    location.assign(url);\n  } else {\n    location[method]();\n  }\n}\nfunction handleStorageAction(event, object, method, args, runtimeContext) {\n  var storage = object === \"localStorage\" ? localStorage : sessionStorage;\n  var [name, value] = argsFactory(args, runtimeContext, event);\n  if (method === \"setItem\") {\n    if (value !== undefined) {\n      storage.setItem(name, JSON.stringify(value));\n    }\n  } else {\n    storage.removeItem(name);\n  }\n}\nfunction handleConsoleAction(event, method, args, runtimeContext) {\n  // eslint-disable-next-line no-console\n  console[method](...argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  }));\n}\nfunction handleMessageAction(event, method, args, runtimeContext) {\n  var computedArgs = argsFactory(args, runtimeContext, event, {\n    useEventAsDefault: true\n  });\n  Notification.show({\n    type: method,\n    message: computedArgs[0]\n  });\n}\nexport function eventCallbackFactory(callback, runtimeContext, runtimeBrick) {\n  return function callbackFactory(type) {\n    return function (result) {\n      var handlers = callback === null || callback === void 0 ? void 0 : callback[type];\n      if (handlers) {\n        try {\n          var event = new CustomEvent(\"callback.\".concat(type), {\n            detail: result\n          });\n          listenerFactory(handlers, runtimeContext, runtimeBrick)(event);\n        } catch (err) {\n          // Do not throw errors in `callback.success` or `callback.progress`,\n          // to avoid the following triggering of `callback.error`.\n          // eslint-disable-next-line\n          console.error(err);\n        }\n      } else if (type === \"error\") {\n        // eslint-disable-next-line\n        console.error(\"Unhandled callback error:\", result);\n      }\n    };\n  };\n}\nfunction argsFactory(args, runtimeContext, event) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return Array.isArray(args) ? computeRealValue(args, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n    event\n  })) : options.useEventAsDefault ? [event] : options.useEventDetailAsDefault ? [event.detail] : [];\n}\n//# sourceMappingURL=bindListeners.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport { hasOwnProperty, isObject } from \"@next-core/utils/general\";\nimport { strictCollectMemberUsage } from \"@next-core/utils/storyboard\";\nimport { eventCallbackFactory, listenerFactory } from \"../bindListeners.js\";\nimport { asyncCheckIf } from \"../compute/checkIf.js\";\nimport { asyncComputeRealValue, computeRealValue } from \"../compute/computeRealValue.js\";\nimport { resolveData } from \"./resolveData.js\";\nimport { resolveDataStore } from \"./resolveDataStore.js\";\nimport { handleHttpError } from \"../../handleHttpError.js\";\nexport class DataStore {\n  constructor(type, hostBrick) {\n    _defineProperty(this, \"type\", void 0);\n    _defineProperty(this, \"data\", new Map());\n    _defineProperty(this, \"changeEventType\", void 0);\n    _defineProperty(this, \"pendingStack\", []);\n    _defineProperty(this, \"hostBrick\", void 0);\n    _defineProperty(this, \"batchUpdate\", false);\n    _defineProperty(this, \"batchUpdateContextsNames\", []);\n    this.type = type;\n    this.changeEventType = this.type === \"FORM_STATE\" ? \"formstate.change\" : this.type === \"STATE\" ? \"state.change\" : \"context.change\";\n    this.hostBrick = hostBrick;\n  }\n  getValue(name) {\n    var _this$data$get;\n    return (_this$data$get = this.data.get(name)) === null || _this$data$get === void 0 ? void 0 : _this$data$get.value;\n  }\n  getAffectListByContext(name) {\n    var affectNames = [name];\n    this.data.forEach((value, key) => {\n      if (value.deps) {\n        var isInDeps = value.deps.some(item => affectNames.includes(item));\n        isInDeps && affectNames.push(key) && affectNames.push(...this.getAffectListByContext(key));\n      }\n    });\n    affectNames.shift();\n    return [...new Set(affectNames)];\n  }\n  updateValues(values, method, argsFactory) {\n    this.batchUpdate = true;\n    this.batchUpdateContextsNames = values.map(item => item.name);\n    if ([...new Set(this.batchUpdateContextsNames)].length !== this.batchUpdateContextsNames.length) {\n      throw new Error(\"Batch update not allow to update same item\");\n    }\n    var updateContexts = {};\n    var affectContexts = {};\n    var affectDepsContextNames = [];\n    values.forEach(arg => {\n      var {\n        name,\n        value\n      } = argsFactory([arg]);\n      var updateContextItem = this.data.get(name);\n      affectDepsContextNames.push(...this.getAffectListByContext(name));\n      updateContextItem && (updateContexts[name] = updateContextItem);\n      this.updateValue(name, value, method);\n    });\n    affectDepsContextNames.filter(item => !updateContexts[item]).forEach(name => {\n      var affectContextItem = this.data.get(name);\n      affectContextItem && (affectContexts[name] = affectContextItem);\n    });\n    var triggerEvent = contexts => {\n      for (var key in contexts) {\n        var _context$eventTarget;\n        var context = contexts[key];\n        (_context$eventTarget = context.eventTarget) === null || _context$eventTarget === void 0 ? void 0 : _context$eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n          detail: context.value\n        }));\n      }\n    };\n    triggerEvent(updateContexts);\n    triggerEvent(affectContexts);\n    this.batchUpdate = false;\n    return;\n  }\n  updateValue(name, value, method, callback, callbackRuntimeContext) {\n    var item = this.data.get(name);\n    if (!item) {\n      throw new Error(\"\".concat(this.type, \" '\").concat(name, \"' is not defined\"));\n    }\n    if (method === \"refresh\" || method === \"load\") {\n      if (!item.load) {\n        throw new Error(\"You can not \".concat(method, \" \\\"\").concat(this.type, \".\").concat(name, \"\\\" which has no resolve\"));\n      }\n      var promise;\n      if (method === \"load\") {\n        // Try to reuse previous request when calling `load`.\n        if (item.loaded) {\n          promise = Promise.resolve(item.value);\n        } else if (item.loading) {\n          promise = item.loading;\n        }\n      }\n      if (!promise) {\n        promise = item.loading = item.load(_objectSpread({\n          cache: method === \"load\" ? \"default\" : \"reload\"\n        }, value));\n        // Do not use the chained promise, since the callbacks need the original promise.\n        promise.then(val => {\n          item.loaded = true;\n          item.value = val;\n          item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n            detail: item.value\n          }));\n        }, err => {\n          // Let users override error handling.\n          if (!(callback !== null && callback !== void 0 && callback.error)) {\n            handleHttpError(err);\n          }\n        });\n      }\n      if (callback) {\n        var callbackFactory = eventCallbackFactory(callback, callbackRuntimeContext);\n        promise.then(val => {\n          callbackFactory(\"success\")({\n            value: val\n          });\n          callbackFactory(\"finally\")();\n        }, err => {\n          callbackFactory(\"error\")(err);\n          callbackFactory(\"finally\")();\n        });\n      }\n      return;\n    }\n    if (method === \"replace\") {\n      item.value = value;\n    } else {\n      if (isObject(item.value)) {\n        Object.assign(item.value, value);\n      } else {\n        // eslint-disable-next-line no-console\n        console.warn(\"Non-object current value of \\\"\".concat(this.type, \".\").concat(name, \"\\\" for \\\"context.assign\\\", try \\\"context.replace\\\" instead.\"));\n        item.value = value;\n      }\n    }\n    if (this.batchUpdate) return;\n    item.eventTarget.dispatchEvent(new CustomEvent(this.changeEventType, {\n      detail: item.value\n    }));\n  }\n  define(dataConfs, runtimeContext, asyncHostProperties) {\n    if (Array.isArray(dataConfs) && dataConfs.length > 0) {\n      var pending = resolveDataStore(dataConfs, dataConf => this.resolve(dataConf, runtimeContext, asyncHostProperties), this.type);\n      this.pendingStack.push(pending);\n    }\n  }\n  onChange(dataName, listener) {\n    var _this$data$get2;\n    (_this$data$get2 = this.data.get(dataName)) === null || _this$data$get2 === void 0 ? void 0 : _this$data$get2.eventTarget.addEventListener(this.changeEventType, listener);\n  }\n  waitFor(dataNames) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      var _loop = function* (pendingContexts) {\n        yield Promise.all([...dataNames].map(ctx => {\n          var p = pendingContexts.get(ctx);\n          return p;\n        }));\n      };\n      for (var {\n        pendingContexts\n      } of _this.pendingStack) {\n        yield* _loop(pendingContexts);\n      }\n    })();\n  }\n  waitForAll() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      for (var {\n        pendingResult\n      } of _this2.pendingStack) {\n        yield pendingResult;\n      }\n    })();\n  }\n  resolve(dataConf, runtimeContext, asyncHostProperties) {\n    var _this3 = this;\n    return _asyncToGenerator(function* () {\n      if (!(yield asyncCheckIf(dataConf, runtimeContext))) {\n        return false;\n      }\n      var value;\n      if (asyncHostProperties && (_this3.type === \"STATE\" ? dataConf.expose : _this3.type === \"FORM_STATE\")) {\n        var hostProps = yield asyncHostProperties;\n        if (hasOwnProperty(hostProps, dataConf.name)) {\n          value = hostProps[dataConf.name];\n        }\n      }\n      var load;\n      var isLazyResolve = false;\n      if (value === undefined) {\n        if (dataConf.resolve) {\n          var resolveConf = _objectSpread({\n            transform: \"value\"\n          }, dataConf.resolve);\n          if (yield asyncCheckIf(dataConf.resolve, runtimeContext)) {\n            load = /*#__PURE__*/function () {\n              var _ref = _asyncToGenerator(function* (options) {\n                return (yield resolveData(resolveConf, runtimeContext, options)).value;\n              });\n              return function load(_x) {\n                return _ref.apply(this, arguments);\n              };\n            }();\n            isLazyResolve = dataConf.resolve.lazy;\n            if (!isLazyResolve) {\n              value = yield load();\n            }\n          } else if (!hasOwnProperty(dataConf, \"value\")) {\n            return false;\n          }\n        }\n        if ((!load || isLazyResolve) && dataConf.value !== undefined) {\n          // If the context has no resolve, just use its `value`.\n          // Or if the resolve is ignored or lazy, use its `value` as a fallback.\n          value = yield asyncComputeRealValue(dataConf.value, runtimeContext);\n        }\n      }\n      var newData = {\n        value,\n        // This is required for tracking context, even if no `onChange` is specified.\n        eventTarget: new EventTarget(),\n        load,\n        loaded: !isLazyResolve,\n        deps: []\n      };\n      if (dataConf.onChange) {\n        newData.eventTarget.addEventListener(_this3.changeEventType, listenerFactory(dataConf.onChange, runtimeContext));\n      }\n      if (dataConf.track) {\n        var deps = strictCollectMemberUsage(load ? dataConf.resolve : dataConf.value, _this3.type);\n        !load && (newData.deps = [...deps]);\n        for (var dep of deps) {\n          _this3.onChange(dep, _this3.batchAddListener(() => {\n            if (load) {\n              _this3.updateValue(dataConf.name, {\n                cache: \"default\"\n              }, \"refresh\");\n            } else {\n              _this3.updateValue(dataConf.name, computeRealValue(dataConf.value, runtimeContext), \"replace\");\n            }\n          }, dataConf));\n        }\n      }\n      if (_this3.data.has(dataConf.name)) {\n        throw new Error(\"\".concat(_this3.type, \" '\").concat(dataConf.name, \"' has already been declared\"));\n      }\n      _this3.data.set(dataConf.name, newData);\n      return true;\n    })();\n  }\n  batchAddListener(listener, contextConf) {\n    return event => {\n      if (this.batchUpdate && this.batchUpdateContextsNames.includes(contextConf.name)) {\n        return;\n      }\n      listener(event);\n    };\n  }\n}\n//# sourceMappingURL=DataStore.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { collectMemberUsage } from \"@next-core/utils/storyboard\";\nexport function resolveDataStore(contextConfs, resolveContext) {\n  var keyword = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"CTX\";\n  var dependencyMap = getDependencyMapOfContext(contextConfs, keyword);\n  // There maybe multiple context confs for a specific name, since there are conditional contexts.\n  // This is a map of how many pending context confs for each context name.\n  var pendingDeps = new Map();\n  for (var contextName of Array.from(dependencyMap.keys()).map(contextConf => contextConf.name)) {\n    var _pendingDeps$get;\n    pendingDeps.set(contextName, ((_pendingDeps$get = pendingDeps.get(contextName)) !== null && _pendingDeps$get !== void 0 ? _pendingDeps$get : 0) + 1);\n  }\n  var hasNonStaticUsage = Array.from(dependencyMap.values()).some(stats => stats.hasNonStaticUsage);\n  var processed = new WeakSet();\n  var deferredContexts = new Map();\n  var pendingContexts = new Map([...new Set(contextConfs.map(contextConf => contextConf.name))].map(contextName => [contextName, new Promise((resolve, reject) => {\n    deferredContexts.set(contextName, {\n      resolve,\n      reject\n    });\n  })]));\n  var wrapResolve = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator(function* (contextConf) {\n      var _pendingDeps$get2;\n      processed.add(contextConf);\n      var resolved = yield resolveContext(contextConf);\n      dependencyMap.delete(contextConf);\n      var left = (_pendingDeps$get2 = pendingDeps.get(contextConf.name)) !== null && _pendingDeps$get2 !== void 0 ? _pendingDeps$get2 : 0;\n      if (resolved) {\n        // Assert: contextConf.name exists in deferredContexts\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        deferredContexts.get(contextConf.name).resolve();\n        pendingDeps.delete(contextConf.name);\n        if (left === 0) {\n          throw new Error(\"Duplicated context defined: \".concat(contextConf.name));\n        }\n      } else {\n        // Assert: left >= 1\n        if (left === 1) {\n          // Assert: contextConf.name exists in deferredContexts\n          // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n          deferredContexts.get(contextConf.name).resolve();\n          pendingDeps.delete(contextConf.name);\n        } else {\n          pendingDeps.set(contextConf.name, left - 1);\n        }\n      }\n      yield scheduleNext();\n    });\n    return function wrapResolve(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var scheduleAsSerial = hasNonStaticUsage;\n  function scheduleNext() {\n    return _scheduleNext.apply(this, arguments);\n  }\n  function _scheduleNext() {\n    _scheduleNext = _asyncToGenerator(function* () {\n      var readyContexts = Array.from(dependencyMap.entries()).filter(predicateNextResolveFactory(pendingDeps, scheduleAsSerial)).map(entry => entry[0]).filter(contextConf => !processed.has(contextConf));\n      yield Promise.all(readyContexts.map(wrapResolve));\n    });\n    return _scheduleNext.apply(this, arguments);\n  }\n  var pendingResult = scheduleNext().then( /*#__PURE__*/_asyncToGenerator(function* () {\n    // If there are still contexts left, it implies one of these situations:\n    //   - Circular contexts.\n    //     Such as: a depends on b, while b depends on a.\n    //   - Related contexts are all ignored.\n    //     Such as: a depends on b,\n    //     while both them are ignore by a falsy result of `if`.\n    if (dependencyMap.size > 0) {\n      // This will throw if circular contexts detected.\n      detectCircularContexts(dependencyMap, keyword);\n      scheduleAsSerial = true;\n      yield scheduleNext();\n    }\n    // There maybe ignored contexts which are still not fulfilled.\n    // We treat them as RESOLVED.\n    for (var deferred of deferredContexts.values()) {\n      deferred.resolve();\n    }\n  })).catch(error => {\n    // There maybe contexts left not fulfilled, when an error occurred.\n    // We treat them as REJECTED.\n    for (var deferred of deferredContexts.values()) {\n      deferred.reject(error);\n    }\n    throw error;\n  });\n  return {\n    pendingResult,\n    pendingContexts\n  };\n}\nfunction predicateNextResolveFactory(pendingDeps, scheduleAsSerial) {\n  return (entry, index) =>\n  // When contexts contain computed CTX accesses, it implies a dynamic dependency map.\n  // So make them process sequentially, keep the same behavior as before.\n  scheduleAsSerial ? index === 0 :\n  // A context is ready when it has no pending dependencies.\n  ![...entry[1].usedProperties].some(dep => pendingDeps.has(dep));\n}\nexport function getDependencyMapOfContext(contextConfs) {\n  var keyword = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"CTX\";\n  var depsMap = new Map();\n  for (var _contextConf of contextConfs) {\n    var stats = collectMemberUsage([_contextConf.if, _contextConf.value, _contextConf.resolve], keyword);\n    depsMap.set(_contextConf, stats);\n  }\n  return depsMap;\n}\nfunction detectCircularContexts(dependencyMap, keyword) {\n  var duplicatedMap = new Map(dependencyMap);\n  var pendingDeps = new Set(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name));\n  var next = () => {\n    var processedAtLeastOne = false;\n    for (var [_contextConf2, stats] of duplicatedMap.entries()) {\n      if (![...stats.usedProperties].some(dep => pendingDeps.has(dep))) {\n        duplicatedMap.delete(_contextConf2);\n        pendingDeps.delete(_contextConf2.name);\n        processedAtLeastOne = true;\n      }\n    }\n    if (processedAtLeastOne) {\n      next();\n    }\n  };\n  next();\n  if (duplicatedMap.size > 0) {\n    throw new ReferenceError(\"Circular \".concat(keyword, \" detected: \").concat(Array.from(duplicatedMap.keys()).map(contextConf => contextConf.name).join(\", \")));\n  }\n}\n//# sourceMappingURL=resolveDataStore.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { clamp } from \"lodash\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachItem, symbolForTplStateStoreId } from \"./constants.js\";\nexport function setupTemplateProxy(hostContext, ref, slots) {\n  var {\n    reversedProxies,\n    asyncHostProperties,\n    externalSlots,\n    tplStateStoreId,\n    hostBrick\n  } = hostContext;\n  var asyncComputedProps;\n  if (ref && reversedProxies) {\n    var propertyProxies = reversedProxies.properties.get(ref);\n    if (propertyProxies) {\n      var getComputedProps = hostProps => {\n        var props = {};\n        for (var {\n          from,\n          to\n        } of propertyProxies) {\n          var propValue = hostProps[from];\n          if (propValue !== undefined && to.refProperty) {\n            props[to.refProperty] = propValue;\n          }\n        }\n        return props;\n      };\n      asyncComputedProps = asyncHostProperties.then(getComputedProps);\n    }\n    var slotProxies = reversedProxies.slots.get(ref);\n    if (slotProxies && externalSlots) {\n      // Use an approach like template-literal's quasis:\n      // `quasi0${0}quais1${1}quasi2...`\n      // Every quasi (indexed by `refPosition`) can be slotted with multiple bricks.\n      var quasisMap = new Map();\n      for (var {\n        from,\n        to\n      } of slotProxies) {\n        var _externalSlots$from$b, _externalSlots$from, _to$refSlot, _to$refPosition;\n        var insertBricks = (_externalSlots$from$b = (_externalSlots$from = externalSlots[from]) === null || _externalSlots$from === void 0 ? void 0 : _externalSlots$from.bricks) !== null && _externalSlots$from$b !== void 0 ? _externalSlots$from$b : [];\n        if (!insertBricks.length) {\n          continue;\n        }\n        var refToSlot = (_to$refSlot = to.refSlot) !== null && _to$refSlot !== void 0 ? _to$refSlot : from;\n        var expandableSlot = quasisMap.get(refToSlot);\n        if (!expandableSlot) {\n          expandableSlot = [];\n          // The size of quasis should be the existed slotted bricks' size plus one.\n          var size = hasOwnProperty(slots, refToSlot) ? slots[refToSlot].bricks.length + 1 : 1;\n          for (var i = 0; i < size; i += 1) {\n            expandableSlot.push([]);\n          }\n          quasisMap.set(refToSlot, expandableSlot);\n        }\n        var refPosition = (_to$refPosition = to.refPosition) !== null && _to$refPosition !== void 0 ? _to$refPosition : -1;\n        expandableSlot[clamp(refPosition < 0 ? expandableSlot.length + refPosition : refPosition, 0, expandableSlot.length - 1)].push(...(hasOwnProperty(hostBrick.runtimeContext, \"forEachItem\") ? setupTemplateExternalBricks(insertBricks, hostBrick.runtimeContext.forEachItem) : insertBricks));\n      }\n      var _loop = function () {\n        if (!hasOwnProperty(slots, slotName)) {\n          slots[slotName] = {\n            type: \"bricks\",\n            bricks: []\n          };\n        }\n        var slotConf = slots[slotName];\n        slotConf.bricks = quasis.flatMap((bricks, index) => index < slotConf.bricks.length ? bricks.concat(slotConf.bricks[index]) : bricks);\n        if (slotConf.bricks.length === 0) {\n          delete slots[slotName];\n        }\n      };\n      for (var [slotName, quasis] of quasisMap.entries()) {\n        _loop();\n      }\n    }\n  }\n  return {\n    [symbolForAsyncComputedPropsFromHost]: asyncComputedProps,\n    [symbolForTplStateStoreId]: tplStateStoreId\n  };\n}\n\n// External bricks of a template, have the same forEachItem context as their host.\nfunction setupTemplateExternalBricks(bricks, forEachItem) {\n  return bricks.map(brick => {\n    var _brick$slots;\n    return _objectSpread(_objectSpread({}, brick), {}, {\n      [symbolForTPlExternalForEachItem]: forEachItem,\n      slots: Object.fromEntries(Object.entries((_brick$slots = brick.slots) !== null && _brick$slots !== void 0 ? _brick$slots : {}).map(_ref => {\n        var _slotConf$bricks;\n        var [slotName, slotConf] = _ref;\n        return [slotName, slotConf.type === \"routes\" ? {\n          type: \"routes\",\n          routes: setupTemplateExternalRoutes(slotConf.routes, forEachItem)\n        } : {\n          type: \"bricks\",\n          bricks: setupTemplateExternalBricks((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : [], forEachItem)\n        }];\n      }))\n    });\n  });\n}\nfunction setupTemplateExternalRoutes(routes, forEachItem) {\n  return routes.map(route => route.type && route.type !== \"bricks\" ? route : _objectSpread(_objectSpread({}, route), {}, {\n    bricks: setupTemplateExternalBricks(route.bricks, forEachItem)\n  }));\n}\n//# sourceMappingURL=setupTemplateProxy.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"properties\", \"slots\", \"children\"];\nimport { isObject } from \"@next-core/utils/general\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nexport function setupUseBrickInTemplate(props, hostContext) {\n  function walk(props) {\n    if (!isObject(props)) {\n      return props;\n    }\n    if (Array.isArray(props)) {\n      return props.map(walk);\n    }\n    return Object.fromEntries(Object.entries(props).map(_ref => {\n      var [key, value] = _ref;\n      return isObject(value) && key === \"useBrick\" ? Array.isArray(value) ? [key, value.map(setup)] : [key, setup(value)] : [key, walk(value)];\n    }).concat(Object.getOwnPropertySymbols(props).map(k => [k, props[k]])));\n  }\n  function setup(item) {\n    var {\n        properties,\n        slots: originalSlots,\n        children\n      } = item,\n      restConf = _objectWithoutProperties(item, _excluded);\n    var transpiledSlots = childrenToSlots(children, originalSlots);\n    var slots = Object.fromEntries(Object.entries(transpiledSlots !== null && transpiledSlots !== void 0 ? transpiledSlots : {}).map(_ref2 => {\n      var _slotConf$bricks;\n      var [slotName, slotConf] = _ref2;\n      return [slotName, {\n        type: \"bricks\",\n        bricks: ((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : []).map(setup)\n      }];\n    }));\n    return _objectSpread(_objectSpread({}, restConf), {}, {\n      properties: walk(properties),\n      slots\n    }, setupTemplateProxy(hostContext, restConf.ref, slots));\n  }\n  return walk(props);\n}\n//# sourceMappingURL=setupUseBrickInTemplate.js.map","import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nvar _excluded = [\"slots\", \"children\"],\n  _excluded2 = [\"properties\", \"slots\", \"children\"];\nimport { uniqueId } from \"lodash\";\nimport { customTemplates } from \"../../CustomTemplates.js\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { setupTemplateProxy } from \"./setupTemplateProxy.js\";\nimport { setupUseBrickInTemplate } from \"./setupUseBrickInTemplate.js\";\nimport { childrenToSlots } from \"../Renderer.js\";\nimport { hooks } from \"../Runtime.js\";\nexport function expandCustomTemplate(tplTagName, brickConf, hostBrick, asyncHostProperties) {\n  var _hooks$flowApi;\n  var tplStateStoreId = uniqueId(\"tpl-state-\");\n  var runtimeContext = _objectSpread(_objectSpread({}, hostBrick.runtimeContext), {}, {\n    tplStateStoreId\n  });\n\n  // There is a boundary for `forEachItem` and `FORM_STATE` between template internals and externals.\n  delete runtimeContext.forEachItem;\n  delete runtimeContext.formStateStoreId;\n  var tplStateStore = new DataStore(\"STATE\", hostBrick);\n  runtimeContext.tplStateStoreMap.set(tplStateStoreId, tplStateStore);\n  if (runtimeContext.tplStateStoreScope) {\n    runtimeContext.tplStateStoreScope.push(tplStateStore);\n  }\n  var {\n    bricks,\n    proxy,\n    state,\n    contracts\n  } = customTemplates.get(tplTagName);\n  hooks === null || hooks === void 0 ? void 0 : (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 ? void 0 : _hooks$flowApi.collectWidgetContract(contracts);\n  tplStateStore.define(state, runtimeContext, asyncHostProperties);\n  var {\n      slots: originalExternalSlots,\n      children: externalChildren\n    } = brickConf,\n    restBrickConf = _objectWithoutProperties(brickConf, _excluded);\n  var newBrickConf = _objectSpread(_objectSpread({}, restBrickConf), {}, {\n    brick: tplTagName\n  });\n  hostBrick.tplHostMetadata = {\n    internalBricksByRef: new Map(),\n    tplStateStoreId,\n    proxy\n  };\n\n  // Reversed proxies are used for expand storyboard before rendering page.\n  var reversedProxies = {\n    properties: new Map(),\n    slots: new Map()\n    // mergeBases: new Map(),\n  };\n\n  if (proxy !== null && proxy !== void 0 && proxy.properties) {\n    for (var [from, to] of Object.entries(proxy.properties)) {\n      var proxies = reversedProxies.properties.get(to.ref);\n      if (!proxies) {\n        proxies = [];\n        reversedProxies.properties.set(to.ref, proxies);\n      }\n      proxies.push({\n        from,\n        to\n      });\n    }\n  }\n  if (proxy !== null && proxy !== void 0 && proxy.slots) {\n    for (var [_from, _to] of Object.entries(proxy.slots)) {\n      var _proxies = reversedProxies.slots.get(_to.ref);\n      if (!_proxies) {\n        _proxies = [];\n        reversedProxies.slots.set(_to.ref, _proxies);\n      }\n      _proxies.push({\n        from: _from,\n        to: _to\n      });\n    }\n  }\n  var hostContext = {\n    reversedProxies,\n    asyncHostProperties,\n    externalSlots: childrenToSlots(externalChildren, originalExternalSlots),\n    tplStateStoreId,\n    hostBrick: hostBrick\n  };\n  newBrickConf.slots = {\n    \"\": {\n      type: \"bricks\",\n      bricks: bricks.map(item => expandBrickInTemplate(item, hostContext))\n    }\n  };\n  return newBrickConf;\n}\nfunction expandBrickInTemplate(brickConfInTemplate, hostContext) {\n  // Ignore `if: null` to make `looseCheckIf` working.\n  if (brickConfInTemplate.if === null) {\n    delete brickConfInTemplate.if;\n  }\n  var {\n      properties,\n      slots: slotsInTemplate,\n      children: childrenInTemplate\n    } = brickConfInTemplate,\n    restBrickConfInTemplate = _objectWithoutProperties(brickConfInTemplate, _excluded2);\n  var transpiledSlots = childrenToSlots(childrenInTemplate, slotsInTemplate);\n  var slots = Object.fromEntries(Object.entries(transpiledSlots !== null && transpiledSlots !== void 0 ? transpiledSlots : {}).map(_ref => {\n    var _slotConf$bricks;\n    var [slotName, slotConf] = _ref;\n    return [slotName, {\n      type: \"bricks\",\n      bricks: ((_slotConf$bricks = slotConf.bricks) !== null && _slotConf$bricks !== void 0 ? _slotConf$bricks : []).map(item => expandBrickInTemplate(item, hostContext))\n    }];\n  }));\n  return _objectSpread(_objectSpread({}, restBrickConfInTemplate), {}, {\n    properties: setupUseBrickInTemplate(properties, hostContext),\n    slots\n  }, setupTemplateProxy(hostContext, restBrickConfInTemplate.ref, slots));\n}\n//# sourceMappingURL=expandCustomTemplate.js.map","export var RenderTag = /*#__PURE__*/function (RenderTag) {\n  RenderTag[RenderTag[\"ROOT\"] = 1] = \"ROOT\";\n  RenderTag[RenderTag[\"BRICK\"] = 2] = \"BRICK\";\n  return RenderTag;\n}({});\n//# sourceMappingURL=enums.js.map","export var FORM_RENDERER = \"form-renderer.form-renderer\";\nexport var symbolForFormStateStoreId = Symbol.for(\"form.stateStoreId\");\n//# sourceMappingURL=constants.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { uniqueId } from \"lodash\";\nimport { DataStore } from \"../data/DataStore.js\";\nimport { getDefaultProperties } from \"./getDefaultProperties.js\";\nimport { symbolForFormStateStoreId } from \"./constants.js\";\nexport function expandFormRenderer(formData, hostBrickConf, hostBrick, asyncHostProperties) {\n  var _normalizedFormData$c, _hostBrickConf$proper;\n  var normalizedFormData = typeof formData === \"string\" ? JSON.parse(formData) : formData;\n  var formStateStoreId = uniqueId(\"form-state-\");\n  var runtimeContext = _objectSpread(_objectSpread({}, hostBrick.runtimeContext), {}, {\n    formStateStoreId\n  });\n\n  // There is a boundary for `forEachItem` and `STATE` between form internals and externals.\n  delete runtimeContext.forEachItem;\n  delete runtimeContext.tplStateStoreId;\n  var formStateStore = new DataStore(\"FORM_STATE\");\n  runtimeContext.formStateStoreMap.set(formStateStoreId, formStateStore);\n  if (runtimeContext.formStateStoreScope) {\n    runtimeContext.formStateStoreScope.push(formStateStore);\n  }\n\n  // Always add a state of `params`.\n  var context = (_normalizedFormData$c = normalizedFormData.context) !== null && _normalizedFormData$c !== void 0 ? _normalizedFormData$c : [];\n  if (!context.some(ctx => ctx.name === \"params\")) {\n    context.push({\n      name: \"params\"\n    });\n  }\n  formStateStore.define(context, runtimeContext, asyncHostProperties);\n  var formConf = formSchemaToBrick(normalizedFormData.formSchema, normalizedFormData.fields, formStateStoreId);\n  if (formConf.brick === \"forms.general-form\" && hostBrickConf.events) {\n    formConf.events = mergeEvents(formConf.events, hostBrickConf.events);\n  }\n  var renderRoot = typeof ((_hostBrickConf$proper = hostBrickConf.properties) === null || _hostBrickConf$proper === void 0 ? void 0 : _hostBrickConf$proper.renderRoot) !== \"boolean\" || hostBrickConf.properties.renderRoot;\n  if (renderRoot) {\n    return _objectSpread(_objectSpread({}, hostBrickConf), {}, {\n      slots: undefined,\n      children: [{\n        brick: \"basic-bricks.micro-view\",\n        properties: {\n          style: {\n            padding: \"12px\"\n          }\n        },\n        slots: {\n          content: {\n            bricks: [formConf],\n            type: \"bricks\"\n          }\n        }\n      }]\n    });\n  }\n  return _objectSpread(_objectSpread({}, hostBrickConf), {}, {\n    slots: undefined,\n    children: [formConf]\n  });\n}\nfunction formSchemaToBrick(schema, fields, formStateStoreId) {\n  var {\n    id,\n    bricks,\n    events,\n    context,\n    mountPoint,\n    instanceId: iid\n  } = schema;\n  var {\n    brick,\n    properties\n  } = schema;\n\n  // 根据字段类型获取默认配置\n  var field = fields.find(item => item.fieldId === id);\n  if (field) {\n    var defaults = getDefaultProperties(field);\n    if (!brick) {\n      brick = defaults.brick;\n    }\n    properties = _objectSpread(_objectSpread({}, defaults.properties), properties);\n  }\n  var brickConf = {\n    brick,\n    properties,\n    iid,\n    slot: mountPoint,\n    events,\n    context,\n    children: formSchemasToBricks(bricks, fields, formStateStoreId),\n    [symbolForFormStateStoreId]: formStateStoreId\n  };\n  if (hasOwnProperty(schema, \"if\")) {\n    brickConf.if = schema.if;\n  }\n  return brickConf;\n}\nfunction formSchemasToBricks(schemas, fields, formStateStoreId) {\n  if (Array.isArray(schemas)) {\n    return schemas.map(schema => formSchemaToBrick(schema, fields, formStateStoreId));\n  }\n}\nfunction mergeEvents(targetEvents, sourceEvents) {\n  var events = targetEvents !== null && targetEvents !== void 0 ? targetEvents : {};\n  for (var [eventType, handlers] of Object.entries(sourceEvents)) {\n    events[eventType] = hasOwnProperty(events, eventType) ? [events[eventType], handlers].flat() : handlers;\n  }\n  return events;\n}\n//# sourceMappingURL=expandFormRenderer.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nexport function getDefaultProperties(field) {\n  var defaultValue;\n  var commonProps = {\n    id: field.fieldId,\n    name: field.fieldId,\n    label: field.name,\n    dataset: {\n      testid: field.fieldId\n    }\n  };\n  var getReadOnlyAndRequired = () => {\n    var _field$limit, _field$limit2;\n    return {\n      readOnly: (_field$limit = field.limit) === null || _field$limit === void 0 ? void 0 : _field$limit.includes(\"READONLY\"),\n      required: (_field$limit2 = field.limit) === null || _field$limit2 === void 0 ? void 0 : _field$limit2.includes(\"REQUIRED\")\n    };\n  };\n  switch (field.fieldType) {\n    case \"INT\":\n      defaultValue = {\n        brick: \"forms.general-input-number\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description,\n          precision: 0,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"BOOLEAN\":\n      defaultValue = {\n        brick: \"forms.general-switch\",\n        properties: _objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired())\n      };\n      break;\n    case \"FLOAT\":\n      defaultValue = {\n        brick: \"forms.general-input-number\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"ENUM\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          options: [{\n            label: \"选项一\",\n            value: 1\n          }, {\n            label: \"选项二\",\n            value: 2\n          }],\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"ENUMS\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          mode: \"multiple\",\n          options: [{\n            label: \"选项一\",\n            value: 1\n          }, {\n            label: \"选项二\",\n            value: 2\n          }],\n          placeholder: field.description,\n          inputBoxStyle: {\n            width: \"100%\"\n          }\n        })\n      };\n      break;\n    case \"DATE\":\n    case \"TIME\":\n      defaultValue = {\n        brick: \"forms.general-date-picker\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description\n        })\n      };\n      break;\n    case \"IP\":\n      defaultValue = {\n        brick: \"forms.general-input\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description,\n          pattern: \"((^s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]).){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))s*$)|(^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*$))\",\n          message: {\n            pattern: \"输入字符不匹配IP格式\"\n          }\n        })\n      };\n      break;\n    case \"JSON\":\n      defaultValue = {\n        brick: \"forms.general-textarea\",\n        properties: _objectSpread({}, commonProps)\n      };\n      break;\n    case \"ARRAY\":\n      defaultValue = {\n        brick: \"forms.general-select\",\n        properties: _objectSpread({}, commonProps)\n      };\n      break;\n    case \"STRUCTURE\":\n    case \"STRUCTURE_ARRAY\":\n      defaultValue = {\n        brick: \"forms.cmdb-instance-select-panel\",\n        properties: _objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired())\n      };\n      break;\n    default:\n      defaultValue = {\n        brick: \"forms.general-input\",\n        properties: _objectSpread(_objectSpread(_objectSpread({}, commonProps), getReadOnlyAndRequired()), {}, {\n          placeholder: field.description\n        })\n      };\n  }\n  return defaultValue;\n}\n//# sourceMappingURL=getDefaultProperties.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nvar _excluded = [\"blockingList\", \"node\", \"menuRequests\", \"hasTrackingControls\"],\n  _excluded2 = [\"if\", \"permissionsPreCheck\"],\n  _excluded3 = [\"formData\"];\nimport { enqueueStableLoadBricks, loadBricksImperatively } from \"@next-core/loader\";\nimport { isTrackAll } from \"@next-core/cook\";\nimport { hasOwnProperty } from \"@next-core/utils/general\";\nimport { debounce } from \"lodash\";\nimport { asyncCheckBrickIf } from \"./compute/checkIf.js\";\nimport { asyncComputeRealProperties } from \"./compute/computeRealProperties.js\";\nimport { resolveData } from \"./data/resolveData.js\";\nimport { asyncComputeRealValue } from \"./compute/computeRealValue.js\";\nimport { listenOnTrackingContext } from \"./compute/listenOnTrackingContext.js\";\nimport { matchRoutes } from \"./matchRoutes.js\";\nimport { symbolForAsyncComputedPropsFromHost, symbolForTPlExternalForEachItem, symbolForTplStateStoreId } from \"./CustomTemplates/constants.js\";\nimport { expandCustomTemplate } from \"./CustomTemplates/expandCustomTemplate.js\";\nimport { getTagNameOfCustomTemplate, getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { getBrickPackages, hooks } from \"./Runtime.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { getTracks } from \"./compute/getTracks.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { FORM_RENDERER, symbolForFormStateStoreId } from \"./FormRenderer/constants.js\";\nimport { expandFormRenderer } from \"./FormRenderer/expandFormRenderer.js\";\nimport { isPreEvaluated } from \"./compute/evaluate.js\";\nimport { getPreEvaluatedRaw } from \"./compute/evaluate.js\";\nexport function renderRoutes(_x, _x2, _x3, _x4, _x5) {\n  return _renderRoutes.apply(this, arguments);\n}\nfunction _renderRoutes() {\n  _renderRoutes = _asyncToGenerator(function* (returnNode, routes, _runtimeContext, rendererContext, slotId) {\n    var matched = yield matchRoutes(routes, _runtimeContext);\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    switch (matched) {\n      case \"missed\":\n        break;\n      case \"unauthenticated\":\n        output.unauthenticated = true;\n        break;\n      default:\n        {\n          var _hooks$checkPermissio;\n          var route = output.route = matched.route;\n          var runtimeContext = _objectSpread(_objectSpread({}, _runtimeContext), {}, {\n            match: matched.match\n          });\n          runtimeContext.ctxStore.define(route.context, runtimeContext);\n          runtimeContext.pendingPermissionsPreCheck.push(hooks === null || hooks === void 0 ? void 0 : (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.preCheckPermissionsForBrickOrRoute(route, value => asyncComputeRealValue(value, runtimeContext)));\n\n          // Currently, this is only used for brick size-checking: these bricks\n          // will be loaded before page rendering, but they will NOT be rendered.\n          var {\n            preLoadBricks\n          } = route;\n          if (Array.isArray(preLoadBricks)) {\n            output.blockingList.push(loadBricksImperatively(preLoadBricks, getBrickPackages()));\n          }\n          switch (route.type) {\n            case \"redirect\":\n              {\n                var redirectTo;\n                if (typeof route.redirect === \"string\") {\n                  redirectTo = yield asyncComputeRealValue(route.redirect, runtimeContext);\n                } else {\n                  var resolved = yield resolveData(_objectSpread({\n                    transform: \"redirect\"\n                  }, route.redirect), runtimeContext);\n                  redirectTo = resolved.redirect;\n                }\n                if (typeof redirectTo !== \"string\") {\n                  // eslint-disable-next-line no-console\n                  console.error(\"Unexpected redirect result:\", redirectTo);\n                  throw new Error(\"Unexpected type of redirect result: \".concat(typeof redirectTo));\n                }\n                output.redirect = {\n                  path: redirectTo\n                };\n                break;\n              }\n            case \"routes\":\n              {\n                output.menuRequests.push(loadMenu(route.menu, runtimeContext));\n                var newOutput = yield renderRoutes(returnNode, route.routes, runtimeContext, rendererContext, slotId);\n                mergeRenderOutput(output, newOutput);\n                break;\n              }\n            default:\n              {\n                output.menuRequests.push(loadMenu(route.menu, runtimeContext));\n                var _newOutput = yield renderBricks(returnNode, route.bricks, runtimeContext, rendererContext, slotId);\n                mergeRenderOutput(output, _newOutput);\n              }\n          }\n        }\n    }\n    return output;\n  });\n  return _renderRoutes.apply(this, arguments);\n}\nexport function renderBricks(_x6, _x7, _x8, _x9, _x10, _x11, _x12) {\n  return _renderBricks.apply(this, arguments);\n}\nfunction _renderBricks() {\n  _renderBricks = _asyncToGenerator(function* (returnNode, bricks, runtimeContext, rendererContext, slotId, tplStack, noMemoize) {\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    // 多个构件并行异步转换，但转换的结果按原顺序串行合并。\n    var rendered = yield Promise.all(bricks.map((brickConf, index) => renderBrick(returnNode, brickConf, runtimeContext, rendererContext, slotId, index, tplStack && new Map(tplStack))));\n    rendered.forEach((item, index) => {\n      if (!noMemoize && item.hasTrackingControls) {\n        // Memoize a render node before it's been merged.\n        rendererContext.memoizeControlNode(slotId, index, item.node, returnNode);\n      }\n      mergeRenderOutput(output, item);\n    });\n    return output;\n  });\n  return _renderBricks.apply(this, arguments);\n}\nexport function renderBrick(_x13, _x14, _x15, _x16, _x17, _x18) {\n  return _renderBrick.apply(this, arguments);\n}\nfunction _renderBrick() {\n  _renderBrick = _asyncToGenerator(function* (returnNode, brickConf, _runtimeContext, rendererContext, slotId, key) {\n    var _hooks$checkPermissio2, _runtimeContext$app;\n    var tplStack = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : new Map();\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    if (!brickConf.brick) {\n      if (brickConf.template) {\n        // eslint-disable-next-line no-console\n        console.error(\"Legacy templates are dropped in v3:\", brickConf);\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(\"Invalid brick:\", brickConf);\n      }\n      return output;\n    }\n\n    // Translate `if: \"<%= ... %>\"` to `brick: \":if\", dataSource: \"<%= ... %>\"`.\n    // In other words, translate tracking if expressions to tracking control nodes of `:if`.\n    var {\n        if: brickIf,\n        permissionsPreCheck\n      } = brickConf,\n      restBrickConf = _objectWithoutProperties(brickConf, _excluded2);\n    if (isGeneralizedTrackAll(brickIf)) {\n      return renderBrick(returnNode, _objectSpread({\n        brick: \":if\",\n        dataSource: brickIf,\n        // `permissionsPreCheck` maybe required before computing `if`.\n        permissionsPreCheck,\n        slots: {\n          \"\": {\n            type: \"bricks\",\n            bricks: [restBrickConf]\n          }\n        }\n      }, Object.getOwnPropertySymbols(brickConf).reduce((acc, symbol) => _objectSpread(_objectSpread({}, acc), {}, {\n        [symbol]: brickConf[symbol]\n      }), {})), _runtimeContext, rendererContext, slotId, key, tplStack);\n    }\n    var tplStateStoreId = brickConf[symbolForTplStateStoreId];\n    var formStateStoreId = brickConf[symbolForFormStateStoreId];\n    var runtimeContext = _objectSpread(_objectSpread({}, _runtimeContext), {}, {\n      tplStateStoreId,\n      formStateStoreId\n    });\n    if (hasOwnProperty(brickConf, symbolForTPlExternalForEachItem)) {\n      // The external bricks of a template should restore their `forEachItem`\n      // from their host.\n      runtimeContext.forEachItem = brickConf[symbolForTPlExternalForEachItem];\n    }\n    var {\n      context\n    } = brickConf;\n    // istanbul ignore next\n    if (Array.isArray(context) && context.length > 0) {\n      var strict = isStrictMode(runtimeContext);\n      warnAboutStrictMode(strict, \"Defining context on bricks\", \"check your brick:\", brickConf);\n      if (!strict) {\n        runtimeContext.ctxStore.define(context, runtimeContext);\n      }\n    }\n    runtimeContext.pendingPermissionsPreCheck.push(hooks === null || hooks === void 0 ? void 0 : (_hooks$checkPermissio2 = hooks.checkPermissions) === null || _hooks$checkPermissio2 === void 0 ? void 0 : _hooks$checkPermissio2.preCheckPermissionsForBrickOrRoute(brickConf, value => asyncComputeRealValue(value, runtimeContext)));\n    if (!(yield asyncCheckBrickIf(brickConf, runtimeContext))) {\n      return output;\n    }\n    var brickName = brickConf.brick;\n    if (brickName.startsWith(\":\")) {\n      ensureValidControlBrick(brickName);\n      var {\n        dataSource\n      } = brickConf;\n      var renderControlNode = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* () {\n          var _slots$slot;\n          // First, compute the `dataSource`\n          var computedDataSource = yield asyncComputeRealValue(dataSource, runtimeContext);\n\n          // Then, get the matched slot.\n          var slot = brickName === \":forEach\" ? \"\" : brickName === \":switch\" ? String(computedDataSource) : computedDataSource ? \"\" : \"else\";\n\n          // Don't forget to transpile children to slots.\n          var slots = childrenToSlots(brickConf.children, brickConf.slots);\n\n          // Then, get the bricks in that matched slot.\n          var bricks = slots && hasOwnProperty(slots, slot) && ((_slots$slot = slots[slot]) === null || _slots$slot === void 0 ? void 0 : _slots$slot.bricks);\n          if (!Array.isArray(bricks)) {\n            return output;\n          }\n          switch (brickName) {\n            case \":forEach\":\n              {\n                if (!Array.isArray(computedDataSource)) {\n                  return output;\n                }\n                return renderForEach(returnNode, computedDataSource, bricks, runtimeContext, rendererContext, slotId, tplStack);\n              }\n            case \":if\":\n            case \":switch\":\n              {\n                return renderBricks(returnNode, bricks, runtimeContext, rendererContext, slotId, tplStack, true);\n              }\n          }\n        });\n        return function renderControlNode() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n      var controlledOutput = yield renderControlNode();\n      var {\n        contextNames,\n        stateNames\n      } = getTracks(dataSource);\n      if (contextNames || stateNames) {\n        controlledOutput.hasTrackingControls = true;\n        var renderId = 0;\n        var listener = /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* () {\n            var currentRenderId = ++renderId;\n            var output = yield renderControlNode();\n            output.blockingList.push(...[...runtimeContext.tplStateStoreMap.values(), ...runtimeContext.formStateStoreMap.values()].map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck);\n            yield Promise.all(output.blockingList);\n            // Ignore stale renders\n            if (renderId === currentRenderId) {\n              rendererContext.rerenderControlNode(slotId, key, output.node, returnNode);\n            }\n          });\n          return function listener() {\n            return _ref2.apply(this, arguments);\n          };\n        }();\n        var debouncedListener = debounce(listener);\n        if (contextNames) {\n          for (var contextName of contextNames) {\n            runtimeContext.ctxStore.onChange(contextName, debouncedListener);\n          }\n        }\n        if (stateNames) {\n          for (var _contextName of stateNames) {\n            var tplStateStore = getTplStateStore(runtimeContext, \"STATE\", \": \\\"\".concat(dataSource, \"\\\"\"));\n            tplStateStore.onChange(_contextName, debouncedListener);\n          }\n        }\n      }\n      return controlledOutput;\n    }\n\n    // Widgets need to be defined before rendering.\n    if (/\\.tpl-/.test(brickName) && !customTemplates.get(brickName)) {\n      yield catchLoadBrick(loadBricksImperatively([brickName], getBrickPackages()), brickName, rendererContext.unknownBricks);\n    }\n    var tplTagName = getTagNameOfCustomTemplate(brickName, (_runtimeContext$app = runtimeContext.app) === null || _runtimeContext$app === void 0 ? void 0 : _runtimeContext$app.id);\n    if (tplTagName) {\n      var _tplStack$get;\n      var tplCount = (_tplStack$get = tplStack.get(tplTagName)) !== null && _tplStack$get !== void 0 ? _tplStack$get : 0;\n      if (tplCount >= 10) {\n        throw new Error(\"Maximum custom template stack overflowed: \\\"\".concat(tplTagName, \"\\\"\"));\n      }\n      tplStack.set(tplTagName, tplCount + 1);\n    } else if (brickName.includes(\"-\") && !customElements.get(brickName)) {\n      if (brickName === FORM_RENDERER) {\n        customElements.define(FORM_RENDERER, class FormRendererElement extends HTMLElement {\n          get $$typeof() {\n            return \"form-renderer\";\n          }\n        });\n      } else {\n        output.blockingList.push(catchLoadBrick(enqueueStableLoadBricks([brickName], getBrickPackages()), brickName, rendererContext.unknownBricks));\n      }\n    }\n    var brick = {\n      tag: RenderTag.BRICK,\n      type: tplTagName || brickName,\n      return: returnNode,\n      slotId,\n      events: brickConf.events,\n      runtimeContext,\n      portal: brickConf.portal,\n      iid: brickConf.iid,\n      ref: brickConf.ref\n    };\n    output.node = brick;\n\n    // const confProps = brickConf.properties;\n    var formData;\n    var confProps;\n    if (brickName === FORM_RENDERER) {\n      var _brickConf$properties;\n      var _ref3 = (_brickConf$properties = brickConf.properties) !== null && _brickConf$properties !== void 0 ? _brickConf$properties : {};\n      ({\n        formData\n      } = _ref3);\n      confProps = _objectWithoutProperties(_ref3, _excluded3);\n      _ref3;\n    } else {\n      confProps = brickConf.properties;\n    }\n\n    // 加载构件属性和加载子构件等任务，可以并行。\n    var blockingList = [];\n    var trackingContextList = [];\n    var loadProperties = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator(function* () {\n        brick.properties = yield asyncComputeRealProperties(confProps, runtimeContext, trackingContextList);\n        var computedPropsFromHost = brickConf[symbolForAsyncComputedPropsFromHost];\n        if (computedPropsFromHost) {\n          var _brick$properties;\n          (_brick$properties = brick.properties) !== null && _brick$properties !== void 0 ? _brick$properties : brick.properties = {};\n          var computed = yield computedPropsFromHost;\n          for (var [propName, propValue] of Object.entries(computed)) {\n            brick.properties[propName] = propValue;\n          }\n        }\n        listenOnTrackingContext(brick, trackingContextList);\n        return brick.properties;\n      });\n      return function loadProperties() {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n    var asyncProperties = loadProperties();\n    blockingList.push(asyncProperties);\n    rendererContext.registerBrickLifeCycle(brick, brickConf.lifeCycle);\n    var expandedBrickConf = brickConf;\n    if (tplTagName) {\n      expandedBrickConf = expandCustomTemplate(tplTagName, brickConf, brick, asyncProperties);\n    } else if (brickName === FORM_RENDERER) {\n      expandedBrickConf = expandFormRenderer(formData, brickConf, brick, asyncProperties);\n    }\n    if (expandedBrickConf.portal) {\n      // A portal brick has no slotId.\n      brick.slotId = undefined;\n    }\n    var childRuntimeContext;\n    if (tplTagName) {\n      // There is a boundary for `forEachItem` between template internals and externals.\n      childRuntimeContext = _objectSpread({}, runtimeContext);\n      delete childRuntimeContext.forEachItem;\n    } else {\n      childRuntimeContext = runtimeContext;\n    }\n    var loadChildren = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator(function* () {\n        var slots = childrenToSlots(expandedBrickConf.children, expandedBrickConf.slots);\n        if (!slots) {\n          return;\n        }\n        var rendered = yield Promise.all(Object.entries(slots).map(_ref6 => {\n          var [childSlotId, slotConf] = _ref6;\n          return slotConf.type !== \"routes\" ? renderBricks(brick, slotConf.bricks, childRuntimeContext, rendererContext, childSlotId, tplStack) : renderRoutes(brick, slotConf.routes, childRuntimeContext, rendererContext, childSlotId);\n        }));\n        var childrenOutput = _objectSpread(_objectSpread({}, output), {}, {\n          node: undefined,\n          blockingList: []\n        });\n        for (var item of rendered) {\n          mergeRenderOutput(childrenOutput, item);\n        }\n        if (childrenOutput.node) {\n          brick.child = childrenOutput.node;\n        }\n        mergeRenderOutput(output, _objectSpread(_objectSpread({}, childrenOutput), {}, {\n          node: undefined\n        }));\n      });\n      return function loadChildren() {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n    blockingList.push(loadChildren());\n    yield Promise.all(blockingList);\n    return output;\n  });\n  return _renderBrick.apply(this, arguments);\n}\nfunction isGeneralizedTrackAll(brickIf) {\n  return typeof brickIf === \"string\" ? isTrackAll(brickIf) : isPreEvaluated(brickIf) &&\n  // istanbul ignore next: covered by e2e tests\n  isTrackAll(getPreEvaluatedRaw(brickIf));\n}\nfunction ensureValidControlBrick(brick) {\n  if (brick !== \":forEach\" && brick !== \":if\" && brick !== \":switch\") {\n    throw new Error(\"Unknown storyboard control node: \\\"\".concat(brick, \"\\\"\"));\n  }\n}\nfunction renderForEach(_x19, _x20, _x21, _x22, _x23, _x24, _x25) {\n  return _renderForEach.apply(this, arguments);\n}\nfunction _renderForEach() {\n  _renderForEach = _asyncToGenerator(function* (returnNode, dataSource, bricks, runtimeContext, rendererContext, slotId, tplStack) {\n    var output = {\n      blockingList: [],\n      menuRequests: []\n    };\n    var rendered = yield Promise.all(dataSource.map((item, i) => Promise.all(bricks.map((brickConf, j) => renderBrick(returnNode, brickConf, _objectSpread(_objectSpread({}, runtimeContext), {}, {\n      forEachItem: item\n    }), rendererContext, slotId, i * j, tplStack && new Map(tplStack))))));\n\n    // 多层构件并行异步转换，但转换的结果按原顺序串行合并。\n    for (var item of rendered.flat()) {\n      mergeRenderOutput(output, item);\n    }\n    return output;\n  });\n  return _renderForEach.apply(this, arguments);\n}\nfunction loadMenu(menuConf, runtimeContext) {\n  if (!menuConf) {\n    return;\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"brick\") {\n    // eslint-disable-next-line no-console\n    console.error(\"Set menu with brick is dropped in v3:\", menuConf);\n    throw new Error(\"Set menu with brick is dropped in v3\");\n  }\n\n  // istanbul ignore next\n  if (menuConf.type === \"resolve\") {\n    // eslint-disable-next-line no-console\n    console.warn(\"Set menu with resolve is not supported in v3 yet:\", menuConf);\n    return;\n  }\n  return asyncComputeRealValue(menuConf, runtimeContext);\n}\nfunction mergeRenderOutput(output, newOutput) {\n  var {\n      blockingList,\n      node,\n      menuRequests,\n      hasTrackingControls\n    } = newOutput,\n    rest = _objectWithoutProperties(newOutput, _excluded);\n  output.blockingList.push(...blockingList);\n  output.menuRequests.push(...menuRequests);\n  if (node) {\n    if (output.node) {\n      var last = output.node;\n      while (last.sibling) {\n        last = last.sibling;\n      }\n      last.sibling = node;\n    } else {\n      output.node = node;\n    }\n  }\n  Object.assign(output, rest);\n}\nexport function childrenToSlots(children, originalSlots) {\n  var newSlots = originalSlots;\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && children && !Array.isArray(children)) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Specified brick children but not array:\", \"<\".concat(typeof children, \">\"), children);\n  }\n  if (Array.isArray(children) && !newSlots) {\n    newSlots = {};\n    for (var child of children) {\n      var _child$slot;\n      var slot = (_child$slot = child.slot) !== null && _child$slot !== void 0 ? _child$slot : \"\";\n      if (!hasOwnProperty(newSlots, slot)) {\n        newSlots[slot] = {\n          type: \"bricks\",\n          bricks: []\n        };\n      }\n      newSlots[slot].bricks.push(child);\n    }\n  }\n  return newSlots;\n}\nfunction catchLoadBrick(promise, brickName, unknownBricks) {\n  return unknownBricks === \"silent\" ? promise.catch(e => {\n    // eslint-disable-next-line no-console\n    console.error(\"Load brick \\\"\".concat(brickName, \"\\\" failed:\"), e);\n  }) : promise;\n}\n//# sourceMappingURL=Renderer.js.map","import { setProperties } from \"./setProperties.js\";\nimport { getTplStateStore } from \"../CustomTemplates/utils.js\";\nimport { getFormStateStore } from \"../FormRenderer/utils.js\";\nexport function listenOnTrackingContext(brick, trackingContextList) {\n  var _loop = function (track) {\n    var listener = () => {\n      if (brick.element) {\n        setProperties(brick.element, {\n          [track.propName]: track.propValue\n        }, brick.runtimeContext);\n      }\n    };\n    if (track.contextNames) {\n      for (var contextName of track.contextNames) {\n        brick.runtimeContext.ctxStore.onChange(contextName, listener);\n      }\n    }\n    if (track.stateNames) {\n      var tplStateStore = getTplStateStore(brick.runtimeContext, \"STATE\", \": \\\"\".concat(track.propValue, \"\\\"\"));\n      for (var stateName of track.stateNames) {\n        tplStateStore.onChange(stateName, listener);\n      }\n    }\n    if (track.formStateNames) {\n      var formStateStore = getFormStateStore(brick.runtimeContext, \"FORM_STATE\", \": \\\"\".concat(track.propValue, \"\\\"\"));\n      for (var _stateName of track.formStateNames) {\n        formStateStore.onChange(_stateName, listener);\n      }\n    }\n  };\n  for (var track of trackingContextList) {\n    _loop(track);\n  }\n}\n//# sourceMappingURL=listenOnTrackingContext.js.map","import { getTplStateStore } from \"./utils.js\";\nexport function bindTemplateProxy(brick) {\n  var _tplHostMetadata$prox;\n  var {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n\n  // Error recovering brick may have no runtimeContext.\n  if (!ref || !runtimeContext.tplStateStoreId) {\n    return;\n  }\n  var {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"bindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.set(ref, brick);\n  var events = (_tplHostMetadata$prox = tplHostMetadata.proxy) === null || _tplHostMetadata$prox === void 0 ? void 0 : _tplHostMetadata$prox.events;\n  if (events) {\n    var _loop = function (from) {\n      if (to.ref === ref) {\n        var _to$refEvent, _ref, _ref$$$proxyListeners;\n        var listener = e => {\n          if (e.bubbles) {\n            e.stopPropagation();\n          }\n          hostBrick.element.dispatchEvent(new CustomEvent(from, {\n            detail: e.detail,\n            bubbles: e.bubbles,\n            cancelable: e.cancelable,\n            composed: e.composed\n          }));\n        };\n        var eventType = (_to$refEvent = to.refEvent) !== null && _to$refEvent !== void 0 ? _to$refEvent : from;\n        element.addEventListener(eventType, listener);\n        (_ref$$$proxyListeners = (_ref = element).$$proxyListeners) !== null && _ref$$$proxyListeners !== void 0 ? _ref$$$proxyListeners : _ref.$$proxyListeners = [];\n        element.$$proxyListeners.push([eventType, listener]);\n      }\n    };\n    for (var [from, to] of Object.entries(events)) {\n      _loop(from);\n    }\n  }\n}\nexport function unbindTemplateProxy(brick) {\n  var {\n    ref,\n    runtimeContext,\n    element\n  } = brick;\n  if (!runtimeContext.tplStateStoreId || !ref) {\n    return;\n  }\n  var {\n    hostBrick\n  } = getTplStateStore(runtimeContext, \"unbindTemplateProxy\");\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var tplHostMetadata = hostBrick.tplHostMetadata;\n  tplHostMetadata.internalBricksByRef.delete(ref);\n  for (var [type, fn] of (_$$proxyListeners = element.$$proxyListeners) !== null && _$$proxyListeners !== void 0 ? _$$proxyListeners : []) {\n    var _$$proxyListeners;\n    element.removeEventListener(type, fn);\n  }\n  delete element.$$proxyListeners;\n}\n//# sourceMappingURL=bindTemplateProxy.js.map","import { bindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nimport { getTplStateStore } from \"./CustomTemplates/utils.js\";\nimport { bindListeners } from \"./bindListeners.js\";\nimport { setRealProperties } from \"./compute/setRealProperties.js\";\nimport { RenderTag } from \"./enums.js\";\nexport function unmountTree(mountPoint) {\n  mountPoint.innerHTML = \"\";\n}\nexport function mountTree(root, initializedElement) {\n  var current = root.child;\n  var portalElements = [];\n  while (current) {\n    var tagName = current.type;\n    if (tagName.includes(\"-\") && !customElements.get(tagName)) {\n      // eslint-disable-next-line no-console\n      console.error(\"Undefined custom element: \".concat(tagName));\n    }\n\n    // istanbul ignore if\n    if (tagName === \"basic-bricks.script-brick\") {\n      // eslint-disable-next-line no-console\n      console.warn(\"`basic-bricks.script-brick` is deprecated, please take caution when using it\");\n    }\n    var element = initializedElement && current === root.child ? initializedElement : document.createElement(tagName);\n    current.element = element;\n    if (current.slotId) {\n      element.setAttribute(\"slot\", current.slotId);\n    }\n    if (current.iid) {\n      element.dataset.iid = current.iid;\n    }\n    setRealProperties(element, current.properties);\n    bindListeners(element, current.events, current.runtimeContext);\n    if (current.tplHostMetadata) {\n      // 先设置属性，再设置 `$$tplStateStore`，这样，当触发属性设置时，\n      // 避免初始化的一次 state update 操作及其 onChange 事件。\n      element.$$tplStateStore = getTplStateStore({\n        tplStateStoreId: current.tplHostMetadata.tplStateStoreId,\n        tplStateStoreMap: current.runtimeContext.tplStateStoreMap\n      }, \"mount\");\n    }\n    bindTemplateProxy(current);\n    if (current.portal) {\n      portalElements.push(element);\n    } else if (current.return) {\n      if (!current.return.childElements) {\n        current.return.childElements = [];\n      }\n      current.return.childElements.push(element);\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      var currentReturn = current.return;\n      while (currentReturn) {\n        // Append elements inside out\n        if (currentReturn.childElements) {\n          if (currentReturn.tag === RenderTag.ROOT) {\n            var _currentReturn$contai;\n            (_currentReturn$contai = currentReturn.container) === null || _currentReturn$contai === void 0 ? void 0 : _currentReturn$contai.append(...currentReturn.childElements);\n          } else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            currentReturn.element.append(...currentReturn.childElements);\n          }\n          currentReturn.childElements = undefined;\n        }\n        if (currentReturn.tag === RenderTag.ROOT && portalElements.length > 0) {\n          var portal = typeof currentReturn.createPortal === \"function\" ? currentReturn.createPortal() : currentReturn.createPortal;\n          portal.append(...portalElements);\n        }\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n}\n//# sourceMappingURL=mount.js.map","import _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport _classPrivateMethodGet from \"@babel/runtime/helpers/classPrivateMethodGet\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport { isEmpty, remove } from \"lodash\";\nimport { listenerFactory } from \"./bindListeners.js\";\nimport { getHistory } from \"../history.js\";\nimport { getReadOnlyProxy } from \"./proxyFactories.js\";\nimport { mediaEventTarget } from \"./mediaQuery.js\";\nimport { mountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { unbindTemplateProxy } from \"./CustomTemplates/bindTemplateProxy.js\";\nvar commonLifeCycles = [\"onMount\", \"onUnmount\", \"onMediaChange\", \"onScrollIntoView\"];\nvar pageOnlyLifeCycles = [\"onBeforePageLoad\", \"onPageLoad\", \"onPageLeave\", \"onBeforePageLeave\", \"onAnchorLoad\", \"onAnchorUnload\"];\nvar _memoizedLifeCycle = /*#__PURE__*/new WeakMap();\nvar _observers = /*#__PURE__*/new WeakMap();\nvar _mediaListener = /*#__PURE__*/new WeakMap();\nvar _memoizedControlNodes = /*#__PURE__*/new WeakMap();\nvar _unmountBricks = /*#__PURE__*/new WeakSet();\nvar _initializeRerenderBricks = /*#__PURE__*/new WeakSet();\nvar _dispatchGeneralLifeCycle = /*#__PURE__*/new WeakSet();\nvar _addObserver = /*#__PURE__*/new WeakSet();\nexport class RendererContext {\n  /**\n   * - page: render as whole page, triggering page life cycles.\n   * - fragment: render as fragment, not triggering page life cycles.\n   */\n\n  constructor(scope, options) {\n    var _options$unknownBrick;\n    _classPrivateMethodInitSpec(this, _addObserver);\n    // Note: no `onScrollIntoView`\n    _classPrivateMethodInitSpec(this, _dispatchGeneralLifeCycle);\n    _classPrivateMethodInitSpec(this, _initializeRerenderBricks);\n    _classPrivateMethodInitSpec(this, _unmountBricks);\n    _defineProperty(this, \"scope\", void 0);\n    _defineProperty(this, \"unknownBricks\", void 0);\n    _classPrivateFieldInitSpec(this, _memoizedLifeCycle, {\n      writable: true,\n      value: {\n        onBeforePageLoad: [],\n        onPageLoad: [],\n        onPageLeave: [],\n        onBeforePageLeave: [],\n        onAnchorLoad: [],\n        onAnchorUnload: [],\n        onMediaChange: [],\n        onScrollIntoView: [],\n        onMount: [],\n        onUnmount: []\n      }\n    });\n    // #observers: IntersectionObserver[] = [];\n    _classPrivateFieldInitSpec(this, _observers, {\n      writable: true,\n      value: new Map()\n    });\n    _classPrivateFieldInitSpec(this, _mediaListener, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _memoizedControlNodes, {\n      writable: true,\n      value: void 0\n    });\n    this.scope = scope;\n    this.unknownBricks = (_options$unknownBrick = options === null || options === void 0 ? void 0 : options.unknownBricks) !== null && _options$unknownBrick !== void 0 ? _options$unknownBrick : \"throw\";\n  }\n  registerBrickLifeCycle(brick, lifeCycle) {\n    if (!lifeCycle) {\n      return;\n    }\n    var lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n    for (var key of lifeCycleTypes) {\n      var handlers = lifeCycle[key];\n      if (handlers) {\n        _classPrivateFieldGet(this, _memoizedLifeCycle)[key].push({\n          brick,\n          handlers: handlers\n        });\n      }\n    }\n    // istanbul ignore next\n    if (!isEmpty(lifeCycle.useResolves)) {\n      // eslint-disable-next-line no-console\n      console.error(\"`lifeCycle.useResolves` is dropped in v3:\", lifeCycle);\n    }\n  }\n  memoizeControlNode(slotId, key, node, returnNode) {\n    if (!_classPrivateFieldGet(this, _memoizedControlNodes)) {\n      _classPrivateFieldSet(this, _memoizedControlNodes, new WeakMap());\n    }\n    var memKey = \"\".concat(slotId !== null && slotId !== void 0 ? slotId : \"\", \".\").concat(key);\n    var mem = _classPrivateFieldGet(this, _memoizedControlNodes).get(returnNode);\n    if (!mem) {\n      mem = new Map();\n      _classPrivateFieldGet(this, _memoizedControlNodes).set(returnNode, mem);\n    }\n    mem.set(memKey, {\n      node,\n      last: getLastNode(node),\n      lastNormal: getLastNormalNode(node),\n      lastPortal: getLastPortalNode(node)\n    });\n  }\n  rerenderControlNode(slotId, key, node, returnNode) {\n    var _prevLastNormal$eleme, _prevLastNormal$eleme2, _prevLastPortal$eleme, _prevLastPortal$eleme2;\n    var memKey = \"\".concat(slotId !== null && slotId !== void 0 ? slotId : \"\", \".\").concat(key);\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    var memoized = _classPrivateFieldGet(this, _memoizedControlNodes).get(returnNode).get(memKey);\n    var {\n      node: prevNode,\n      last: prevLast,\n      lastNormal: prevLastNormal,\n      lastPortal: prevLastPortal\n    } = memoized;\n    var insertBeforeChild = (_prevLastNormal$eleme = prevLastNormal === null || prevLastNormal === void 0 ? void 0 : (_prevLastNormal$eleme2 = prevLastNormal.element) === null || _prevLastNormal$eleme2 === void 0 ? void 0 : _prevLastNormal$eleme2.nextSibling) !== null && _prevLastNormal$eleme !== void 0 ? _prevLastNormal$eleme : null;\n    var insertPortalBeforeChild = (_prevLastPortal$eleme = prevLastPortal === null || prevLastPortal === void 0 ? void 0 : (_prevLastPortal$eleme2 = prevLastPortal.element) === null || _prevLastPortal$eleme2 === void 0 ? void 0 : _prevLastPortal$eleme2.nextSibling) !== null && _prevLastPortal$eleme !== void 0 ? _prevLastPortal$eleme : null;\n    var last = getLastNode(node);\n    memoized.node = node;\n    memoized.last = last;\n    memoized.lastNormal = getLastNormalNode(node);\n    memoized.lastPortal = getLastPortalNode(node);\n\n    // Figure out the unchanged prev sibling and next sibling\n    var prevSibling;\n    var current = returnNode.child;\n    while (current && current !== prevLast) {\n      if (current.sibling === prevNode) {\n        prevSibling = current;\n        break;\n      }\n      current = current.sibling;\n    }\n    var fragment = document.createDocumentFragment();\n    var portalFragment = document.createDocumentFragment();\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      container: fragment,\n      createPortal: portalFragment,\n      child: node\n    };\n\n    // Override `return`\n    current = node;\n    while (current) {\n      current.return = renderRoot;\n      current = current.sibling;\n    }\n\n    // Unmount previous bricks, including their descendants\n    var removeBricks = getBrickRange(prevNode, prevLast);\n    _classPrivateMethodGet(this, _unmountBricks, _unmountBricks2).call(this, removeBricks);\n    mountTree(renderRoot);\n\n    // Connect back\n    if (prevSibling) {\n      prevSibling.sibling = node;\n    } else {\n      returnNode.child = node;\n    }\n    if (last) {\n      last.sibling = prevLast === null || prevLast === void 0 ? void 0 : prevLast.sibling;\n    }\n\n    // Resume `return`\n    current = node;\n    while (current) {\n      current.return = returnNode;\n      current = current.sibling;\n    }\n    if (returnNode.tag === RenderTag.ROOT) {\n      var _returnNode$container;\n      (_returnNode$container = returnNode.container) === null || _returnNode$container === void 0 ? void 0 : _returnNode$container.insertBefore(fragment, insertBeforeChild);\n    } else {\n      var _returnNode$element;\n      (_returnNode$element = returnNode.element) === null || _returnNode$element === void 0 ? void 0 : _returnNode$element.insertBefore(fragment, insertBeforeChild);\n    }\n    if (portalFragment.childNodes.length > 0) {\n      var _root;\n      var root = node;\n      while (root && root.return) {\n        root = root.return;\n      }\n      if (((_root = root) === null || _root === void 0 ? void 0 : _root.tag) !== RenderTag.ROOT) {\n        throw new Error(\"Cannot find render root node\");\n      }\n      var portal = typeof root.createPortal === \"function\" ? root.createPortal() : root.createPortal;\n      portal.insertBefore(portalFragment, insertPortalBeforeChild);\n    }\n    var newBricks = getBrickRange(node, last);\n    _classPrivateMethodGet(this, _initializeRerenderBricks, _initializeRerenderBricks2).call(this, newBricks);\n  }\n  dispose() {\n    for (var list of Object.values(_classPrivateFieldGet(this, _memoizedLifeCycle))) {\n      list.length = 0;\n    }\n    for (var _list of _classPrivateFieldGet(this, _observers).values()) {\n      for (var observer of _list) {\n        observer.disconnect();\n      }\n      _list.length = 0;\n    }\n    _classPrivateFieldGet(this, _observers).clear();\n    if (_classPrivateFieldGet(this, _mediaListener)) {\n      mediaEventTarget.removeEventListener(\"change\", _classPrivateFieldGet(this, _mediaListener));\n      _classPrivateFieldSet(this, _mediaListener, undefined);\n    }\n    _classPrivateFieldSet(this, _memoizedControlNodes, undefined);\n  }\n  dispatchBeforePageLoad() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onBeforePageLoad\", new CustomEvent(\"page.beforeLoad\"));\n  }\n  dispatchPageLoad() {\n    var event = new CustomEvent(\"page.load\");\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onPageLoad\", event);\n    // Currently only for e2e testing\n    window.dispatchEvent(event);\n  }\n  dispatchBeforePageLeave(detail) {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onBeforePageLeave\", new CustomEvent(\"page.beforeLeave\", {\n      detail\n    }));\n  }\n  dispatchPageLeave() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onPageLeave\", new CustomEvent(\"page.leave\"));\n  }\n  dispatchAnchorLoad() {\n    var {\n      hash\n    } = getHistory().location;\n    if (hash && hash !== \"#\") {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onAnchorLoad\", new CustomEvent(\"anchor.load\", {\n        detail: {\n          hash,\n          anchor: hash.substring(1)\n        }\n      }));\n    } else {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onAnchorUnload\", new CustomEvent(\"anchor.unload\"));\n    }\n  }\n  initializeScrollIntoView() {\n    for (var {\n      brick,\n      handlers: conf\n    } of _classPrivateFieldGet(this, _memoizedLifeCycle).onScrollIntoView) {\n      _classPrivateMethodGet(this, _addObserver, _addObserver2).call(this, brick, conf);\n    }\n  }\n  initializeMediaChange() {\n    _classPrivateFieldSet(this, _mediaListener, event => {\n      _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMediaChange\", new CustomEvent(\"media.change\", {\n        detail: getReadOnlyProxy(event.detail)\n      }));\n    });\n    mediaEventTarget.addEventListener(\"change\", _classPrivateFieldGet(this, _mediaListener));\n  }\n  dispatchOnMount() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onMount\", new CustomEvent(\"mount\"));\n  }\n  dispatchOnUnmount() {\n    _classPrivateMethodGet(this, _dispatchGeneralLifeCycle, _dispatchGeneralLifeCycle2).call(this, \"onUnmount\", new CustomEvent(\"unmount\"));\n  }\n}\nfunction _unmountBricks2(bricks) {\n  var lifeCycleTypes = [...commonLifeCycles, ...(this.scope === \"page\" ? pageOnlyLifeCycles : [])];\n  var unmountList = [];\n\n  // Clear life cycle handlers, record `onUnmount` at the same time\n  for (var key of lifeCycleTypes) {\n    var removed = remove(_classPrivateFieldGet(this, _memoizedLifeCycle)[key], item => bricks.has(item.brick));\n    if (key === \"onUnmount\") {\n      unmountList.push(...removed);\n    }\n  }\n\n  // Clear intersection observers\n  for (var brick of bricks) {\n    var _brick$element, _brick$element2;\n    var observers = _classPrivateFieldGet(this, _observers).get(brick);\n    if (observers !== null && observers !== void 0 && observers.length) {\n      for (var observer of observers) {\n        observer.disconnect();\n      }\n      observers.length = 0;\n      _classPrivateFieldGet(this, _observers).delete(brick);\n    }\n    unbindTemplateProxy(brick);\n    (_brick$element = brick.element) === null || _brick$element === void 0 ? true : delete _brick$element.$$tplStateStore;\n\n    // Also remove the element\n    (_brick$element2 = brick.element) === null || _brick$element2 === void 0 ? void 0 : _brick$element2.remove();\n  }\n\n  // Dispatch unmount events\n  var unmountEvent = new CustomEvent(\"unmount\");\n  for (var {\n    brick: _brick,\n    handlers\n  } of unmountList) {\n    listenerFactory(handlers, _brick.runtimeContext, _brick)(unmountEvent);\n  }\n}\nfunction _initializeRerenderBricks2(bricks) {\n  var mountEvent = new CustomEvent(\"mount\");\n  for (var {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle).onMount) {\n    if (bricks.has(brick)) {\n      listenerFactory(handlers, brick.runtimeContext, brick)(mountEvent);\n    }\n  }\n  for (var {\n    brick: _brick2,\n    handlers: conf\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle).onScrollIntoView) {\n    if (bricks.has(_brick2)) {\n      _classPrivateMethodGet(this, _addObserver, _addObserver2).call(this, _brick2, conf);\n    }\n  }\n}\nfunction _dispatchGeneralLifeCycle2(type, event) {\n  // istanbul ignore next\n  if (process.env.NODE_ENV === \"development\" && this.scope === \"fragment\" && pageOnlyLifeCycles.includes(type)) {\n    throw new Error(\"`lifeCycle.\".concat(type, \"` cannot be used in \").concat(this.scope, \".\\nThis is a bug of Brick Next, please report it.\"));\n  }\n  for (var {\n    brick,\n    handlers\n  } of _classPrivateFieldGet(this, _memoizedLifeCycle)[type]) {\n    listenerFactory(handlers, brick.runtimeContext, brick)(event);\n  }\n}\nfunction _addObserver2(brick, conf) {\n  var _conf$threshold;\n  var threshold = (_conf$threshold = conf.threshold) !== null && _conf$threshold !== void 0 ? _conf$threshold : 0.1;\n  var observer = new IntersectionObserver((entries, observer) => {\n    entries.forEach(entry => {\n      if (entry.isIntersecting) {\n        if (entry.intersectionRatio >= threshold) {\n          listenerFactory(conf.handlers, brick.runtimeContext, brick)(new CustomEvent(\"scroll.into.view\"));\n          observer.disconnect();\n        }\n      }\n    });\n  }, {\n    threshold\n  });\n  observer.observe(brick.element);\n  var list = _classPrivateFieldGet(this, _observers).get(brick);\n  if (!list) {\n    list = [];\n    _classPrivateFieldGet(this, _observers).set(brick, list);\n  }\n  list.push(observer);\n}\nfunction getLastNode(node) {\n  var last = node;\n  while ((_last = last) !== null && _last !== void 0 && _last.sibling) {\n    var _last;\n    last = last.sibling;\n  }\n  return last;\n}\nfunction getLastNormalNode(node) {\n  var last;\n  var current = node;\n  while (current) {\n    if (!current.portal) {\n      last = current;\n    }\n    current = current.sibling;\n  }\n  return last;\n}\nfunction getLastPortalNode(node) {\n  var last;\n  var current = node;\n  while (current) {\n    if (current.portal) {\n      last = current;\n    }\n    if (current.child) {\n      current = current.child;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn;\n      var currentReturn = current.return;\n      while (currentReturn) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      current = (_currentReturn = currentReturn) === null || _currentReturn === void 0 ? void 0 : _currentReturn.sibling;\n    }\n  }\n  return last;\n}\nfunction getBrickRange(from, to) {\n  var range = new Set();\n  var current = from;\n  while (current) {\n    range.add(current);\n    if (current.child) {\n      current = current.child;\n    } else if (current === to) {\n      break;\n    } else if (current.sibling) {\n      current = current.sibling;\n    } else {\n      var _currentReturn2;\n      var currentReturn = current.return;\n      while (currentReturn && currentReturn !== to) {\n        if (currentReturn.sibling) {\n          break;\n        }\n        currentReturn = currentReturn.return;\n      }\n      if (currentReturn === to) {\n        break;\n      }\n      current = (_currentReturn2 = currentReturn) === null || _currentReturn2 === void 0 ? void 0 : _currentReturn2.sibling;\n    }\n  }\n  return range;\n}\n//# sourceMappingURL=RendererContext.js.map","import { getBasePath } from \"./getBasePath.js\";\nvar misc;\n\n/** 运行时页面信息。*/\n\nexport function getPageInfo() {\n  if (!misc) {\n    misc = {\n      isInIframe: false,\n      isInIframeOfSameSite: false,\n      isInIframeOfNext: false,\n      isInIframeOfVisualBuilder: false,\n      isInIframeOfLegacyConsole: false\n    };\n    if (window !== window.parent) {\n      misc.isInIframe = true;\n      try {\n        // Handle:\n        // - Previewing in visual builder by iframe.\n        // - Nesting next in next.\n        // - Nesting console in next.\n        if (window.origin === window.parent.origin) {\n          misc.isInIframeOfSameSite = true;\n          var selfIsNext = getBasePath() === \"/next/\";\n          var parentPathname = window.parent.location.pathname;\n          var parentIsNext = parentPathname.startsWith(\"/next/\");\n          misc.isInIframeOfNext = (Number(selfIsNext) ^ Number(parentIsNext)) === 0;\n          misc.isInIframeOfVisualBuilder = parentPathname.startsWith(\"\".concat(parentIsNext ? \"/next\" : \"\", \"/visual-builder/\"));\n          misc.isInIframeOfLegacyConsole = selfIsNext && !parentIsNext;\n        }\n      } catch (e) {\n        // do nothing\n      }\n    }\n    Object.freeze(misc);\n  }\n  return misc;\n}\n//# sourceMappingURL=getPageInfo.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { http } from \"@next-core/http\";\nvar nativeController;\nexport function initAbortController() {\n  if (!window.AbortController) {\n    return;\n  }\n  nativeController = new AbortController();\n  http.interceptors.request.use(config => {\n    var _config$options;\n    return _objectSpread(_objectSpread({}, config), {}, {\n      options: _objectSpread(_objectSpread({}, config.options), {}, {\n        signal: (_config$options = config.options) !== null && _config$options !== void 0 && _config$options.noAbortOnRouteChange ? null : nativeController.signal\n      })\n    });\n  });\n}\nexport function abortPendingRequest() {\n  if (nativeController) {\n    nativeController.abort();\n    nativeController = new AbortController();\n  }\n}\n//# sourceMappingURL=abortController.js.map","import { customTemplates } from \"../CustomTemplates.js\";\nexport function registerCustomTemplates(storyboard) {\n  var _storyboard$meta;\n  if (storyboard.$$registerCustomTemplateProcessed) {\n    return;\n  }\n  storyboard.$$registerCustomTemplateProcessed = true;\n  var templates = (_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.customTemplates;\n  if (Array.isArray(templates)) {\n    for (var tpl of templates) {\n      var tagName = tpl.name.includes(\".\") ? tpl.name : \"\".concat(storyboard.app.id, \".\").concat(tpl.name);\n      customTemplates.define(tagName, tpl);\n    }\n  }\n}\n//# sourceMappingURL=registerCustomTemplates.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { hooks } from \"./Runtime.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nexport function fulfilStoryboard(_x) {\n  return _fulfilStoryboard.apply(this, arguments);\n}\nfunction _fulfilStoryboard() {\n  _fulfilStoryboard = _asyncToGenerator(function* (storyboard) {\n    if (storyboard.$$fulfilled) {\n      return;\n    }\n    if (!storyboard.$$fulfilling) {\n      storyboard.$$fulfilling = doFulfilStoryboard(storyboard);\n    }\n    return storyboard.$$fulfilling;\n  });\n  return _fulfilStoryboard.apply(this, arguments);\n}\nfunction doFulfilStoryboard(_x2) {\n  return _doFulfilStoryboard.apply(this, arguments);\n}\nfunction _doFulfilStoryboard() {\n  _doFulfilStoryboard = _asyncToGenerator(function* (storyboard) {\n    var _hooks$fulfilStoryboa;\n    yield hooks === null || hooks === void 0 ? void 0 : (_hooks$fulfilStoryboa = hooks.fulfilStoryboard) === null || _hooks$fulfilStoryboa === void 0 ? void 0 : _hooks$fulfilStoryboa.call(hooks, storyboard);\n    registerAppI18n(storyboard);\n    Object.assign(storyboard, {\n      $$fulfilled: true,\n      $$fulfilling: null\n    });\n  });\n  return _doFulfilStoryboard.apply(this, arguments);\n}\n//# sourceMappingURL=fulfilStoryboard.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classPrivateMethodInitSpec from \"@babel/runtime/helpers/classPrivateMethodInitSpec\";\nimport _classPrivateFieldInitSpec from \"@babel/runtime/helpers/classPrivateFieldInitSpec\";\nimport _classPrivateFieldGet from \"@babel/runtime/helpers/classPrivateFieldGet\";\nimport _classPrivateMethodGet from \"@babel/runtime/helpers/classPrivateMethodGet\";\nimport _classPrivateFieldSet from \"@babel/runtime/helpers/classPrivateFieldSet\";\nimport { locationsAreEqual } from \"history\";\nimport { flushStableLoadBricks } from \"@next-core/loader\";\nimport { HttpAbortError } from \"@next-core/http\";\nimport { uniqueId } from \"lodash\";\nimport { getHistory } from \"../history.js\";\nimport { renderRoutes } from \"./Renderer.js\";\nimport { DataStore } from \"./data/DataStore.js\";\nimport { clearResolveCache } from \"./data/resolveData.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { isOutsideApp, matchStoryboard } from \"./matchStoryboard.js\";\nimport { registerStoryboardFunctions } from \"./compute/StoryboardFunctions.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { applyMode, applyTheme, getLocalAppsTheme, setMode, setTheme } from \"../themeAndMode.js\";\nimport { _internalApiGetAppInBootstrapData, getRuntime, hooks } from \"./Runtime.js\";\nimport { getPageInfo } from \"../getPageInfo.js\";\nimport { resetAllComputedMarks } from \"./compute/markAsComputed.js\";\nimport { handleHttpError, httpErrorToString, isUnauthenticatedError } from \"../handleHttpError.js\";\nimport { abortPendingRequest, initAbortController } from \"./abortController.js\";\nimport { registerCustomTemplates } from \"./registerCustomTemplates.js\";\nimport { fulfilStoryboard } from \"./fulfilStoryboard.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { insertPreviewRoutes } from \"./insertPreviewRoutes.js\";\nvar _storyboards = /*#__PURE__*/new WeakMap();\nvar _rendering = /*#__PURE__*/new WeakMap();\nvar _prevLocation = /*#__PURE__*/new WeakMap();\nvar _nextLocation = /*#__PURE__*/new WeakMap();\nvar _runtimeContext = /*#__PURE__*/new WeakMap();\nvar _rendererContext = /*#__PURE__*/new WeakMap();\nvar _rendererContextTrashCan = /*#__PURE__*/new WeakMap();\nvar _redirectCount = /*#__PURE__*/new WeakMap();\nvar _renderId = /*#__PURE__*/new WeakMap();\nvar _currentApp = /*#__PURE__*/new WeakMap();\nvar _previousApp = /*#__PURE__*/new WeakMap();\nvar _navConfig = /*#__PURE__*/new WeakMap();\nvar _getBlockMessageBeforePageLave = /*#__PURE__*/new WeakSet();\nvar _safeRedirect = /*#__PURE__*/new WeakSet();\nvar _queuedRender = /*#__PURE__*/new WeakSet();\nvar _render = /*#__PURE__*/new WeakSet();\nexport class Router {\n  constructor(storyboards) {\n    _classPrivateMethodInitSpec(this, _render);\n    _classPrivateMethodInitSpec(this, _queuedRender);\n    _classPrivateMethodInitSpec(this, _safeRedirect);\n    _classPrivateMethodInitSpec(this, _getBlockMessageBeforePageLave);\n    _classPrivateFieldInitSpec(this, _storyboards, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendering, {\n      writable: true,\n      value: false\n    });\n    _classPrivateFieldInitSpec(this, _prevLocation, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _nextLocation, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _runtimeContext, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendererContext, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _rendererContextTrashCan, {\n      writable: true,\n      value: new Set()\n    });\n    _classPrivateFieldInitSpec(this, _redirectCount, {\n      writable: true,\n      value: 0\n    });\n    _classPrivateFieldInitSpec(this, _renderId, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _currentApp, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _previousApp, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldInitSpec(this, _navConfig, {\n      writable: true,\n      value: void 0\n    });\n    _classPrivateFieldSet(this, _storyboards, storyboards);\n    var _history = getHistory();\n    window.addEventListener(\"beforeunload\", event => {\n      var message = _classPrivateMethodGet(this, _getBlockMessageBeforePageLave, _getBlockMessageBeforePageLave2).call(this, {});\n      // See examples in https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload\n      if (message) {\n        // Cancel the event\n        // If you prevent default behavior in Mozilla Firefox prompt will always be shown\n        event.preventDefault();\n        // Chrome requires returnValue to be set\n        event.returnValue = \"\";\n      } else {\n        // the absence of a returnValue property on the event will guarantee the browser unload happens\n        delete event.returnValue;\n      }\n    });\n    _history.block((location, action) => _classPrivateMethodGet(this, _getBlockMessageBeforePageLave, _getBlockMessageBeforePageLave2).call(this, {\n      location,\n      action\n    }));\n  }\n  getRenderId() {\n    return _classPrivateFieldGet(this, _renderId);\n  }\n  getRuntimeContext() {\n    return _classPrivateFieldGet(this, _runtimeContext);\n  }\n  getRecentApps() {\n    return {\n      currentApp: _classPrivateFieldGet(this, _currentApp),\n      previousApp: _classPrivateFieldGet(this, _previousApp)\n    };\n  }\n  getNavConfig() {\n    return _classPrivateFieldGet(this, _navConfig);\n  }\n  bootstrap() {\n    initAbortController();\n    var history = getHistory();\n    _classPrivateFieldSet(this, _prevLocation, history.location);\n    history.listen((location, action) => {\n      var _classPrivateFieldGet2, _location$state, _classPrivateFieldGet3;\n      var ignoreRendering = false;\n      var omittedLocationProps = {\n        hash: undefined,\n        state: undefined\n      };\n      // Omit the \"key\" when checking whether locations are equal in certain situations.\n      if (\n      // When current location is triggered by browser action of hash link.\n      location.key === undefined ||\n      // When current location is triggered by browser action of non-push-or-replace,\n      // such as goBack or goForward,\n      action === \"POP\" && (\n      // and the previous location was triggered by hash link,\n      _classPrivateFieldGet(this, _prevLocation).key === undefined ||\n      // or the previous location specified notify false.\n      ((_classPrivateFieldGet2 = _classPrivateFieldGet(this, _prevLocation).state) === null || _classPrivateFieldGet2 === void 0 ? void 0 : _classPrivateFieldGet2.notify) === false)) {\n        omittedLocationProps.key = undefined;\n      }\n      if (locationsAreEqual(_objectSpread(_objectSpread({}, _classPrivateFieldGet(this, _prevLocation)), omittedLocationProps), _objectSpread(_objectSpread({}, location), omittedLocationProps)) || action !== \"POP\" && ((_location$state = location.state) === null || _location$state === void 0 ? void 0 : _location$state.notify) === false) {\n        // Ignore rendering if location not changed except hash, state and optional key.\n        // Ignore rendering if notify is `false`.\n        ignoreRendering = true;\n      }\n      if (ignoreRendering) {\n        _classPrivateFieldSet(this, _prevLocation, location);\n        return;\n      }\n      abortPendingRequest();\n      _classPrivateFieldSet(this, _prevLocation, location);\n      (_classPrivateFieldGet3 = _classPrivateFieldGet(this, _rendererContext)) === null || _classPrivateFieldGet3 === void 0 ? void 0 : _classPrivateFieldGet3.dispatchPageLeave();\n      // this.locationContext.messageDispatcher.reset();\n\n      if (action === \"POP\") {\n        var storyboard = matchStoryboard(_classPrivateFieldGet(this, _storyboards), location.pathname);\n        // When a browser action of goBack or goForward is performing,\n        // force reload when the target page is a page of an outside app.\n        if (isOutsideApp(storyboard)) {\n          window.location.reload();\n          return;\n        }\n      }\n      if (_classPrivateFieldGet(this, _rendering)) {\n        _classPrivateFieldSet(this, _nextLocation, location);\n      } else {\n        // devtoolsHookEmit(\"locationChange\");\n        _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, location).catch(handleHttpError);\n      }\n    });\n    return _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, history.location);\n  }\n}\nfunction _getBlockMessageBeforePageLave2(detail) {\n  var _classPrivateFieldGet4;\n  var history = getHistory();\n  var previousMessage = history.getBlockMessage();\n  (_classPrivateFieldGet4 = _classPrivateFieldGet(this, _rendererContext)) === null || _classPrivateFieldGet4 === void 0 ? void 0 : _classPrivateFieldGet4.dispatchBeforePageLeave(detail);\n  var message = history.getBlockMessage();\n  if (!previousMessage && message) {\n    // Auto unblock only if new block was introduced by `onBeforePageLeave`.\n    history.unblock();\n  }\n  return message;\n}\nfunction _safeRedirect2(to, state, from) {\n  var _this$redirectCount, _this$redirectCount2;\n  if ((_classPrivateFieldSet(this, _redirectCount, (_this$redirectCount = _classPrivateFieldGet(this, _redirectCount), _this$redirectCount2 = _this$redirectCount++, _this$redirectCount)), _this$redirectCount2) > 10) {\n    var message = \"Infinite redirect detected: from \\\"\".concat(from.pathname).concat(from.search).concat(from.hash, \"\\\" to \\\"\").concat(to, \"\\\"\");\n    // istanbul ignore else: error cannot be caught in test\n    if (process.env.NODE_ENV === \"test\") {\n      // eslint-disable-next-line no-console\n      console.error(message);\n      return;\n    } else {\n      throw new Error(message);\n    }\n  }\n  getHistory().replace(to, state);\n}\nfunction _queuedRender2(_x) {\n  return _queuedRender3.apply(this, arguments);\n}\nfunction _queuedRender3() {\n  _queuedRender3 = _asyncToGenerator(function* (location) {\n    _classPrivateFieldSet(this, _rendering, true);\n    try {\n      yield _classPrivateMethodGet(this, _render, _render2).call(this, location);\n    } finally {\n      _classPrivateFieldSet(this, _rendering, false);\n      if (_classPrivateFieldGet(this, _nextLocation)) {\n        var nextLocation = _classPrivateFieldGet(this, _nextLocation);\n        _classPrivateFieldSet(this, _nextLocation, undefined);\n        yield _classPrivateMethodGet(this, _queuedRender, _queuedRender2).call(this, nextLocation);\n      }\n    }\n  });\n  return _queuedRender3.apply(this, arguments);\n}\nfunction _render2(_x2) {\n  return _render3.apply(this, arguments);\n}\nfunction _render3() {\n  _render3 = _asyncToGenerator(function* (location) {\n    var _hooks$flowApi, _classPrivateFieldGet5;\n    _classPrivateFieldSet(this, _renderId, uniqueId(\"render-id-1\"));\n    resetAllComputedMarks();\n    clearResolveCache();\n    hooks === null || hooks === void 0 ? void 0 : (_hooks$flowApi = hooks.flowApi) === null || _hooks$flowApi === void 0 ? void 0 : _hooks$flowApi.clearCollectWidgetContract();\n    var history = getHistory();\n    history.unblock();\n    var storyboard = matchStoryboard(_classPrivateFieldGet(this, _storyboards), location.pathname);\n    var previousApp = (_classPrivateFieldGet5 = _classPrivateFieldGet(this, _runtimeContext)) === null || _classPrivateFieldGet5 === void 0 ? void 0 : _classPrivateFieldGet5.app;\n    if (storyboard !== null && storyboard !== void 0 && storyboard.app) {\n      yield fulfilStoryboard(storyboard);\n    }\n    var currentApp = _classPrivateFieldSet(this, _currentApp, storyboard === null || storyboard === void 0 ? void 0 : storyboard.app);\n\n    // Storyboard maybe re-assigned, e.g. when open launchpad.\n    var appChanged = previousApp && currentApp ? previousApp.id !== currentApp.id : previousApp !== currentApp;\n\n    // TODO: handle favicon\n\n    // Set `Router::#currentApp` before calling `getFeatureFlags()`\n    var flags = getRuntime().getFeatureFlags();\n    var prevRendererContext = _classPrivateFieldGet(this, _rendererContext);\n    var redirectTo = (to, state) => {\n      _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n      _classPrivateMethodGet(this, _safeRedirect, _safeRedirect2).call(this, to, state, location);\n    };\n    var redirectToLogin = () => {\n      var to = flags[\"sso-enabled\"] ? \"/sso-auth/login\" : \"/auth/login\";\n      redirectTo(to, {\n        from: location\n      });\n    };\n    var main = document.querySelector(\"#main-mount-point\");\n    var portal = document.querySelector(\"#portal-mount-point\");\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      container: main,\n      createPortal: portal\n    };\n    var cleanUpPreviousRender = () => {\n      unmountTree(main);\n      unmountTree(portal);\n\n      // Note: redirects can lead to multiple trash renderer contexts.\n      _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n      for (var item of _classPrivateFieldGet(this, _rendererContextTrashCan)) {\n        if (item) {\n          item.dispatchOnUnmount();\n          item.dispose();\n        }\n      }\n      _classPrivateFieldGet(this, _rendererContextTrashCan).clear();\n      setTheme(currentApp && (getLocalAppsTheme()[currentApp.id] || currentApp.theme) || \"light\");\n      setMode(\"default\");\n      if (appChanged) {\n        _classPrivateFieldSet(this, _previousApp, previousApp);\n        window.dispatchEvent(new CustomEvent(\"app.change\", {\n          detail: {\n            previousApp,\n            currentApp\n          }\n        }));\n      }\n    };\n    if (currentApp) {\n      var _hooks$checkInstalled, _hooks$auth, _hooks$checkPermissio, _storyboard$meta, _hooks$flowApi2, _storyboard$meta2;\n      hooks === null || hooks === void 0 ? void 0 : (_hooks$checkInstalled = hooks.checkInstalledApps) === null || _hooks$checkInstalled === void 0 ? void 0 : _hooks$checkInstalled.preCheckInstalledApps(storyboard, appId => !!_internalApiGetAppInBootstrapData(appId));\n      var runtimeContext = _classPrivateFieldSet(this, _runtimeContext, {\n        app: currentApp,\n        location,\n        query: new URLSearchParams(location.search),\n        flags,\n        sys: _objectSpread(_objectSpread({}, hooks === null || hooks === void 0 ? void 0 : (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 ? void 0 : _hooks$auth.getAuth()), getPageInfo()),\n        ctxStore: new DataStore(\"CTX\"),\n        pendingPermissionsPreCheck: [hooks === null || hooks === void 0 ? void 0 : (_hooks$checkPermissio = hooks.checkPermissions) === null || _hooks$checkPermissio === void 0 ? void 0 : _hooks$checkPermissio.preCheckPermissions(storyboard)],\n        tplStateStoreMap: new Map(),\n        formStateStoreMap: new Map()\n      });\n      var rendererContext = _classPrivateFieldSet(this, _rendererContext, new RendererContext(\"page\"));\n      _classPrivateFieldSet(this, _navConfig, undefined);\n      registerCustomTemplates(storyboard);\n      registerStoryboardFunctions((_storyboard$meta = storyboard.meta) === null || _storyboard$meta === void 0 ? void 0 : _storyboard$meta.functions, currentApp);\n      hooks === null || hooks === void 0 ? void 0 : (_hooks$flowApi2 = hooks.flowApi) === null || _hooks$flowApi2 === void 0 ? void 0 : _hooks$flowApi2.collectContract((_storyboard$meta2 = storyboard.meta) === null || _storyboard$meta2 === void 0 ? void 0 : _storyboard$meta2.contracts);\n      var failed = false;\n      var output;\n      try {\n        output = yield renderRoutes(renderRoot, insertPreviewRoutes(storyboard.routes), runtimeContext, rendererContext);\n        if (output.unauthenticated) {\n          redirectToLogin();\n          return;\n        }\n        if (output.redirect) {\n          redirectTo(output.redirect.path, output.redirect.state);\n          return;\n        }\n        // Reset redirect count if no redirect is set.\n        _classPrivateFieldSet(this, _redirectCount, 0);\n        flushStableLoadBricks();\n        yield Promise.all([...output.blockingList, ...[runtimeContext.ctxStore, ...runtimeContext.tplStateStoreMap.values(), ...runtimeContext.formStateStoreMap.values()].map(store => store.waitForAll()),\n        // Todo: load processors only when they would used in current rendering.\n        // loadProcessorsImperatively(\n        //   strictCollectMemberUsage(\n        //     [storyboard.routes, storyboard.meta?.customTemplates],\n        //     \"PROCESSORS\",\n        //     2\n        //   ),\n        //   getBrickPackages()\n        // ),\n        ...runtimeContext.pendingPermissionsPreCheck]);\n        var menuConfs = yield Promise.all(output.menuRequests);\n        _classPrivateFieldSet(this, _navConfig, mergeMenuConfs(menuConfs));\n      } catch (error) {\n        // eslint-disable-next-line no-console\n        console.error(\"Router failed:\", error);\n        if (isUnauthenticatedError(error) && !window.NO_AUTH_GUARD) {\n          redirectToLogin();\n          return;\n        } else if (error instanceof HttpAbortError) {\n          _classPrivateFieldGet(this, _rendererContextTrashCan).add(prevRendererContext);\n          return;\n        } else {\n          failed = true;\n          output = {\n            node: {\n              tag: RenderTag.BRICK,\n              type: \"div\",\n              properties: {\n                textContent: httpErrorToString(error)\n              },\n              runtimeContext: null,\n              return: renderRoot\n            },\n            blockingList: [],\n            menuRequests: []\n          };\n        }\n      }\n      renderRoot.child = output.node;\n      cleanUpPreviousRender();\n      if (output.route && output.route.type !== \"routes\" || failed) {\n        if (!failed) {\n          // There is a window to set theme and mode by `lifeCycle.onBeforePageLoad`.\n          rendererContext.dispatchBeforePageLoad();\n        }\n        applyTheme();\n        applyMode();\n        mountTree(renderRoot);\n\n        // Scroll to top after each rendering.\n        // See https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/scroll-restoration.md\n        window.scrollTo(0, 0);\n        if (!failed) {\n          rendererContext.dispatchPageLoad();\n          rendererContext.dispatchAnchorLoad();\n          rendererContext.dispatchOnMount();\n          rendererContext.initializeScrollIntoView();\n          rendererContext.initializeMediaChange();\n        }\n        return;\n      }\n    } else if (!window.NO_AUTH_GUARD && hooks !== null && hooks !== void 0 && hooks.auth && !hooks.auth.isLoggedIn()) {\n      // Todo(steve): refine after api-gateway supports fetching storyboards before logged in.\n      // Redirect to login if no storyboard is matched.\n      redirectToLogin();\n      return;\n    } else {\n      cleanUpPreviousRender();\n    }\n    applyTheme();\n    applyMode();\n    var node = {\n      tag: RenderTag.BRICK,\n      type: \"div\",\n      properties: {\n        textContent: \"Page not found\"\n      },\n      runtimeContext: null,\n      return: renderRoot\n    };\n    renderRoot.child = node;\n    mountTree(renderRoot);\n\n    // Scroll to top after each rendering.\n    window.scrollTo(0, 0);\n  });\n  return _render3.apply(this, arguments);\n}\nfunction mergeMenuConfs(menuConfs) {\n  var navConfig = {\n    breadcrumb: []\n  };\n  for (var menuConf of menuConfs) {\n    if (menuConf) {\n      var {\n        breadcrumb\n      } = menuConf;\n      if (breadcrumb) {\n        if (breadcrumb.overwrite) {\n          navConfig.breadcrumb = breadcrumb.items;\n        } else {\n          navConfig.breadcrumb.push(...breadcrumb.items);\n        }\n      }\n    }\n  }\n  return navConfig;\n}\n//# sourceMappingURL=Router.js.map","import { findLastIndex } from \"lodash\";\nexport function insertPreviewRoutes(routes) {\n  // Insert preview routes for iframe only.\n  if (window.parent === window) {\n    return routes;\n  }\n  var mergedRoutes = routes;\n  var specificTemplatePreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/template-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificTemplatePreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/template-preview/:templateId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificTemplatePreviewIndex + 1)];\n  var specificSnippetPreviewIndex = findLastIndex(mergedRoutes, route => route.path.startsWith(\"${APP.homepage}/_dev_only_/snippet-preview/\"));\n  mergedRoutes = [...mergedRoutes.slice(0, specificSnippetPreviewIndex + 1), {\n    path: \"${APP.homepage}/_dev_only_/snippet-preview/:snippetId\",\n    bricks: [{\n      brick: \"span\"\n    }],\n    menu: false,\n    exact: true\n  }, ...mergedRoutes.slice(specificSnippetPreviewIndex + 1)];\n  return mergedRoutes;\n}\n//# sourceMappingURL=insertPreviewRoutes.js.map","// Allow inject brick packages in a runtime other than Brick Next.\nexport var injectedBrickPackages =\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\ntypeof BRICK_PACKAGES !== \"undefined\" ? BRICK_PACKAGES : [];\n//# sourceMappingURL=injected.js.map","// istanbul ignore file\n// Todo(steve): This file will be removed in the future.\nimport { hooks } from \"./internal/Runtime.js\";\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function authenticate() {\n  var _hooks$auth, _hooks$auth$authentic;\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  hooks === null || hooks === void 0 ? void 0 : (_hooks$auth = hooks.auth) === null || _hooks$auth === void 0 ? void 0 : (_hooks$auth$authentic = _hooks$auth.authenticate) === null || _hooks$auth$authentic === void 0 ? void 0 : _hooks$auth$authentic.call(_hooks$auth, ...args);\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function getAuth() {\n  var _hooks$auth2;\n  return hooks === null || hooks === void 0 ? void 0 : (_hooks$auth2 = hooks.auth) === null || _hooks$auth2 === void 0 ? void 0 : _hooks$auth2.getAuth();\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function logout() {\n  var _hooks$auth3, _hooks$auth3$logout;\n  return hooks === null || hooks === void 0 ? void 0 : (_hooks$auth3 = hooks.auth) === null || _hooks$auth3 === void 0 ? void 0 : (_hooks$auth3$logout = _hooks$auth3.logout) === null || _hooks$auth3$logout === void 0 ? void 0 : _hooks$auth3$logout.call(_hooks$auth3);\n}\n\n/** @deprecated import it from \"@next-core/easyops-runtime\" instead */\nexport function isLoggedIn() {\n  var _hooks$auth4;\n  return hooks === null || hooks === void 0 ? void 0 : (_hooks$auth4 = hooks.auth) === null || _hooks$auth4 === void 0 ? void 0 : _hooks$auth4.isLoggedIn();\n}\n//# sourceMappingURL=auth.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getProviderBrick } from \"./internal/data/getProviderBrick.js\";\nimport { resolveByProvider } from \"./internal/data/resolveData.js\";\nexport function fetchByProvider(_x, _x2, _x3) {\n  return _fetchByProvider.apply(this, arguments);\n}\nfunction _fetchByProvider() {\n  _fetchByProvider = _asyncToGenerator(function* (provider, args, options) {\n    var providerBrick = yield getProviderBrick(provider);\n    return resolveByProvider(providerBrick, provider, \"resolve\", args, options);\n  });\n  return _fetchByProvider.apply(this, arguments);\n}\n//# sourceMappingURL=fetchByProvider.js.map","import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { flushStableLoadBricks } from \"@next-core/loader\";\nimport { renderBricks } from \"./internal/Renderer.js\";\nimport { RendererContext } from \"./internal/RendererContext.js\";\nimport { DataStore } from \"./internal/data/DataStore.js\";\nimport { mountTree, unmountTree } from \"./internal/mount.js\";\nimport { httpErrorToString } from \"./handleHttpError.js\";\nimport { applyMode, applyTheme, setMode, setTheme } from \"./themeAndMode.js\";\nimport { RenderTag } from \"./internal/enums.js\";\nimport { registerStoryboardFunctions } from \"./internal/compute/StoryboardFunctions.js\";\nimport { registerAppI18n } from \"./internal/registerAppI18n.js\";\nimport { registerCustomTemplates } from \"./internal/registerCustomTemplates.js\";\nexport function unstable_createRoot(container) {\n  var {\n    portal: _portal,\n    scope = \"fragment\",\n    unknownBricks\n  } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var portal = _portal;\n  var createPortal;\n  if (_portal) {\n    createPortal = _portal;\n  } else {\n    // Create portal container when necessary.\n    createPortal = () => {\n      portal = document.createElement(\"div\");\n      portal.style.position = \"absolute\";\n      portal.style.width = portal.style.height = \"0\";\n      document.body.append(portal);\n      return portal;\n    };\n  }\n  var unmounted = false;\n  var rendererContext;\n  var clearI18nBundles;\n  return {\n    render(brick) {\n      var _arguments = arguments;\n      return _asyncToGenerator(function* () {\n        var {\n          theme,\n          context,\n          functions,\n          templates,\n          i18n: i18nData\n        } = _arguments.length > 1 && _arguments[1] !== undefined ? _arguments[1] : {};\n        if (unmounted) {\n          throw new Error(\"The root is unmounted and cannot be rendered any more\");\n        }\n        var bricks = [].concat(brick);\n        var runtimeContext = {\n          ctxStore: new DataStore(\"CTX\"),\n          pendingPermissionsPreCheck: [],\n          tplStateStoreMap: new Map(),\n          formStateStoreMap: new Map()\n        };\n        var previousRendererContext = rendererContext;\n        rendererContext = new RendererContext(scope, {\n          unknownBricks\n        });\n        var renderRoot = {\n          tag: RenderTag.ROOT,\n          container,\n          createPortal\n        };\n        if (scope === \"page\") {\n          var _clearI18nBundles;\n          var demoApp = {\n            id: \"demo\",\n            homepage: \"/demo\"\n          };\n          runtimeContext.app = demoApp;\n          var demoStoryboard = {\n            app: demoApp,\n            meta: {\n              i18n: i18nData,\n              customTemplates: templates\n            }\n          };\n\n          // Register i18n.\n          (_clearI18nBundles = clearI18nBundles) === null || _clearI18nBundles === void 0 ? void 0 : _clearI18nBundles();\n          clearI18nBundles = registerAppI18n(demoStoryboard);\n\n          // Register custom templates.\n          registerCustomTemplates(demoStoryboard);\n\n          // Register functions.\n          registerStoryboardFunctions(functions, demoApp);\n        }\n        runtimeContext.ctxStore.define(context, runtimeContext);\n        var failed = false;\n        var output;\n        try {\n          output = yield renderBricks(renderRoot, bricks, runtimeContext, rendererContext);\n          flushStableLoadBricks();\n          yield Promise.all([...output.blockingList, runtimeContext.ctxStore.waitForAll(), ...[...runtimeContext.tplStateStoreMap.values(), ...runtimeContext.formStateStoreMap.values()].map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck]);\n        } catch (error) {\n          failed = true;\n          output = {\n            node: {\n              tag: RenderTag.BRICK,\n              type: \"div\",\n              properties: {\n                textContent: httpErrorToString(error)\n              },\n              return: renderRoot,\n              runtimeContext: null\n            },\n            blockingList: [],\n            menuRequests: []\n          };\n        }\n        renderRoot.child = output.node;\n        previousRendererContext === null || previousRendererContext === void 0 ? void 0 : previousRendererContext.dispatchOnUnmount();\n        previousRendererContext === null || previousRendererContext === void 0 ? void 0 : previousRendererContext.dispose();\n        unmountTree(container);\n        if (portal) {\n          unmountTree(portal);\n        }\n        if (scope === \"page\") {\n          setTheme(theme !== null && theme !== void 0 ? theme : \"light\");\n          setMode(\"default\");\n          if (!failed) {\n            rendererContext.dispatchBeforePageLoad();\n          }\n          applyTheme();\n          applyMode();\n        }\n        mountTree(renderRoot);\n        if (scope === \"page\") {\n          window.scrollTo(0, 0);\n        }\n        if (!failed) {\n          if (scope === \"page\") {\n            rendererContext.dispatchPageLoad();\n            // rendererContext.dispatchAnchorLoad();\n          }\n\n          rendererContext.dispatchOnMount();\n          rendererContext.initializeScrollIntoView();\n          rendererContext.initializeMediaChange();\n        }\n      })();\n    },\n    unmount() {\n      if (unmounted) {\n        return;\n      }\n      unmounted = true;\n      unmountTree(container);\n      if (portal) {\n        unmountTree(portal);\n        // Only remove the portal from its parent when it's dynamic created.\n        if (!_portal) {\n          portal.remove();\n        }\n      }\n    }\n  };\n}\n//# sourceMappingURL=createRoot.js.map","import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { flushStableLoadBricks } from \"@next-core/loader\";\nimport { pick } from \"lodash\";\nimport { _internalApiGetRuntimeContext, _internalApiGetStoryboardInBootstrapData } from \"./Runtime.js\";\nimport { renderBrick } from \"./Renderer.js\";\nimport { RendererContext } from \"./RendererContext.js\";\nimport { mountTree, unmountTree } from \"./mount.js\";\nimport { RenderTag } from \"./enums.js\";\nimport { computeRealValue } from \"./compute/computeRealValue.js\";\nimport { isStrictMode, warnAboutStrictMode } from \"../isStrictMode.js\";\nimport { customTemplates } from \"../CustomTemplates.js\";\nimport { registerAppI18n } from \"./registerAppI18n.js\";\nexport function renderUseBrick(_x, _x2) {\n  return _renderUseBrick.apply(this, arguments);\n}\nfunction _renderUseBrick() {\n  _renderUseBrick = _asyncToGenerator(function* (useBrick, data) {\n    var _runtimeContext$tplSt, _runtimeContext$formS, _output$node;\n    var tplStateStoreScope = [];\n    var formStateStoreScope = [];\n    var runtimeContext = _objectSpread(_objectSpread({}, _internalApiGetRuntimeContext()), {}, {\n      data,\n      pendingPermissionsPreCheck: [],\n      tplStateStoreScope,\n      formStateStoreScope\n    });\n    (_runtimeContext$tplSt = runtimeContext.tplStateStoreMap) !== null && _runtimeContext$tplSt !== void 0 ? _runtimeContext$tplSt : runtimeContext.tplStateStoreMap = new Map();\n    (_runtimeContext$formS = runtimeContext.formStateStoreMap) !== null && _runtimeContext$formS !== void 0 ? _runtimeContext$formS : runtimeContext.formStateStoreMap = new Map();\n    var rendererContext = new RendererContext(\"fragment\");\n    var renderRoot = {\n      tag: RenderTag.ROOT,\n      // Will set during `mountUseBrick`\n      createPortal: null\n    };\n    var transform = useBrick.transform;\n    var strict = isStrictMode();\n    if (transform) {\n      warnAboutStrictMode(strict, \"`useBrick.transform`\", 'please use \"properties\" instead, check your useBrick:', useBrick);\n    }\n    var output = yield renderBrick(renderRoot, strict ? useBrick : _objectSpread(_objectSpread({}, useBrick), {}, {\n      properties: _objectSpread(_objectSpread({}, useBrick.properties), transform)\n    }), runtimeContext, rendererContext);\n    flushStableLoadBricks();\n    yield Promise.all([...output.blockingList,\n    // Wait for local tpl state stores belong to current `useBrick` only.\n    ...[...tplStateStoreScope, ...formStateStoreScope].map(store => store.waitForAll()), ...runtimeContext.pendingPermissionsPreCheck]);\n    if ((_output$node = output.node) !== null && _output$node !== void 0 && _output$node.portal) {\n      throw new Error(\"The root brick of useBrick cannot be a portal brick\");\n    }\n    renderRoot.child = output.node;\n    var tagName = output.node ? output.node.type : null;\n    return {\n      tagName,\n      renderRoot,\n      rendererContext\n    };\n  });\n  return _renderUseBrick.apply(this, arguments);\n}\nexport function mountUseBrick(_ref, element) {\n  var {\n    renderRoot,\n    rendererContext\n  } = _ref;\n  var portal;\n  renderRoot.createPortal = () => {\n    var portalRoot = document.querySelector(\"#portal-mount-point\");\n    portal = document.createElement(\"div\");\n    portalRoot.appendChild(portal);\n    return portal;\n  };\n  mountTree(renderRoot, element);\n  rendererContext.dispatchOnMount();\n  rendererContext.initializeScrollIntoView();\n  rendererContext.initializeMediaChange();\n  return {\n    portal\n  };\n}\nexport function unmountUseBrick(_ref2, mountResult) {\n  var {\n    rendererContext\n  } = _ref2;\n  // if (mountResult.mainBrick) {\n  //   mountResult.mainBrick.unmount();\n  // }\n  if (mountResult.portal) {\n    unmountTree(mountResult.portal);\n    mountResult.portal.remove();\n  }\n  rendererContext.dispatchOnUnmount();\n  rendererContext.dispose();\n}\n\n/** For v2 compatibility of `doTransform` from brick-kit. */\nexport function legacyDoTransform(data, to, options) {\n  if (options) {\n    throw new Error(\"Legacy doTransform does not support options in v3\");\n  }\n  return computeRealValue(to, _objectSpread(_objectSpread({}, _internalApiGetRuntimeContext()), {}, {\n    data\n  }), {\n    noInject: true\n  });\n}\nexport function updateStoryboard(appId, storyboardPatch) {\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  Object.assign(storyboard, _objectSpread(_objectSpread({}, storyboardPatch), {}, {\n    $$fulfilling: null,\n    $$fulfilled: true,\n    $$registerCustomTemplateProcessed: false\n  }));\n  registerAppI18n(storyboard);\n}\nexport function updateStoryboardByRoute(appId, newRoute) {\n  var storyboard = _internalApiGetStoryboardInBootstrapData(appId);\n  var match = false;\n  var getKey = route => \"\".concat(route.path, \".\").concat(route.exact);\n  var replaceRoute = (routes, key) => {\n    return routes.map(route => {\n      var routeKey = getKey(route);\n      if (route.type === \"routes\") {\n        route.routes = replaceRoute(route.routes, key);\n        return route;\n      } else if (routeKey === key) {\n        match = true;\n        return newRoute;\n      } else {\n        return route;\n      }\n    });\n  };\n  storyboard.routes = replaceRoute(storyboard.routes, getKey(newRoute));\n  if (!match) {\n    storyboard.routes.unshift(newRoute);\n  }\n}\nexport function updateStoryboardByTemplate(appId, newTemplate, settings) {\n  var tplName = \"\".concat(appId, \".\").concat(newTemplate.name);\n  // customTemplateRegistry.delete(tplName);\n  customTemplates.define(tplName, {\n    bricks: newTemplate.bricks,\n    proxy: newTemplate.proxy,\n    state: newTemplate.state\n  });\n  updateTemplatePreviewSettings(appId, newTemplate.name, settings);\n}\nexport function updateTemplatePreviewSettings(appId, templateId, settings) {\n  _updatePreviewSettings(appId, \"${APP.homepage}/_dev_only_/template-preview/\".concat(templateId), [_objectSpread({\n    brick: templateId\n  }, pick(settings, \"properties\", \"events\", \"lifeCycle\", \"context\"))]);\n}\nexport function updateStoryboardBySnippet(appId, snippetData) {\n  var _snippetData$bricks;\n  _updatePreviewSettings(appId, \"${APP.homepage}/_dev_only_/snippet-preview/\".concat(snippetData.snippetId), (_snippetData$bricks = snippetData.bricks) !== null && _snippetData$bricks !== void 0 && _snippetData$bricks.length ? snippetData.bricks : [{\n    brick: \"span\"\n  }]);\n}\nexport var updateSnippetPreviewSettings = updateStoryboardBySnippet;\nfunction _updatePreviewSettings(appId, path, bricks) {\n  var {\n    routes\n  } = _internalApiGetStoryboardInBootstrapData(appId);\n  var previewRouteIndex = routes.findIndex(route => route.path === path);\n  var newPreviewRoute = {\n    path,\n    bricks,\n    menu: false,\n    exact: true\n  };\n  if (previewRouteIndex === -1) {\n    routes.unshift(newPreviewRoute);\n  } else {\n    routes.splice(previewRouteIndex, 1, newPreviewRoute);\n  }\n}\n//# sourceMappingURL=secret_internals.js.map"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","_asyncToGenerator","fn","self","this","args","arguments","apply","err","undefined","_classPrivateMethodGet","receiver","privateSet","has","TypeError","_classPrivateMethodInitSpec","obj","add","_defineProperty","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","_objectSpread2","target","i","length","source","forEach","getOwnPropertyDescriptors","defineProperties","_objectWithoutProperties","excluded","sourceKeys","indexOf","sourceSymbolKeys","prototype","propertyIsEnumerable","call","_toPropertyKey","input","hint","prim","Symbol","toPrimitive","res","String","getBasePath","base","document","querySelector","getAttribute","matchStoryboard","storyboards","pathname","sortedStoryboards","orderBy","storyboard","_storyboard$app$homep","_storyboard$app","_storyboard$app$homep2","app","homepage","concat","replace","startsWith","isOutsideApp","_getRuntime$getCurren","getRuntime","getCurrentApp","id","window","STANDALONE_MICRO_APPS","standaloneMode","_excluded","blocked","getUserConfirmation","message","callback","confirm","createHistory","browserHistory","createBrowserHistory","basename","assign","blockMessage","originalPush","originalReplace","location","state","updateQueryFactory","method","query","options","extraQuery","clear","keepHash","urlSearchParams","URLSearchParams","search","params","entries","Array","isArray","item","delete","append","set","toString","hash","pushQuery","replaceQuery","pushAnchor","notify","reload","setBlockMessage","getBlockMessage","unblock","updateFactory","path","pathIsString","parsePath","_bootstrapData$storyb","_bootstrapData8","bootstrapData","_internalApiMatchStoryboard","substring","createHref","historyOverridden","historyExtended","getHistory","_registry","WeakMap","customProcessors","constructor","Map","define","processorFullName","processorFunc","namespace","processorName","split","pkg","get","Error","registerAppI18n","_ref","meta","i18n","i18nNamespace","getI18nNamespace","languages","_ref2","lang","resources","type","registerWidgetI18n","widgetId","i18nData","ns","widgetI18nFactory","widgetImagesFactory","widgetVersion","name","_window$PUBLIC_ROOT","PUBLIC_ROOT","PUBLIC_ROOT_WITH_VERSION","getDevHook","__BRICK_NEXT_DEVTOOLS_HOOK__","THROW","readOnlyHandler","deleteProperty","setPrototypeOf","getReadOnlyProxy","Proxy","getDynamicReadOnlyProxy","fromEntries","map","freeze","theme","storage","JsonStorage","localStorage","LOCAL_STORAGE_APPS_THEME_KEY","setTheme","getTheme","getCurrentTheme","documentElement","dataset","applyTheme","dispatchEvent","CustomEvent","detail","batchSetAppsLocalTheme","appsTheme","setItem","getLocalAppsTheme","_result","result","getItem","_unused","console","mode","setMode","getCurrentMode","applyMode","getCssPropertyValue","_window$getComputedSt","el","getComputedStyle","getPropertyValue","getGeneralGlobals","attemptToVisitGlobals","globalVariables","variableName","variable","getIndividualGlobal","_hooks$checkPermissio","appId","isBuildPush","version","collectCoverage","appendI18nNamespace","storyboardFunctions","isStoryboardFunction","currentVersion","suffix","APP_ROOT","APP_ID","RegExp","escapeRegExp","identity","Boolean","fakeI18nText","i18nText","check","fakeCheckPermissions","hooks","checkPermissions","href","origin","host","hostname","data","en","StoryboardFunctionRegistryFactory","currentApp","registeredFunctions","collector","processed","cooked","createCollector","precooked","precookFunction","typescript","beforeVisit","cook","function","rules","noVar","supply","beforeEvaluate","beforeCall","beforeBranch","getStoryboardFunction","registerStoryboardFunctions","functions","deps","strictCollectMemberUsageInFunction","hasPermissionsCheck","updateStoryboardFunction","newFn","checkPermissionsUsage","functionNames","checkedFunctions","Set","some","EventTarget","wm","create","proto","dispatch","once","removeEventListener","listener","handleEvent","_stopImmediatePropagationFlag","secret","listeners","event","slice","currentTarget","splice","MediaBreakpoint","mediaBreakpointMinWidthMap","xLarge","large","medium","small","xSmall","mediaEventTarget","breakpointMatchesMap","MEDIA","handleMatchesChange","breakpoint","changed","_breakpoint","matches","minWidth","mediaQueryList","matchMedia","addEventListener","addListener","getMedia","getStorageItem","storageType","_storage$getItem","sessionStorage","JSON","parse","isStrictMode","runtimeContext","_getRuntime","flags","getFeatureFlags","warnAboutStrictMode","strict","_len","extraLogs","_key","punctuation","warn","allowedNativeProps","customTemplates","tagName","_constructor$proxy$pr","_constructor$proxy","_compatibleConstructo","_compatibleConstructo2","registered","customElements","proxyProperties","proxy","properties","validProxyProps","legacyTplVariables","asVariable","mergeProperty","refTransform","ref","compatibleConstructor","expose","tpl","_state$filter$map","exposedStates","uniq","proxyMethods","methods","props","entry","nativeProps","prop","HTMLElement","p","join","TplElement","$$typeof","_dev_only_definedProperties","_dev_only_definedMethods","$$getElementByRef","_this$$$tplStateStore","_this$$$tplStateStore2","_this$$$tplStateStore3","_this$$$tplStateStore4","$$tplStateStore","hostBrick","tplHostMetadata","internalBricksByRef","element","connectedCallback","shadowRoot","attachShadow","fragment","createDocumentFragment","style","createElement","textContent","slot","appendChild","disconnectedCallback","_loop","propName","getValue","_this$$$tplStateStore5","updateValue","_loop2","from","to","_to$refProperty","refProperty","_this$$$getElementByR","_to$refProperty2","_loop3","_from","_to","_to$refMethod","refMethod","getTplStateStore","using","extraInfo","tplStateStoreId","tplStateStoreMap","store","getTplHostElement","hostElement","widgetFunctionRegistry","widgetFunctions","registerWidgetFunctions","compare","v1","v2","operator","assertValidOperator","n1","validateAndParse","n2","p1","pop","p2","r","compareSegments","compareVersions","operatorResMap","includes","semver","match","shift","isWildcard","s","tryParse","v","n","parseInt","isNaN","compareStrings","a","b","ap","bp","forceType","Math","max","allowedOperators","op","hasInstalledApp","matchVersion","_internalApiGetAppInBootstrapData","checkInstalledApps","getCheckedApp","installStatus","getFormStateStore","formStateStoreId","formStateStoreMap","pool","getProviderBrick","_x","_getProviderBrick","provider","_hooks$flowApi","isFlowApi","flowApi","isFlowApiProvider","FLOW_API_PROVIDER","brick","registerFlowApiProvider","loadBricksImperatively","getBrickPackages","cache","resolveData","_x2","_x3","_resolveData","resolveConf","useProvider","onReject","legacyProvider","providerBrick","actualArgs","all","asyncComputeRealValue","promise","resolveByProvider","transform","isHandleRejectByTransform","_x4","_x5","_x6","_x7","_x8","_x9","_resolveByProvider","originalArgs","cacheKey","stringify","e","finalArgs","getArgsOfFlowApi","symbolForRaw","for","symbolForContext","isPreEvaluated","raw","getPreEvaluatedRaw","pre","shouldDismissMarkingComputed","shouldAllowRecursiveEvaluations","possibleErrorConstructs","WeakSet","SyntaxError","ReferenceError","getCookErrorConstructor","_asyncEvaluate","blockingList","run","lowLevelEvaluate","isAsync","passByRuntimeContext","omit","menuUsage","usedArgs","hasAppUsage","preevaluate","withParent","beforeVisitGlobal","node","parent","collectAppGetMenuUsage","collectInstalledAppsHasUsage","hasNonStaticUsage","usedCtx","usedProcessors","usedStates","tplStateStore","lazy","hasOwnProperty","usedFormStates","formStateStore","devHook","strictCollectMemberUsage","ctxStore","waitFor","usedTpls","loadProcessorsImperatively","_hooks$checkInstalled","attemptToCheckPermissions","usedFunctions","pendingPermissionsPreCheck","size","menu","usedMenuIds","menuId","fetchMenuById","getStoryboardByAppId","_internalApiGetStoryboardInBootstrapData","waitForCheckingApps","_runtimeContext$overr","_hooks$menu","_match$params","sys","overrideApp","cloneDeep","getMenu","getMenuById","forEachItem","getMiscSettings","t","k","getAll","expression","_message","StateOfUseBrick","isLazyContentInUseBrick","USE_BRICK_PROPERTIES","USE_BRICK_TRANSFORM","USE_BRICK_EVENTS","USE_BRICK_IF","USE_BRICK_LIFECYCLE","USE_BRICK_DATA_SOURCE","getNextStateOfUseBrick","USE_BRICK","USE_BRICK_ITEM","USE_BRICK_SLOTS_ITEM_BRICKS","USE_BRICK_SLOTS_ITEM_BRICKS_ITEM","INITIAL","USE_BRICK_SLOTS","USE_BRICK_SLOTS_ITEM","computed","markAsComputed","isObject","hasBeenComputed","getPrototypeOf","values","_asyncComputeRealValue","internalOptions","preEvaluated","$$lazyForUseBrick","$$stateOfUseBrick","dismissMarkingComputed","isEvaluable","asyncEvaluate","noInject","transformAndInject","inject","nextOptions","getNextComputeOptions","ignoreSymbols","computeRealValue","evaluate","asyncCheckIf","_asyncCheckIf","ifContainer","if","checkIf","checkIfOfComputed","_asyncCheckBrickIf","brickConf","checkIfByTransform","getTracks","contextNames","stateNames","formStateNames","isTrackAll","trackAll","context","formState","track","_asyncComputeRealProperties","trackingContextList","_ref3","propValue","realValue","setRealProperties","realProps","setProperties","bricks","computeRealProperties","escapeString","str","sensitive","stringToRegexp","tokens","_a","_b","start","_c","end","_d","encode","x","_e","delimiter","_f","endsWith","endsWithRe","delimiterRe","route","_i","tokens_1","token","prefix","pattern","modifier","mod","endToken","isEndDelimited","tokensToRegexp","char","index","count","j","code","charCodeAt","lexer","prefixes","defaultPattern","tryConsume","mustConsume","nextType","consumeText","name_1","pattern_1","pathToRegexp","groupsRegex","execResult","exec","regexpToRegexp","paths","parts","arrayToRegexp","cacheLimit","cacheCount","matchPath","exact","reduce","matched","regexp","pathCache","cacheResult","compilePath","url","isExact","memo","_matchRoutes","routes","routePath","noAuthGuard","public","auth","isLoggedIn","symbolForAsyncComputedPropsFromHost","symbolForTplStateStoreId","symbolForTPlExternalForEachItem","timeoutIdList","K","REQUEST_FAILED","SOMETHING_WENT_WRONG","LOGIN_TIMEOUT_MESSAGE","NETWORK_ERROR","zh","NS","locales","Dialog","show","content","setTimeout","alert","httpErrorToString","Event","HTMLScriptElement","src","HttpFetchError","HttpResponseError","responseJson","msg","isUnauthenticatedError","response","status","lastErrorMessage","unauthenticatedConfirming","handleHttpError","HttpAbortError","NO_AUTH_GUARD","ssoEnabled","history","title","contentStyle","whiteSpace","Notification","bindListeners","eventsMap","eventType","handlers","listenerFactory","handler","$$listeners","$$eventListeners","isBuiltinHandler","action","isUseProviderHandler","isCustomHandler","targetRef","isConditionalEventHandler","runtimeBrick","_handler$batch","_handler$batch2","handleHistoryAction","handleWindowAction","handleLocationAction","handleStorageAction","preventDefault","handleConsoleAction","handleMessageAction","handleContextAction","batch","handleTplStateAction","init","argsFactory","handleFormStateAction","handleUseProviderAction","handleCustomAction","else","_handleUseProviderAction","brickCallback","targets","rawTarget","rawTargetRef","computedTarget","multiple","querySelectorAll","found","computedTargetRef","targetRefs","tplHostElement","_tplHostElement$$$get","isExecuteCustomHandler","useEventAsDefault","isSetPropsCustomHandler","_x10","_x11","_brickCallback","_poll","task","computedArgs","poll","callbackFactory","eventCallbackFactory","pollableCallback","progress","success","finally","enabled","currentTimeoutId","finallyCallback","interval","leadingRequestDelay","continueOnError","delegateLoadingBar","expectPollEnd","expectPollStopImmediately","currentRenderId","_internalApiGetRenderId","shouldStop","delayedPoll","delay","startPoll","baseArgsLength","hasCallback","overrideMethod","useEventDetailAsDefault","features","open","batchUpdate","updateValues","every","removeItem","DataStore","changeEventType","_this$data$get","getAffectListByContext","affectNames","batchUpdateContextsNames","updateContexts","affectContexts","affectDepsContextNames","updateContextItem","affectContextItem","triggerEvent","contexts","_context$eventTarget","eventTarget","callbackRuntimeContext","load","loaded","loading","val","dataConfs","asyncHostProperties","pending","contextConfs","resolveContext","keyword","dependencyMap","depsMap","_contextConf","stats","collectMemberUsage","getDependencyMapOfContext","pendingDeps","contextName","contextConf","_pendingDeps$get","deferredContexts","pendingContexts","wrapResolve","_pendingDeps$get2","resolved","left","scheduleNext","scheduleAsSerial","_scheduleNext","readyContexts","usedProperties","dep","predicateNextResolveFactory","pendingResult","deferred","duplicatedMap","next","processedAtLeastOne","_contextConf2","detectCircularContexts","catch","resolveDataStore","dataConf","pendingStack","onChange","dataName","_this$data$get2","dataNames","_this","ctx","waitForAll","_this2","_this3","hostProps","isLazyResolve","newData","batchAddListener","setupTemplateProxy","hostContext","slots","asyncComputedProps","reversedProxies","externalSlots","propertyProxies","slotProxies","quasisMap","_externalSlots$from$b","_externalSlots$from","_to$refSlot","_to$refPosition","insertBricks","refToSlot","refSlot","expandableSlot","refPosition","clamp","setupTemplateExternalBricks","slotName","slotConf","quasis","flatMap","_brick$slots","_slotConf$bricks","setupTemplateExternalRoutes","setupUseBrickInTemplate","walk","setup","originalSlots","children","restConf","transpiledSlots","childrenToSlots","_excluded2","expandCustomTemplate","tplTagName","uniqueId","tplStateStoreScope","contracts","collectWidgetContract","originalExternalSlots","externalChildren","restBrickConf","newBrickConf","proxies","_proxies","expandBrickInTemplate","brickConfInTemplate","slotsInTemplate","childrenInTemplate","restBrickConfInTemplate","RenderTag","FORM_RENDERER","symbolForFormStateStoreId","formSchemaToBrick","schema","fields","events","mountPoint","instanceId","iid","field","find","fieldId","defaults","defaultValue","commonProps","label","testid","getReadOnlyAndRequired","_field$limit","_field$limit2","readOnly","limit","required","fieldType","placeholder","description","precision","inputBoxStyle","width","getDefaultProperties","formSchemasToBricks","schemas","_excluded3","renderRoutes","_renderRoutes","returnNode","_runtimeContext","rendererContext","slotId","matchRoutes","output","menuRequests","unauthenticated","preCheckPermissionsForBrickOrRoute","preLoadBricks","redirectTo","redirect","loadMenu","mergeRenderOutput","renderBricks","_x12","_renderBricks","tplStack","noMemoize","renderBrick","hasTrackingControls","memoizeControlNode","_x13","_x14","_x15","_x16","_x17","_x18","_renderBrick","_hooks$checkPermissio2","_runtimeContext$app","template","brickIf","permissionsPreCheck","isGeneralizedTrackAll","dataSource","acc","symbol","asyncCheckBrickIf","brickName","ensureValidControlBrick","renderControlNode","_slots$slot","computedDataSource","_x19","_x20","_x21","_x22","_x23","_x24","_x25","_renderForEach","renderForEach","controlledOutput","renderId","rerenderControlNode","debouncedListener","debounce","_contextName","test","catchLoadBrick","unknownBricks","getTagNameOfCustomTemplate","_tplStack$get","tplCount","enqueueStableLoadBricks","formData","confProps","tag","BRICK","return","portal","_brickConf$properties","loadProperties","_ref4","asyncComputeRealProperties","computedPropsFromHost","_brick$properties","stateName","_stateName","listenOnTrackingContext","asyncProperties","registerBrickLifeCycle","lifeCycle","childRuntimeContext","expandedBrickConf","hostBrickConf","_normalizedFormData$c","_hostBrickConf$proper","normalizedFormData","formStateStoreScope","formConf","formSchema","targetEvents","sourceEvents","flat","mergeEvents","renderRoot","padding","expandFormRenderer","loadChildren","_ref5","rendered","_ref6","childSlotId","childrenOutput","child","menuConf","newOutput","rest","last","sibling","newSlots","_child$slot","bindTemplateProxy","_tplHostMetadata$prox","_to$refEvent","_ref$$$proxyListeners","bubbles","stopPropagation","cancelable","composed","refEvent","$$proxyListeners","unbindTemplateProxy","_$$proxyListeners","unmountTree","innerHTML","mountTree","root","initializedElement","current","portalElements","setAttribute","childElements","_currentReturn","currentReturn","_currentReturn$contai","ROOT","container","createPortal","misc","nativeController","commonLifeCycles","pageOnlyLifeCycles","_memoizedLifeCycle","_observers","_mediaListener","_memoizedControlNodes","_unmountBricks","_initializeRerenderBricks","_dispatchGeneralLifeCycle","_addObserver","RendererContext","scope","_options$unknownBrick","onBeforePageLoad","onPageLoad","onPageLeave","onBeforePageLeave","onAnchorLoad","onAnchorUnload","onMediaChange","onScrollIntoView","onMount","onUnmount","lifeCycleTypes","isEmpty","useResolves","memKey","mem","getLastNode","lastNormal","getLastNormalNode","lastPortal","getLastPortalNode","_prevLastNormal$eleme","_prevLastNormal$eleme2","_prevLastPortal$eleme","_prevLastPortal$eleme2","prevSibling","memoized","prevNode","prevLast","prevLastNormal","prevLastPortal","insertBeforeChild","nextSibling","insertPortalBeforeChild","portalFragment","_returnNode$container","_returnNode$element","removeBricks","getBrickRange","_unmountBricks2","insertBefore","childNodes","_root","newBricks","_initializeRerenderBricks2","dispose","list","_list","observer","disconnect","dispatchBeforePageLoad","_dispatchGeneralLifeCycle2","dispatchPageLoad","dispatchBeforePageLeave","dispatchPageLeave","dispatchAnchorLoad","anchor","initializeScrollIntoView","conf","_addObserver2","initializeMediaChange","dispatchOnMount","dispatchOnUnmount","unmountList","removed","remove","_brick$element","_brick$element2","observers","unmountEvent","_brick","mountEvent","_brick2","_conf$threshold","threshold","IntersectionObserver","isIntersecting","intersectionRatio","observe","_last","range","_currentReturn2","getPageInfo","isInIframe","isInIframeOfSameSite","isInIframeOfNext","isInIframeOfVisualBuilder","isInIframeOfLegacyConsole","selfIsNext","parentPathname","parentIsNext","Number","registerCustomTemplates","_storyboard$meta","$$registerCustomTemplateProcessed","templates","_fulfilStoryboard","$$fulfilled","$$fulfilling","_doFulfilStoryboard","doFulfilStoryboard","_hooks$fulfilStoryboa","fulfilStoryboard","_storyboards","_rendering","_prevLocation","_nextLocation","_rendererContext","_rendererContextTrashCan","_redirectCount","_renderId","_currentApp","_previousApp","_navConfig","_getBlockMessageBeforePageLave","_safeRedirect","_queuedRender","_render","Router","_history","_getBlockMessageBeforePageLave2","returnValue","block","getRenderId","getRuntimeContext","getRecentApps","previousApp","getNavConfig","bootstrap","AbortController","http","config","_config$options","signal","noAbortOnRouteChange","listen","_classPrivateFieldGet2","_location$state","_classPrivateFieldGet3","ignoreRendering","omittedLocationProps","locationsAreEqual","abort","_queuedRender2","_classPrivateFieldGet4","previousMessage","_safeRedirect2","_this$redirectCount","_this$redirectCount2","_queuedRender3","_render2","nextLocation","_render3","_classPrivateFieldGet5","clearCollectWidgetContract","appChanged","prevRendererContext","redirectToLogin","main","cleanUpPreviousRender","_hooks$auth","_hooks$flowApi2","_storyboard$meta2","preCheckInstalledApps","getAuth","preCheckPermissions","collectContract","failed","mergedRoutes","specificTemplatePreviewIndex","findLastIndex","specificSnippetPreviewIndex","insertPreviewRoutes","flushStableLoadBricks","menuConfs","navConfig","breadcrumb","overwrite","items","mergeMenuConfs","scrollTo","runtime","router","injectedBrickPackages","BRICK_PACKAGES","createRuntime","initializeI18n","Runtime","_initialized","_bootstrapped","initialize","_data$settings$preset","_data$settings","localeName","settings","deepFreeze","brickPackages","normalizeBootstrapData","notification","dialog","presetBricks","loadNotificationService","loadBricks","loader","loadDialogService","_router$getRecentApps","_router","_router2","_bootstrapData","_bootstrapData$settin","_router3","_router3$getRecentApp","_router3$getRecentApp2","_router3$getRecentApp3","featureFlags","_bootstrapData2","_bootstrapData2$setti","_router4","_router4$getRecentApp","_router4$getRecentApp2","_router4$getRecentApp3","getBrandSettings","_bootstrapData3","_bootstrapData3$setti","base_title","brand","getLaunchpadSettings","_bootstrapData4","_bootstrapData4$setti","columns","rows","launchpad","getDesktops","_bootstrapData$deskto","_bootstrapData5","desktops","getLaunchpadSiteMap","_bootstrapData$siteSo","_bootstrapData6","siteSort","toggleLaunchpadEffect","body","classList","toggle","applyPageTitle","pageTitle","baseTitle","_router5","_bootstrapData$brickP","_bootstrapData7","_router6","_internalApiGetRuntimeContext","_router7","_bootstrapData9","_bootstrapData9$story","_internalApiGetStoryb","authenticate","_hooks$auth$authentic","_hooks$auth2","logout","_hooks$auth3","_hooks$auth3$logout","_hooks$auth4","fetchByProvider","_fetchByProvider","unstable_createRoot","_portal","position","height","clearI18nBundles","unmounted","render","_arguments","previousRendererContext","_clearI18nBundles","demoApp","demoStoryboard","unmount","renderUseBrick","_renderUseBrick","useBrick","_runtimeContext$tplSt","_runtimeContext$formS","_output$node","mountUseBrick","portalRoot","unmountUseBrick","mountResult","legacyDoTransform","updateStoryboard","storyboardPatch","updateStoryboardByRoute","newRoute","getKey","replaceRoute","routeKey","unshift","updateStoryboardByTemplate","newTemplate","tplName","updateTemplatePreviewSettings","templateId","_updatePreviewSettings","pick","updateStoryboardBySnippet","snippetData","_snippetData$bricks","snippetId","updateSnippetPreviewSettings","previewRouteIndex","findIndex","newPreviewRoute"],"sourceRoot":""}